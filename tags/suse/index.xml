<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>SUSE on Ken's blog</title><link>https://wangken0129.github.io/tags/suse/</link><description>Recent content in SUSE on Ken's blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 23 Sep 2023 07:42:08 +0800</lastBuildDate><atom:link href="https://wangken0129.github.io/tags/suse/index.xml" rel="self" type="application/rss+xml"/><item><title>Rancher_RKE2_Lab</title><link>https://wangken0129.github.io/p/rancher_rke2_lab/</link><pubDate>Sat, 23 Sep 2023 07:42:08 +0800</pubDate><guid>https://wangken0129.github.io/p/rancher_rke2_lab/</guid><description>&lt;h1 id="rancher-rke2-cluster">Rancher RKE2 Cluster
&lt;/h1>&lt;p>Rancher RKE2 安裝Lab&lt;/p>
&lt;h2 id="參考資料">參考資料
&lt;/h2>&lt;p>&lt;a class="link" href="https://docs.rke2.io/#how-is-this-different-from-rke-or-k3s" target="_blank" rel="noopener"
>https://docs.rke2.io/#how-is-this-different-from-rke-or-k3s&lt;/a>&lt;/p>
&lt;h2 id="rke2-vs-rke-vs-k3s">RKE2 vs RKE vs K3S
&lt;/h2>&lt;p>RKE2 combines the best-of-both-worlds from the 1.x version of RKE (hereafter referred to as RKE1) and K3s.&lt;/p>
&lt;p>From K3s, it inherits the usability, ease-of-operations, and deployment model.&lt;/p>
&lt;p>From RKE1, it inherits close alignment with upstream Kubernetes. In places K3s has diverged from upstream Kubernetes in order to optimize for edge deployments, but RKE1 and RKE2 can stay closely aligned with upstream.&lt;/p>
&lt;p>Importantly, RKE2 does not rely on Docker as RKE1 does. RKE1 leveraged Docker for deploying and managing the control plane components as well as the container runtime for Kubernetes. RKE2 launches control plane components as static pods, managed by the kubelet. The embedded container runtime is containerd.&lt;/p>
&lt;h2 id="架構">架構
&lt;/h2>&lt;p>devop/suse&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026120148575.png"
loading="lazy"
alt="image-20221026120148575"
>&lt;/p>
&lt;p>DownStream K8S&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026120458643.png"
loading="lazy"
alt="image-20221026120458643"
>&lt;/p>
&lt;h2 id="安裝作業系統-no-swap">安裝作業系統 (No Swap)
&lt;/h2>&lt;p>關閉防火牆&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025140147837.png"
loading="lazy"
alt="image-20221025140147837"
>&lt;/p>
&lt;h2 id="註冊作業系統">註冊作業系統
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">yast2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">email: ken.wang@infotech.com.tw
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Registry Code: B8203D65240BDA3A
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025145420736.png"
loading="lazy"
alt="image-20221025145420736"
>&lt;/p>
&lt;h2 id="安裝rms">安裝RMS
&lt;/h2>&lt;p>&lt;a class="link" href="https://kb.vmware.com/s/article/57122" target="_blank" rel="noopener"
>https://kb.vmware.com/s/article/57122&lt;/a>&lt;/p>
&lt;h3 id="安裝dns-server">安裝DNS Server
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; sudo zypper install -t pattern dhcp_dns_server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; sudo yast2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025153349050.png"
loading="lazy"
alt="image-20221025153349050"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025153502151.png"
loading="lazy"
alt="image-20221025153502151"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025153543482.png"
loading="lazy"
alt="image-20221025153543482"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025153718281.png"
loading="lazy"
alt="image-20221025153718281"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025153903862.png"
loading="lazy"
alt="image-20221025153903862"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025154021819.png"
loading="lazy"
alt="image-20221025154021819"
>&lt;/p>
&lt;h3 id="安裝ngnix">安裝Ngnix
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>安裝nginx&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">zypper&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="err">的密碼：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在重新整理服務&lt;/span> &lt;span class="s1">&amp;#39;Basesystem_Module_15_SP4_x86_64&amp;#39;&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在重新整理服務&lt;/span> &lt;span class="s1">&amp;#39;Desktop_Applications_Module_15_SP4_x86_64&amp;#39;&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在重新整理服務&lt;/span> &lt;span class="s1">&amp;#39;SUSE_Linux_Enterprise_Server_15_SP4_x86_64&amp;#39;&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在重新整理服務&lt;/span> &lt;span class="s1">&amp;#39;Server_Applications_Module_15_SP4_x86_64&amp;#39;&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在載入套件庫資料&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在讀取已安裝的套件&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在解決套件相依性&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">將會安裝下列&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="err">個新的套件：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">nginx&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">1&lt;/span> &lt;span class="err">要安裝的新套件&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">全部下載大小：&lt;/span>&lt;span class="mf">702.9&lt;/span> &lt;span class="n">KiB&lt;/span>&lt;span class="err">。已快取：&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">B&lt;/span>&lt;span class="err">。&lt;/span> &lt;span class="err">完成操作後，將使用額外的&lt;/span> &lt;span class="mf">2.3&lt;/span> &lt;span class="n">MiB&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">要繼續嗎？&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v&lt;/span>&lt;span class="o">/...&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="err">顯示所有選項&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="n">y&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在取出&lt;/span> &lt;span class="err">套件&lt;/span> &lt;span class="n">nginx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.21&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150400.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.&lt;/span>&lt;span class="n">x86_64&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">702.9&lt;/span> &lt;span class="n">KiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="err">已解開&lt;/span> &lt;span class="mf">2.3&lt;/span> &lt;span class="n">MiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在取回︰&lt;/span> &lt;span class="n">nginx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.21&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150400.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.&lt;/span>&lt;span class="n">x86_64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">rpm&lt;/span> &lt;span class="o">......................................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">正在檢查檔案衝突：&lt;/span> &lt;span class="o">.................................................................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">useradd&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span> &lt;span class="n">User&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">nginx&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">d&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">U&lt;/span> &lt;span class="n">nginx&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nologin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">正在安裝：&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.21&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150400.1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.&lt;/span>&lt;span class="n">x86_64&lt;/span> &lt;span class="o">.....................................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="err">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>設定ngnix&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worker_processes&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">worker_rlimit_nofile&lt;/span> &lt;span class="mi">40000&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">load_module&lt;/span> &lt;span class="n">lib64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">modules&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ngx_stream_module&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">so&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">events&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">worker_connections&lt;/span> &lt;span class="mi">8192&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#http {&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># server {&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># listen 80;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># return 301 https://$host$request_uri;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># }&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">stream&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">upstream&lt;/span> &lt;span class="n">rancher_servers_http&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">least_conn&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">80&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#後端web server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listen&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">proxy_pass&lt;/span> &lt;span class="n">rancher_servers_http&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">upstream&lt;/span> &lt;span class="n">rancher_servers_https&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">least_conn&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">443&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">443&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">443&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listen&lt;/span> &lt;span class="mi">443&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">proxy_pass&lt;/span> &lt;span class="n">rancher_servers_https&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">upstream&lt;/span> &lt;span class="n">rancher_servers_6443&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">least_conn&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6443&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6443&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6443&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listen&lt;/span> &lt;span class="mi">6443&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">proxy_pass&lt;/span> &lt;span class="n">rancher_servers_6443&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">upstream&lt;/span> &lt;span class="n">rancher_servers_9345&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">least_conn&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9345&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9345&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9345&lt;/span> &lt;span class="n">max_fails&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="n">fail_timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listen&lt;/span> &lt;span class="mi">9345&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">proxy_pass&lt;/span> &lt;span class="n">rancher_servers_9345&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">log_format&lt;/span> &lt;span class="n">basic&lt;/span> &lt;span class="s1">&amp;#39;$remote_addr [$time_local] &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;$protocol $status $bytes_sent $bytes_received &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;$session_time &amp;#34;$upstream_addr&amp;#34; &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;&amp;#34;$upstream_bytes_sent&amp;#34; &amp;#34;$upstream_bytes_received&amp;#34; &amp;#34;$upstream_connect_time&amp;#34;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">access_log&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">access&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span> &lt;span class="n">basic&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error_log&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nb">log&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">error&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>啟動服務&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:/etc/nginx&amp;gt; sudo nginx -t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nginx: configuration file /etc/nginx/nginx.conf test is successful
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:/etc/nginx&amp;gt; sudo systemctl enable nginx --now
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/nginx.service → /usr/lib/systemd/system/nginx.service.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h3 id="調整防火牆設定">調整防火牆設定
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">firewall&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cmd&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">80&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">permanent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">firewall&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cmd&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">443&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">permanent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">firewall&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cmd&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">6443&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">permanent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">firewall&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cmd&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">9345&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tcp&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">permanent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">firewall&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cmd&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">reload&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Inbound Rules for RKE2 Server Nodes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Protocol Port Source Description
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 9345 RKE2 agent nodes Kubernetes API
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 6443 RKE2 agent nodes Kubernetes API
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UDP 8472 RKE2 server and agent nodes Required only for Flannel VXLAN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 10250 RKE2 server and agent nodes kubelet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 2379 RKE2 server nodes etcd client port
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 2380 RKE2 server nodes etcd peer port
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 30000-32767 RKE2 server and agent nodes NodePort port range
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UDP 8472 RKE2 server and agent nodes Cilium CNI VXLAN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 4240 RKE2 server and agent nodes Cilium CNI health checks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ICMP 8/0 RKE2 server and agent nodes Cilium CNI health checks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 179 RKE2 server and agent nodes Calico CNI with BGP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UDP 4789 RKE2 server and agent nodes Calico CNI with VXLAN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 5473 RKE2 server and agent nodes Calico CNI with Typha
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 9098 RKE2 server and agent nodes Calico Typha health checks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 9099 RKE2 server and agent nodes Calico health checks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 5473 RKE2 server and agent nodes Calico CNI with Typha
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UDP 8472 RKE2 server and agent nodes Canal CNI with VXLAN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TCP 9099 RKE2 server and agent nodes Canal CNI health checks
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UDP 51820 RKE2 server and agent nodes Canal CNI with WireGuard IPv4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">UDP 51821 RKE2 server and agent nodes Canal CNI with WireGuard IPv6/dual-stack
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>用ansible來執行開啟port (針對各個nodes)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC aps-rancher % cat inventory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[rke2-cluster]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.2.[71:73] ansible_ssh_pass=P@55w.rd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[downstream]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.2.[74:78] ansible_ssh_pass=P@55w.rd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC aps-rancher % cat ansible.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[defaults]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">inventory = /Users/wangken/ansible/infoserver/aps-rancher/inventory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">remote_user = devop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo_user = root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host_key_checking = False
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[privilege_escalation]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">become = true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">become_user = root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">become_ask_pass = true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC aps-rancher % cat firewall.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- hosts: rke2-cluster
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tasks:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> firewalld:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> port: &amp;#34;{{ item }}&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> permanent: yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> immediate: yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> state: enabled
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> with_items:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 9345/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 6443/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 8472/udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 10250/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 2379-2380/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 30000-32767/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 8472/udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 4240/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 179/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 4789/udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 5473/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 9098/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 9099/tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 8472/udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 51820/udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 51821/udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wangken@wangken-MAC aps-rancher % ansible-playbook firewall.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TASK [firewalld] ***************************************************************
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.73] =&amp;gt; (item=9345/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.72] =&amp;gt; (item=9345/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.71] =&amp;gt; (item=9345/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.72] =&amp;gt; (item=6443/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.73] =&amp;gt; (item=6443/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.71] =&amp;gt; (item=6443/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.73] =&amp;gt; (item=8472/udp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.72] =&amp;gt; (item=8472/udp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.71] =&amp;gt; (item=8472/udp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.73] =&amp;gt; (item=10250/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.71] =&amp;gt; (item=10250/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.72] =&amp;gt; (item=10250/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.72] =&amp;gt; (item=2379-2380/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.73] =&amp;gt; (item=2379-2380/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.71] =&amp;gt; (item=2379-2380/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.71] =&amp;gt; (item=30000-32767/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.73] =&amp;gt; (item=30000-32767/tcp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">changed: [192.168.2.72] =&amp;gt; (item=30000-32767/tcp)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="安裝nfs-server">安裝NFS Server
&lt;/h3>&lt;p>&lt;a class="link" href="https://documentation.suse.com/sles/15-SP1/html/SLES-all/cha-nfs.html" target="_blank" rel="noopener"
>https://documentation.suse.com/sles/15-SP1/html/SLES-all/cha-nfs.html&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>建立NFS Server 目錄&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:/&amp;gt; pwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:/&amp;gt; sudo mkdir nfs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:/&amp;gt; sudo chmod 777 nfs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:/&amp;gt; ll
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxrwxrwx 1 root root 0 11月 8 14:33 nfs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>安裝NFS Server套件 (SUSE OS)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:/home&amp;gt; sudo zypper install yast2-nfs-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">下列 1 個推薦的套件已自動被選取：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfs-kernel-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">將會安裝下列 2 個新的套件：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfs-kernel-server yast2-nfs-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>設定nfs-server path&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">vim&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">exports&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">exports&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># See the exports(5) manpage for a description of the syntax of this file.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This file contains a list of all directories that are to be exported to &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># other computers via NFS (Network File System).&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This file used by rpc.nfsd and rpc.mountd. See their manpages for details&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on how make changes in this file effective.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">255.255&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">255.0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">sync&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">no_root_squash&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">insecure&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 參數&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">rw&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">write&lt;/span>&lt;span class="err">，可讀寫的權限；&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">ro&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">only&lt;/span>&lt;span class="err">，唯讀的權限；&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">sync&lt;/span>&lt;span class="err">：資料同步寫入到記憶體與硬碟當中；&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">async&lt;/span>&lt;span class="err">：資料會先暫存於記憶體當中，而非直接寫入硬碟。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">no_root_squash&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">登入&lt;/span> &lt;span class="n">NFS&lt;/span> &lt;span class="err">主機使用分享目錄的使用者如果是&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="err">，對於分享的目錄具有&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="err">的權限。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">極不安全，不建議使用。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">root_squash&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">登入&lt;/span> &lt;span class="n">NFS&lt;/span> &lt;span class="err">主機使用分享目錄的使用者如果是&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="err">，權限將被壓縮成匿名使用者，&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">通常他的&lt;/span> &lt;span class="n">UID&lt;/span> &lt;span class="err">與&lt;/span> &lt;span class="n">GID&lt;/span> &lt;span class="err">都會變成&lt;/span> &lt;span class="n">nobody&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">nfsnobody&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">那個系統帳號的身份；&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">all_squash&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">不論登入&lt;/span> &lt;span class="n">NFS&lt;/span> &lt;span class="err">的使用者身份為何，都會被壓縮成為匿名使用者，通常是&lt;/span> &lt;span class="n">nobody&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">nfsnobody&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">anonuid&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">anon&lt;/span> &lt;span class="err">意指&lt;/span> &lt;span class="n">anonymous&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="err">匿名者&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">，自訂匿名使用者的&lt;/span> &lt;span class="n">UID&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span> &lt;span class="n">anongid&lt;/span>&lt;span class="err">：自訂匿名使用者的是變成&lt;/span> &lt;span class="n">GID&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>啟動nfs server、調整防火牆&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">now&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">firewall&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cmd&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">nfs&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">permanent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="err">的密碼：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">firewall&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cmd&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">reload&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">success&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">showmount&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">e&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Export&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">255.255&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">255.0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h2 id="安裝rke2-1">安裝RKE2-1
&lt;/h2>&lt;ol>
&lt;li>安裝OS&lt;/li>
&lt;li>調整DNS 指向192.168.33.40&lt;/li>
&lt;li>關閉防火牆&lt;/li>
&lt;/ol>
&lt;h3 id="安裝rke2">安裝RKE2
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>下載install.sh&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rke2-1:~&amp;gt; curl -sfL https://get.rke2.io --output install.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rke2-1:~&amp;gt; chmod +x install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>新增設定檔&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rke2-1:~&amp;gt; sudo mkdir -p /etc/rancher/rke2/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rke2-1:~&amp;gt; sudo vim /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node-name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;rke2-1&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">token: my-shared-secret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tls-san:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - rms.rancher.ken.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> devop@rke2-1:~&amp;gt; rke2 etcd-snapshot save \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --name pre-upgrade-snapshot
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>安裝rke2 &amp;ndash; version 1.23.9&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">INSTALL_RKE2_CHANNEL&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">WARN&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">only&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">mount&lt;/span> &lt;span class="n">point&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">installing&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">finding&lt;/span> &lt;span class="n">release&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">channel&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span> &lt;span class="n">as&lt;/span> &lt;span class="n">release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">checksums&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sha256sum&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">verifying&lt;/span> &lt;span class="n">tarball&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">unpacking&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">updating&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">contents&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">reflect&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">systemd&lt;/span> &lt;span class="n">units&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">complete&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">may&lt;/span> &lt;span class="n">want&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">run&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">now&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol>
&lt;li>調整kubectl 、rke2 指令及kubeconfig &amp;raquo; 可把 rke2、kubectl、rke2.yaml scp到 rms&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">chown&lt;/span> &lt;span class="n">devop&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubectl&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">scp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.40&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">devop&lt;/span>&lt;span class="o">/.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">The&lt;/span> &lt;span class="n">authenticity&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">host&lt;/span> &lt;span class="s1">&amp;#39;192.168.33.40 (192.168.33.40)&amp;#39;&lt;/span> &lt;span class="n">can&lt;/span>&lt;span class="s1">&amp;#39;t be established.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">ECDSA&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="n">fingerprint&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">SHA256&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">NS1PCnKGGGiOsCVPSdoRDhX5jq0yhqhtEIr3pMNDSzw&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Are&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">sure&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">want&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="k">continue&lt;/span> &lt;span class="n">connecting&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">yes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">no&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">fingerprint&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="n">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Warning&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Permanently&lt;/span> &lt;span class="n">added&lt;/span> &lt;span class="s1">&amp;#39;192.168.33.40&amp;#39;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ECDSA&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">known&lt;/span> &lt;span class="n">hosts&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Password&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="o">%&lt;/span> &lt;span class="mi">2969&lt;/span> &lt;span class="mf">2.6&lt;/span>&lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">scp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubectl&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.40&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Password&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kubectl&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="o">%&lt;/span> &lt;span class="mi">47&lt;/span>&lt;span class="n">MB&lt;/span> &lt;span class="mf">220.3&lt;/span>&lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認pod status (切到 rms來操作)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get pods -A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system cloud-controller-manager-rke2-1 1/1 Running 0 5m46s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system etcd-rke2-1 1/1 Running 0 5m30s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-canal-9pg26 0/1 Completed 0 5m35s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-coredns-d4j4q 0/1 Completed 0 5m35s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-ingress-nginx-gz7db 0/1 Completed 0 5m35s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-metrics-server-fx65q 0/1 Completed 0 5m35s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-apiserver-rke2-1 1/1 Running 0 5m21s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-controller-manager-rke2-1 1/1 Running 0 5m47s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-proxy-rke2-1 1/1 Running 0 5m43s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-scheduler-rke2-1 1/1 Running 0 5m47s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-canal-qkrdv 2/2 Running 0 5m19s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-coredns-rke2-coredns-545d64676-2q6x9 1/1 Running 0 5m20s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-coredns-rke2-coredns-autoscaler-5dd676f5c7-5bwdl 1/1 Running 0 5m20s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-ingress-nginx-controller-gxp6v 1/1 Running 0 4m42s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-metrics-server-6564db4569-98ghm 1/1 Running 0 4m53s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>安裝Helm&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; wget https://get.helm.sh/helm-v3.8.2-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--2022-10-25 16:55:33-- https://get.helm.sh/helm-v3.8.2-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Resolving get.helm.sh (get.helm.sh)... 152.199.39.108, 2606:2800:247:1cb7:261b:1f9c:2074:3c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connecting to get.helm.sh (get.helm.sh)|152.199.39.108|:443... connected.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTTP request sent, awaiting response... 200 OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Length: 13633605 (13M) [application/x-tar]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saving to: ‘helm-v3.8.2-linux-amd64.tar.gz’
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">helm-v3.8.2-linux-amd64.ta 100%[=======================================&amp;gt;] 13.00M 34.4MB/s in 0.4s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2022-10-25 16:55:35 (34.4 MB/s) - ‘helm-v3.8.2-linux-amd64.tar.gz’ saved [13633605/13633605]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; tar zxvf helm-v3.8.2-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/helm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/LICENSE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/README.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; sudo cp linux-amd64/helm /usr/local/bin/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">version.BuildInfo{Version:&amp;#34;v3.8.2&amp;#34;, GitCommit:&amp;#34;6e3701edea09e5d55a8ca2aae03a68917630e91b&amp;#34;, GitTreeState:&amp;#34;clean&amp;#34;, GoVersion:&amp;#34;go1.17.5&amp;#34;}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h3 id="install-rancher-and-cert-manager">install rancher and cert-manager
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>Add helm repo &amp;amp; Install Cert-manager&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">stable&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">charts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">stable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;rancher-stable&amp;#34;&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">added&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">repositories&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">create&lt;/span> &lt;span class="n">namespace&lt;/span> &lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">namespace&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">apply&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crds&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificaterequests&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificates&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">challenges&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">clusterissuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">issuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">jetstack&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">charts&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jetstack&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;jetstack&amp;#34;&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">added&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">repositories&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">update&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Hang&lt;/span> &lt;span class="n">tight&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="n">we&lt;/span> &lt;span class="n">grab&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">latest&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repositories&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;span class="n">Successfully&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">update&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="s2">&amp;#34;jetstack&amp;#34;&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repository&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;span class="n">Successfully&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">update&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="s2">&amp;#34;rancher-stable&amp;#34;&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repository&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Update&lt;/span> &lt;span class="n">Complete&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="err">⎈&lt;/span>&lt;span class="n">Happy&lt;/span> &lt;span class="n">Helming&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="err">⎈&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">jetstack&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">create&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">namespace&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">version&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">LAST&lt;/span> &lt;span class="n">DEPLOYED&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Tue&lt;/span> &lt;span class="n">Oct&lt;/span> &lt;span class="mi">25&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">01&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">20&lt;/span> &lt;span class="mi">2022&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAMESPACE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">STATUS&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">deployed&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">REVISION&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">TEST&lt;/span> &lt;span class="n">SUITE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NOTES&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">deployed&lt;/span> &lt;span class="n">successfully&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="n">order&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">begin&lt;/span> &lt;span class="n">issuing&lt;/span> &lt;span class="n">certificates&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">will&lt;/span> &lt;span class="n">need&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">set&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">ClusterIssuer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="ow">or&lt;/span> &lt;span class="n">Issuer&lt;/span> &lt;span class="n">resource&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">for&lt;/span> &lt;span class="n">example&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">creating&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;letsencrypt-staging&amp;#39;&lt;/span> &lt;span class="n">issuer&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">More&lt;/span> &lt;span class="n">information&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">different&lt;/span> &lt;span class="n">types&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">issuers&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">how&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">them&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">can&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">found&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">our&lt;/span> &lt;span class="n">documentation&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">configuration&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">For&lt;/span> &lt;span class="n">information&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">how&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">automatically&lt;/span> &lt;span class="n">provision&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Certificates&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">Ingress&lt;/span> &lt;span class="n">resources&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">take&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">look&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="err">`&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">shim&lt;/span>&lt;span class="err">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">documentation&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">usage&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">pods&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span> &lt;span class="n">READY&lt;/span> &lt;span class="n">STATUS&lt;/span> &lt;span class="n">RESTARTS&lt;/span> &lt;span class="n">AGE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">76&lt;/span>&lt;span class="n">d44b459c&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">xnr7q&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cainjector&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="n">b679cc6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="n">lk2m&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">webhook&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">57&lt;/span>&lt;span class="n">c994b6b9&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">hssn2&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">75&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>安裝Rancher&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm install rancher rancher-stable/rancher --namespace cattle-system --set hostname=rms.rancher.ken.lab --version 2.6.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME: rancher
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">LAST DEPLOYED: Tue Oct 25 17:05:13 2022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE: cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">STATUS: deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">REVISION: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TEST SUITE: None
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOTES:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Rancher Server has been installed.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOTE: Rancher may take several minutes to fully initialize. Please standby while Certificates are being issued, Containers are started and the Ingress rule comes up.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Check out our docs at https://rancher.com/docs/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If you provided your own bootstrap password during installation, browse to https://rms.rancher.ken.lab to get started.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If this is the first time you installed Rancher, get started by running this command and clicking the URL it generates:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo https://rms.rancher.ken.lab/dashboard/?setup=$(kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&amp;#39;{{.data.bootstrapPassword|base64decode}}&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">To get just the bootstrap password on its own, run:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&amp;#39;{{.data.bootstrapPassword|base64decode}}{{ &amp;#34;\n&amp;#34; }}&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Happy Containering!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-----
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&amp;#39;{{.data.bootstrapPassword|base64decode}}{{ &amp;#34;\n&amp;#34; }}&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mc85v6z7s6tnfcrwpnd67pg4phlnnch64gwsd5gwkflsmt8bjqckgg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>瀏覽器連線 &lt;a class="link" href="https://rms.rancher.ken.lab" target="_blank" rel="noopener"
>https://rms.rancher.ken.lab&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025170335200.png"
loading="lazy"
alt="image-20221025170335200"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>登入後修改預設密碼
admin / rancheradmin
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025170619277.png"
loading="lazy"
alt="image-20221025170619277"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>登入測試
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025170758099.png"
loading="lazy"
alt="image-20221025170758099"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="安裝rke2-2">安裝RKE2-2
&lt;/h2>&lt;ol>
&lt;li>安裝OS&lt;/li>
&lt;li>調整DNS 指向192.168.33.40&lt;/li>
&lt;li>關閉防火牆&lt;/li>
&lt;/ol>
&lt;h3 id="安裝rke2-3">安裝RKE2
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>下載install.sh&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rke2-2:~&amp;gt; curl -sfL https://get.rke2.io --output install.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rke2-2:~&amp;gt; chmod +x install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>新增設定檔&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rke2-2:~&amp;gt; sudo mkdir -p /etc/rancher/rke2/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rke2-2:~&amp;gt; sudo vim /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server: https://rms.rancher.ken.lab:9345
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node-name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;rke2-2&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">token: my-shared-secret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tls-san:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - rms.rancher.ken.lab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>安裝rke2&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rke2-2:~&amp;gt; sudo INSTALL_RKE2_CHANNEL=v1.23.9+rke2r1 ./install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>啟動服務&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">now&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">status&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">●&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">Rancher&lt;/span> &lt;span class="n">Kubernetes&lt;/span> &lt;span class="n">Engine&lt;/span> &lt;span class="n">v2&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Loaded&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">loaded&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">enabled&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">vendor&lt;/span> &lt;span class="n">preset&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">disabled&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Active&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">active&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">running&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">since&lt;/span> &lt;span class="n">Tue&lt;/span> &lt;span class="mi">2022&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">25&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">53&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">05&lt;/span> &lt;span class="n">CST&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="nb">min&lt;/span> &lt;span class="n">ago&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Docs&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="c1">#readme&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Process&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5602&lt;/span> &lt;span class="n">ExecStartPre&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">xc&lt;/span> &lt;span class="o">!&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemctl&lt;/span> &lt;span class="n">is&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">enabled&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">quiet&lt;/span> &lt;span class="n">nm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cloud&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SUCCESS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Process&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5604&lt;/span> &lt;span class="n">ExecStartPre&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">modprobe&lt;/span> &lt;span class="n">br_netfilter&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SUCCESS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Process&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5605&lt;/span> &lt;span class="n">ExecStartPre&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">modprobe&lt;/span> &lt;span class="n">overlay&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SUCCESS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Main&lt;/span> &lt;span class="n">PID&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5606&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Tasks&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">148&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>切換到RMS 確認nodes狀態&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get nodes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS ROLES AGE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-1 Ready control-plane,etcd,master 81m v1.23.9+rke2r1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-2 Ready control-plane,etcd,master 17m v1.23.9+rke2r1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h2 id="安裝rke-2-3">安裝RKE 2-3
&lt;/h2>&lt;ol>
&lt;li>安裝OS&lt;/li>
&lt;li>調整DNS 指向192.168.33.40&lt;/li>
&lt;li>關閉防火牆&lt;/li>
&lt;/ol>
&lt;h3 id="安裝rke2-4">安裝RKE2
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>下載install.sh&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rke2-3:~&amp;gt; curl -sfL https://get.rke2.io --output install.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rke2-3:~&amp;gt; chmod +x install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>新增設定檔&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rke2-3:~&amp;gt; sudo mkdir -p /etc/rancher/rke2/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rke2-3:~&amp;gt; sudo vim /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server: https://rms.rancher.ken.lab:9345
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node-name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;rke2-3&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">token: my-shared-secret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tls-san:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - rms.rancher.ken.lab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>安裝rke2&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">INSTALL_RKE2_CHANNEL&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">WARN&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">only&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">mount&lt;/span> &lt;span class="n">point&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">installing&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">finding&lt;/span> &lt;span class="n">release&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">channel&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span> &lt;span class="n">as&lt;/span> &lt;span class="n">release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">checksums&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sha256sum&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">verifying&lt;/span> &lt;span class="n">tarball&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">unpacking&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">updating&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">contents&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">reflect&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">systemd&lt;/span> &lt;span class="n">units&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">complete&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">may&lt;/span> &lt;span class="n">want&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">run&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>啟動服務&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">now&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>切換到RMS 確認Nodes&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get nodes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS ROLES AGE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-1 Ready control-plane,etcd,master 91m v1.23.9+rke2r1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-2 Ready control-plane,etcd,master 27m v1.23.9+rke2r1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-3 Ready control-plane,etcd,master 58s v1.23.9+rke2r1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221025181826167.png"
loading="lazy"
alt="image-20221025181826167"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="新增down-stream-k8s">新增Down Stream K8s
&lt;/h1>&lt;h2 id="架構-建議用v124以上">架構 建議用v1.24以上
&lt;/h2>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026120534677.png"
loading="lazy"
alt="image-20221026120534677"
>&lt;/p>
&lt;h2 id="作業系統與安裝dokcer">作業系統與安裝Dokcer
&lt;/h2>&lt;p>要關閉防火牆、安裝Docker (用RKE2 不用安裝Docker)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">需先註冊系統或是設定repo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">master01&lt;/span>&lt;span class="p">:~&amp;gt;&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">SUSEConnect&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">sle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">module&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">containers&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">15.4&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">x86_64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Registering&lt;/span> &lt;span class="nx">system&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">SUSE&lt;/span> &lt;span class="nx">Customer&lt;/span> &lt;span class="nx">Center&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Updating&lt;/span> &lt;span class="nx">system&lt;/span> &lt;span class="nx">details&lt;/span> &lt;span class="nx">on&lt;/span> &lt;span class="nx">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//scc.suse.com ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Activating&lt;/span> &lt;span class="nx">sle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">module&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">containers&lt;/span> &lt;span class="mf">15.4&lt;/span> &lt;span class="nx">x86_64&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">Adding&lt;/span> &lt;span class="nx">service&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">system&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">Installing&lt;/span> &lt;span class="nx">release&lt;/span> &lt;span class="kn">package&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Successfully&lt;/span> &lt;span class="nx">registered&lt;/span> &lt;span class="nx">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">---&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">master01&lt;/span>&lt;span class="p">:~&amp;gt;&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">zypper&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">n&lt;/span> &lt;span class="nx">install&lt;/span> &lt;span class="nx">docker&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在重新整理服務&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">Basesystem_Module_15_SP4_x86_64&lt;/span>&lt;span class="err">&amp;#39;。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在重新整理服務&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">Containers_Module_15_SP4_x86_64&lt;/span>&lt;span class="err">&amp;#39;。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在重新整理服務&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">SUSE_Linux_Enterprise_Server_15_SP4_x86_64&lt;/span>&lt;span class="err">&amp;#39;。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在重新整理服務&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">Server_Applications_Module_15_SP4_x86_64&lt;/span>&lt;span class="err">&amp;#39;。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在載入套件庫資料&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在讀取已安裝的套件&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在解決套件相依性&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">下列&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="nx">個推薦的套件已自動被選取&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">git&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">core&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">將會安裝下列&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="nx">個新的套件&lt;/span>&lt;span class="err">：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">catatonit&lt;/span> &lt;span class="nx">containerd&lt;/span> &lt;span class="nx">docker&lt;/span> &lt;span class="nx">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">completion&lt;/span> &lt;span class="nx">git&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">core&lt;/span> &lt;span class="nx">libsha1detectcoll1&lt;/span> &lt;span class="nx">runc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">7&lt;/span> &lt;span class="nx">要安裝的新套件&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">全部下載大小&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mf">52.2&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="err">。&lt;/span>&lt;span class="nx">已快取&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="nx">B&lt;/span>&lt;span class="err">。&lt;/span> &lt;span class="nx">完成操作後&lt;/span>&lt;span class="err">，&lt;/span>&lt;span class="nx">將使用額外的&lt;/span> &lt;span class="mf">242.1&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="err">。&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">要繼續嗎&lt;/span>&lt;span class="err">？&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">v&lt;/span>&lt;span class="o">/...&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="nx">顯示所有選項&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">y&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="nx">y&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取出&lt;/span> &lt;span class="nx">套件&lt;/span> &lt;span class="nx">libsha1detectcoll1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.0.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.18&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">x86_64&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">23.2&lt;/span> &lt;span class="nf">KiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">已解開&lt;/span> &lt;span class="mf">45.8&lt;/span> &lt;span class="nx">KiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取回&lt;/span>&lt;span class="err">︰&lt;/span> &lt;span class="nx">libsha1detectcoll1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.0.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.18&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">rpm&lt;/span> &lt;span class="o">..........................................&lt;/span>&lt;span class="p">.[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取出&lt;/span> &lt;span class="nx">套件&lt;/span> &lt;span class="nx">catatonit&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.1.5&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.3.2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">x86_64&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">257.2&lt;/span> &lt;span class="nf">KiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">已解開&lt;/span> &lt;span class="mf">696.5&lt;/span> &lt;span class="nx">KiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取回&lt;/span>&lt;span class="err">︰&lt;/span> &lt;span class="nx">catatonit&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.1.5&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.3.2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">rpm&lt;/span> &lt;span class="o">...................................................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取出&lt;/span> &lt;span class="nx">套件&lt;/span> &lt;span class="nx">runc&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.1.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.33.4&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">x86_64&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">2.6&lt;/span> &lt;span class="nf">MiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">已解開&lt;/span> &lt;span class="mf">9.1&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取回&lt;/span>&lt;span class="err">︰&lt;/span> &lt;span class="nx">runc&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.1.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.33.4&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">rpm&lt;/span> &lt;span class="o">....................................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">完成&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mf">288.0&lt;/span> &lt;span class="nx">KiB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取出&lt;/span> &lt;span class="nx">套件&lt;/span> &lt;span class="nx">containerd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.6.6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.73.2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">x86_64&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">17.7&lt;/span> &lt;span class="nf">MiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">已解開&lt;/span> &lt;span class="mf">74.2&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取回&lt;/span>&lt;span class="err">︰&lt;/span> &lt;span class="nx">containerd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.6.6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.73.2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">rpm&lt;/span> &lt;span class="o">..............................&lt;/span>&lt;span class="p">..[&lt;/span>&lt;span class="nx">完成&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mf">3.6&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取出&lt;/span> &lt;span class="nx">套件&lt;/span> &lt;span class="nx">git&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">core&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.35.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150300.10.15.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">x86_64&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">4.8&lt;/span> &lt;span class="nf">MiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">已解開&lt;/span> &lt;span class="mf">26.6&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取回&lt;/span>&lt;span class="err">︰&lt;/span> &lt;span class="nx">git&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">core&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.35.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150300.10.15.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">rpm&lt;/span> &lt;span class="o">..........................................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取出&lt;/span> &lt;span class="nx">套件&lt;/span> &lt;span class="nx">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">20.10.17&lt;/span>&lt;span class="nx">_ce&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.166.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">x86_64&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">26.6&lt;/span> &lt;span class="nf">MiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">已解開&lt;/span> &lt;span class="mf">131.4&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取回&lt;/span>&lt;span class="err">︰&lt;/span> &lt;span class="nx">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">20.10.17&lt;/span>&lt;span class="nx">_ce&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.166.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">rpm&lt;/span> &lt;span class="o">...........................&lt;/span>&lt;span class="p">..[&lt;/span>&lt;span class="nx">完成&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mf">7.9&lt;/span> &lt;span class="nx">MiB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取出&lt;/span> &lt;span class="nx">套件&lt;/span> &lt;span class="nx">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">completion&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">20.10.17&lt;/span>&lt;span class="nx">_ce&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.166.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">noarch&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">(&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mf">121.3&lt;/span> &lt;span class="nf">KiB&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">已解開&lt;/span> &lt;span class="mf">113.6&lt;/span> &lt;span class="nx">KiB&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在取回&lt;/span>&lt;span class="err">︰&lt;/span> &lt;span class="nx">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">completion&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">20.10.17&lt;/span>&lt;span class="nx">_ce&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.166.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">noarch&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">rpm&lt;/span> &lt;span class="o">........................&lt;/span>&lt;span class="p">.[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">正在檢查檔案衝突&lt;/span>&lt;span class="err">：&lt;/span> &lt;span class="o">...........................................................................&lt;/span>&lt;span class="p">.[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">正在安裝&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">libsha1detectcoll1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.0.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.18&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span> &lt;span class="o">..........................................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">正在安裝&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">catatonit&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">0.1.5&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">3.3.2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span> &lt;span class="o">................................................&lt;/span>&lt;span class="p">..[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">正在安裝&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">runc&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.1.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.33.4&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span> &lt;span class="o">................................................&lt;/span>&lt;span class="p">.[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">正在安裝&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">containerd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1.6.6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.73.2&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span> &lt;span class="o">..........................................&lt;/span>&lt;span class="p">.[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">正在安裝&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">git&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">core&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.35.3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150300.10.15.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span> &lt;span class="o">.......................................&lt;/span>&lt;span class="p">..[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Updating&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">sysconfig&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">docker&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">正在安裝&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">20.10.17&lt;/span>&lt;span class="nx">_ce&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.166.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">x86_64&lt;/span> &lt;span class="o">.......................................&lt;/span>&lt;span class="p">.[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">(&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">正在安裝&lt;/span>&lt;span class="err">：&lt;/span>&lt;span class="nx">docker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">bash&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">completion&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">20.10.17&lt;/span>&lt;span class="nx">_ce&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">150000.166.1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">noarch&lt;/span> &lt;span class="o">........................&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">完成&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">---&lt;/span> &lt;span class="nx">啟動服務&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">master01&lt;/span>&lt;span class="p">:~&amp;gt;&lt;/span> &lt;span class="nx">sudo&lt;/span> &lt;span class="nx">systemctl&lt;/span> &lt;span class="nx">enable&lt;/span> &lt;span class="nx">docker&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">now&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Created&lt;/span> &lt;span class="nx">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">user&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">target&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">docker&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">docker&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">service&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="從rancher管理介面新增cluster">從Rancher管理介面新增Cluster
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>點選Create
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026121450385.png"
loading="lazy"
alt="image-20221026121450385"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>選擇Custom 要把RKE2的選項打勾 才可以選擇RKE2
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026121555947.png"
loading="lazy"
alt="image-20221026121555947"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221027165708557.png"
loading="lazy"
alt="image-20221027165708557"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>建立名稱: DownStreamK8S ，其他Default即可
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026121636567.png"
loading="lazy"
alt="image-20221026121636567"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>針對各Node選擇不同的指令-Master
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026121758039.png"
loading="lazy"
alt="image-20221026121758039"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>直接貼在Master01、Master02、Ｍaster03上
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026123232444.png"
loading="lazy"
alt="image-20221026123232444"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>針對各Node選擇不同的指令-Master
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026123846849.png"
loading="lazy"
alt="image-20221026123846849"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>直接貼在Woker01、Worker02
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026123951429.png"
loading="lazy"
alt="image-20221026123951429"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>查看Log
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026124043002.png"
loading="lazy"
alt="image-20221026124043002"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221026132912006.png"
loading="lazy"
alt="image-20221026132912006"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>查看Cluster狀態
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221027134018550.png"
loading="lazy"
alt="image-20221027134018550"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h1 id="安裝後的設定">安裝後的設定
&lt;/h1>&lt;h2 id="authentication-ldap">Authentication LDAP
&lt;/h2>&lt;ol>
&lt;li>點到Users &amp;amp; Authentication
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028173919721.png"
loading="lazy"
alt="image-20221028173919721"
>&lt;/li>
&lt;li>設定參數並Enable
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028181954045.png"
loading="lazy"
alt="image-20221028181954045"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028174539292.png"
loading="lazy"
alt="image-20221028174539292"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028182009242.png"
loading="lazy"
alt="image-20221028182009242"
>&lt;/li>
&lt;li>指定特定Group可存取Rancher
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028182709975.png"
loading="lazy"
alt="image-20221028182709975"
>&lt;/li>
&lt;li>登入測試
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028182305555.png"
loading="lazy"
alt="image-20221028182305555"
>&lt;/li>
&lt;li>調整群組權限 Assign Global Roles
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028182403843.png"
loading="lazy"
alt="image-20221028182403843"
>&lt;/li>
&lt;li>加入ranchers的群組為Administrator 並Save
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028182450209.png"
loading="lazy"
alt="image-20221028182450209"
>&lt;/li>
&lt;li>確認權限
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028182514532.png"
loading="lazy"
alt="image-20221028182514532"
>&lt;/li>
&lt;/ol>
&lt;h2 id="storage設定">Storage設定
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>在Local Cluster的infra project建立rancher-nfs-storage的namespace
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031171840318.png"
loading="lazy"
alt="image-20221031171840318"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>建立namespace
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031172147900.png"
loading="lazy"
alt="image-20221031172147900"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Storage Class的yaml&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~/config&amp;gt; cat storageclass.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: storage.k8s.io/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: StorageClass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> annotations:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 設定為default StorageClass，如果建立pvc時不指定StorageClass，則會使用當前的StorageClass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storageclass.kubernetes.io/is-default-class: &amp;#34;true&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: default-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">provisioner: provisioner-nfs # or choose another name, must match deployment&amp;#39;s env PROVISIONER_NAME&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">parameters:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 刪除PVC時不會保留資料
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> archiveOnDelete: &amp;#34;false&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># 回收策略：刪除
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reclaimPolicy: Delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#允許pvc建立後擴容
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">allowVolumeExpansion: true
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>Deployment.yaml&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~/config&amp;gt; cat deployment.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: apps/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Deployment
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # replace with namespace where provisioner is deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> replicas: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> strategy:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type: Recreate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> selector:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> matchLabels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> template:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> serviceAccountName: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> containers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> image: k8s.gcr.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumeMounts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: nfs-client-root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: /persistentvolumes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: PROVISIONER_NAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> value: provisioner-nfs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: NFS_SERVER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> value: 192.168.33.40
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: NFS_PATH
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> value: /nfs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: nfs-client-root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server: 192.168.33.40
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> path: /nfs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>rbac.yaml&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: ServiceAccount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # replace with namespace where provisioner is deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: ClusterRole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: rbac.authorization.k8s.io/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: nfs-client-provisioner-runner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rules:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apiGroups: [&amp;#34;&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources: [&amp;#34;persistentvolumes&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verbs: [&amp;#34;get&amp;#34;, &amp;#34;list&amp;#34;, &amp;#34;watch&amp;#34;, &amp;#34;create&amp;#34;, &amp;#34;delete&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apiGroups: [&amp;#34;&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources: [&amp;#34;persistentvolumeclaims&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verbs: [&amp;#34;get&amp;#34;, &amp;#34;list&amp;#34;, &amp;#34;watch&amp;#34;, &amp;#34;update&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apiGroups: [&amp;#34;storage.k8s.io&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources: [&amp;#34;storageclasses&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verbs: [&amp;#34;get&amp;#34;, &amp;#34;list&amp;#34;, &amp;#34;watch&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apiGroups: [&amp;#34;&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources: [&amp;#34;events&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verbs: [&amp;#34;create&amp;#34;, &amp;#34;update&amp;#34;, &amp;#34;patch&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apiGroups: [&amp;#34;&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources: [&amp;#34;services&amp;#34;, &amp;#34;endpoints&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verbs: [&amp;#34;get&amp;#34;,&amp;#34;create&amp;#34;,&amp;#34;list&amp;#34;, &amp;#34;watch&amp;#34;,&amp;#34;update&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apiGroups: [&amp;#34;extensions&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources: [&amp;#34;podsecuritypolicies&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resourceNames: [&amp;#34;nfs-client-provisioner&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verbs: [&amp;#34;use&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: ClusterRoleBinding
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: rbac.authorization.k8s.io/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: run-nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">subjects:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - kind: ServiceAccount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # replace with namespace where provisioner is deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">roleRef:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kind: ClusterRole
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: nfs-client-provisioner-runner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> apiGroup: rbac.authorization.k8s.io
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Role
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: rbac.authorization.k8s.io/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: leader-locking-nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # replace with namespace where provisioner is deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rules:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - apiGroups: [&amp;#34;&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources: [&amp;#34;endpoints&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> verbs: [&amp;#34;get&amp;#34;, &amp;#34;list&amp;#34;, &amp;#34;watch&amp;#34;, &amp;#34;create&amp;#34;, &amp;#34;update&amp;#34;, &amp;#34;patch&amp;#34;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: RoleBinding
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: rbac.authorization.k8s.io/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: leader-locking-nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # replace with namespace where provisioner is deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">subjects:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - kind: ServiceAccount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # replace with namespace where provisioner is deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">roleRef:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kind: Role
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: leader-locking-nfs-client-provisioner
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> apiGroup: rbac.authorization.k8s.io
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>NFS Server先設定好可連線的主機&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">範例：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">auth&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="c1"># cat /etc/exports&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfsshare&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">sync&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">no_wdelay&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">no_root_squash&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">insecure&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">---&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">cat&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">exports&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mf">255.255&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">255.0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">sync&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">no_root_squash&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">insecure&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>將rbac.yaml 、storage class.yaml、deployment.yaml部署到rancher-nfs-storage的NS上&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~/config&amp;gt; kubectl create -f rbac.yaml -f storageclass.yaml -f deployment.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">serviceaccount/nfs-client-provisioner created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">clusterrole.rbac.authorization.k8s.io/nfs-client-provisioner-runner created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">clusterrolebinding.rbac.authorization.k8s.io/run-nfs-client-provisioner created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">role.rbac.authorization.k8s.io/leader-locking-nfs-client-provisioner created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rolebinding.rbac.authorization.k8s.io/leader-locking-nfs-client-provisioner created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">storageclass.storage.k8s.io/default-nfs-storage created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/nfs-client-provisioner created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; kubectl get all -n rancher-nfs-storage
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/nfs-client-provisioner-6b8787f55b-r4m4t 1/1 Running 0 5m19s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY UP-TO-DATE AVAILABLE AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/nfs-client-provisioner 1/1 1 1 5m19s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME DESIRED CURRENT READY AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">replicaset.apps/nfs-client-provisioner-6b8787f55b 1 1 1 5m19s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>查看WebUI，確認deployment、StorageClass
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108141107082.png"
loading="lazy"
alt="image-20221108141107082"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>新增測試Claim 確認狀態為bound&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; cat test-claim.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: PersistentVolumeClaim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: test-claim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> annotations:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #storageclass 名稱
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volume.beta.kubernetes.io/storage-class: &amp;#34;default-nfs-storage&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #訪問模式
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> accessModes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - ReadWriteMany
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> requests:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #請求資料大小
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storage: 1024Mi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; kubectl create -f test-claim.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolumeclaim/test-claim created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; kubectl get pv,pvc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolume/pvc-f058cf4a-cc7b-4e44-97c3-aa1bfc654b65 1Gi RWX Delete Bound default/test-claim default-nfs-storage 33m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolumeclaim/test-claim Bound pvc-f058cf4a-cc7b-4e44-97c3-aa1bfc654b65 1Gi RWX default-nfs-storage 37m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>新增測試pod 確認可寫入&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@tpeinfoapsrms01:~/nfs&amp;gt; cat test-pod.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Pod
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: test-pod
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> containers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: test-pod
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> image: busybox:latest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> command:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;/bin/sh&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> args:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;-c&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;touch /mnt/SUCCESS &amp;amp;&amp;amp; exit 0 || exit 1&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumeMounts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: nfs-pvc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: &amp;#34;/mnt&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> restartPolicy: &amp;#34;Never&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: nfs-pvc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> persistentVolumeClaim:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> claimName: test-claim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; kubectl create -f test-pod.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/test-pod created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; kubectl get pv,pvc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolume/pvc-f058cf4a-cc7b-4e44-97c3-aa1bfc654b65 1Gi RWX Delete Bound default/test-claim default-nfs-storage 35m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolumeclaim/test-claim Bound pvc-f058cf4a-cc7b-4e44-97c3-aa1bfc654b65 1Gi RWX default-nfs-storage 38m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>WebUI
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031174825937.png"
loading="lazy"
alt="image-20221031174825937"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>刪除測試用的pv,pvc&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; kubectl delete -f test-pod.yaml -f test-claim.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod &amp;#34;test-pod&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolumeclaim &amp;#34;test-claim&amp;#34; deleted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>同樣設定也放到DownStream K8s ，建立時也可透過WEB UI來將yaml檔放到Cluster
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031175458133.png"
loading="lazy"
alt="image-20221031175458133"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031175603727.png"
loading="lazy"
alt="image-20221031175603727"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031175616696.png"
loading="lazy"
alt="image-20221031175616696"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="安裝logging">安裝Logging
&lt;/h2>&lt;ol>
&lt;li>點到local的cluster&lt;/li>
&lt;li>建立project (infra)&lt;/li>
&lt;li>點選Apps &amp;ndash;&amp;gt; Charts &amp;ndash;&amp;gt; logging
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028163035932.png"
loading="lazy"
alt="image-20221028163035932"
>&lt;/li>
&lt;li>Default
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028163149621.png"
loading="lazy"
alt="image-20221028163149621"
>&lt;/li>
&lt;li>開始安裝
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028163228433.png"
loading="lazy"
alt="image-20221028163228433"
>&lt;/li>
&lt;li>重整網頁後即會出現
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028163610607.png"
loading="lazy"
alt="image-20221028163610607"
>&lt;/li>
&lt;li>後續可再針對後端的logging 機制&lt;/li>
&lt;/ol>
&lt;h2 id="安裝monitoring">安裝Monitoring
&lt;/h2>&lt;p>&lt;a class="link" href="https://www.ibm.com/docs/en/cloud-private/3.2.0?topic=console-namespace-is-stuck-in-terminating-state" target="_blank" rel="noopener"
>https://www.ibm.com/docs/en/cloud-private/3.2.0?topic=console-namespace-is-stuck-in-terminating-state&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>點到local的cluster&lt;/p>
&lt;/li>
&lt;li>
&lt;p>建立project (infra)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028161139089.png"
loading="lazy"
alt="image-20221028161139089"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選Apps &amp;ndash;&amp;gt; Charts &amp;ndash;&amp;gt; monitoring
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028160838561.png"
loading="lazy"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選Monitoring &amp;ndash; &amp;gt; Install (安裝到Infra Project)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028163730065.png"
loading="lazy"
alt="image-20221028163730065"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Admin API Enable、PV
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221028163815459.png"
loading="lazy"
alt="image-20221028163815459"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031180012545.png"
loading="lazy"
alt="image-20221031180012545"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Grafana Enable
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031180129747.png"
loading="lazy"
alt="image-20221031180129747"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選Install後重新整理WEB UI，即會出現Monitoring&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031180517689.png"
loading="lazy"
alt="image-20221031180517689"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選Grafana確認資料
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221031180605633.png"
loading="lazy"
alt="image-20221031180605633"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>查詢Grafana預設帳號密碼
會放在cattle-monitoring-system的 Secret裡 (帳密為admin/prom-operator)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230923141114566.png"
loading="lazy"
alt="image-20230923141114566"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="安裝neuvector">安裝Neuvector
&lt;/h2>&lt;p>&lt;a class="link" href="https://www.twblogs.net/a/6225a6dfc1f9c8b6ea0c84d2" target="_blank" rel="noopener"
>https://www.twblogs.net/a/6225a6dfc1f9c8b6ea0c84d2&lt;/a>
&lt;a class="link" href="https://github.com/IBM/Runtime-Container-Security-for-Kube/blob/main/neuvector.yaml" target="_blank" rel="noopener"
>https://github.com/IBM/Runtime-Container-Security-for-Kube/blob/main/neuvector.yaml&lt;/a>
&lt;a class="link" href="https://www.readfog.com/a/1685538272501141504" target="_blank" rel="noopener"
>https://www.readfog.com/a/1685538272501141504&lt;/a>
&lt;a class="link" href="https://open-docs.neuvector.com/" target="_blank" rel="noopener"
>https://open-docs.neuvector.com/&lt;/a>&lt;/p>
&lt;h1 id="rancher-cluster-備份還原升級">Rancher Cluster (備份.還原.升級)
&lt;/h1>&lt;p>&lt;a class="link" href="https://docs.ranchermanager.rancher.io/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/upgrades" target="_blank" rel="noopener"
>https://docs.ranchermanager.rancher.io/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/upgrades&lt;/a>&lt;/p>
&lt;h2 id="rancher-backup-備份還原app">Rancher Backup (備份還原APP)
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>在Apps &amp;ndash;&amp;gt; Charts 搜尋rancher backups
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153112348.png"
loading="lazy"
alt="image-20221108153112348"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選install
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153148832.png"
loading="lazy"
alt="image-20221108153148832"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>設定儲存位置 (Storage Class)&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153231799.png"
loading="lazy"
alt="image-20221108153231799"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選install
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153312905.png"
loading="lazy"
alt="image-20221108153312905"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153324294.png"
loading="lazy"
alt="image-20221108153324294"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>重整Web UI，出現Rancher Backups
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153426191.png"
loading="lazy"
alt="image-20221108153426191"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選Rancher Backups &amp;ndash;&amp;gt; Create
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153514800.png"
loading="lazy"
alt="image-20221108153514800"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>設定名稱、參數等，點選Create
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153603733.png"
loading="lazy"
alt="image-20221108153603733"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>確認備份完成
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108153642511.png"
loading="lazy"
alt="image-20221108153642511"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>測試先將monitoring刪除後備份 （手動刪除cattle-monitoring-system、相關CRD）&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete ns cattle-monitoring-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 卡在terminating 可執行下方操作
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get ns cattle-monitoring-system -o json &amp;gt; tmp.json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; vim tmp.json
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 刪除 &amp;#34;finalizers&amp;#34;: [
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#34;kubernetes&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl proxy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 開另一個terminal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; curl -k -H &amp;#34;Content-Type: application/json&amp;#34; -X PUT --data-binary @tmp.json http://127.0.0.1:8001/api/v1/namespaces/cattle-monitoring-system/finalize
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 確認cattle-monitoring-system 刪除
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get ns cattle-monitoring-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error from server (NotFound): namespaces &amp;#34;cattle-monitoring-system&amp;#34; not found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 刪除相關CRD
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd prometheusrules.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;prometheusrules.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd prometheuses.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;prometheuses.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd alertmanagerconfigs.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;alertmanagerconfigs.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd alertmanagers.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;alertmanagers.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd podmonitors.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;podmonitors.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd probes.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;probes.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd servicemonitors.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;servicemonitors.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd thanosrulers.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">customresourcedefinition.apiextensions.k8s.io &amp;#34;thanosrulers.monitoring.coreos.com&amp;#34; deleted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109100436616.png"
loading="lazy"
alt="image-20221109100436616"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109100244363.png"
loading="lazy"
alt="image-20221109100244363"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>確認備份完成後將Monitoring安裝回去
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109100334288.png"
loading="lazy"
alt="image-20221109100334288"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109100558546.png"
loading="lazy"
alt="image-20221109100558546"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>確認安裝完成
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109100809009.png"
loading="lazy"
alt="image-20221109100809009"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>確認備份檔案&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109102519201.png"
loading="lazy"
alt="image-20221109102519201"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>還原備份檔案&amp;ndash;&amp;gt;點選restore &amp;ndash;&amp;gt;Create 即會開始執行restore&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Result: The backup file is created and updated to the target storage location. The resources are restored in this order:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1. Custom Resource Definitions (CRDs)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 2. Cluster-scoped resources
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 3. Namespaced resources
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109102614271.png"
loading="lazy"
alt="image-20221109102614271"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>確認 status，Rancher Cluster服務會中斷 (約3分鐘)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get po -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-bgj4j 0/1 Terminating 0 30s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-jkmpq 0/1 Terminating 0 30s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-tj8tw 0/1 Terminating 0 30s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-d6f8b6cb-xzjxc 1/1 Running 0 18h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl logs rancher-backup-6b9fc54cc6-nzt6m -n cattle-resources-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:31] Marking resource rolebindings.rbac.authorization.k8s.io#v1/fleet-local/request-6hktw for deletion
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:31] Marking resource rolebindings.rbac.authorization.k8s.io#v1/fleet-local/request-d9wpm for deletion
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:31] Marking resource rolebindings.rbac.authorization.k8s.io#v1/fleet-local/request-hskp9 for deletion
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:31] Will retry pruning resources by removing finalizers in 10s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:41] Retrying pruning resources by removing finalizers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:41] Processing controllerRef apps/v1/deployments/rancher
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:41] Scaling up controllerRef apps/v1/deployments/rancher to 3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">INFO[2022/11/09 02:32:41] Done restoring
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認Rancher 服務啟動
cattle-monitoring-system &amp;ndash; terminating 、相關crd還存在需手動刪除&lt;/p>
&lt;p>(若為自定義的Application應會全部清空，此處使用helm chart安裝的有留存著)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get po -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-8cn46 1/1 Running 0 71s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-kcqxc 1/1 Running 0 71s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-w5hsz 1/1 Running 0 71s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-d6f8b6cb-xzjxc 1/1 Running 0 18h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get ns
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cattle-monitoring-system Terminating 9m11s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get crd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete crd probes.monitoring.coreos.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109103725106.png"
loading="lazy"
alt="image-20221109103725106"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="備份rancher-cluster-etcd">備份Rancher Cluster etcd
&lt;/h2>&lt;p>&lt;a class="link" href="https://docs.rke2.io/backup_restore/" target="_blank" rel="noopener"
>https://docs.rke2.io/backup_restore/&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>ansible設定&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC rke2-lab % cat ansible.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[defaults]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">inventory = /Users/wangken/ansible/infoserver/rke2-lab/inventory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">remote_user = devop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo_user = root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">host_key_checking = False
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[privilege_escalation]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">become = true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">become_user = root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">become_ask_pass = true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC rke2-lab % cat inventory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[rke2-cluster]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.[41:43] ansible_ssh_pass=suse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[downstreamk8s-master]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.[44:46] ansible_ssh_pass=suse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[downstreamk8s-worker]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.[47:48] ansible_ssh_pass=suse
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[downstreamk8s:children]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">downstreamk8s-master
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">downstreamk8s-worker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC rke2-lab % ansible rke2-cluster -m ping
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認各nodes皆有rke2指令 /opt/rke2/bin/rke2&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC rke2-lab % ansible rke2-cluster -m shell -a &amp;#39;rke2 --help&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BECOME password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.41 | FAILED | rc=127 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: rke2：命令找不到non-zero return code
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.42 | FAILED | rc=127 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: rke2：命令找不到non-zero return code
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.43 | FAILED | rc=127 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh: rke2：命令找不到non-zero return code
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- copy rke2 到/usr/local/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC rke2-lab % ansible rke2-cluster -m shell -a &amp;#39;cp /opt/rke2/bin/rke2 /usr/local/bin/&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BECOME password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC rke2-lab % ansible rke2-cluster -m shell -a &amp;#39;rke2 --help&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BECOME password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.41 | CHANGED | rc=0 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.42 | CHANGED | rc=0 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.43 | CHANGED | rc=0 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>backup etcd while running&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Snapshots&lt;/span> &lt;span class="n">are&lt;/span> &lt;span class="n">enabled&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">default&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">The&lt;/span> &lt;span class="n">snapshot&lt;/span> &lt;span class="n">directory&lt;/span> &lt;span class="n">defaults&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wangken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">wangken&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">MAC&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">ansible&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">shell&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;rke2 etcd-snapshot save --name pre-upgrade-snapshot-v2.6.6&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BECOME&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wangken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">wangken&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">MAC&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">ansible&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">shell&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;ls -l /var/lib/rancher/rke2/server/db/snapshots&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BECOME&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109115637681.png"
loading="lazy"
alt="image-20221109115637681"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109115733969.png"
loading="lazy"
alt="image-20221109115733969"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>利用下篇方法升級rancher cluster的version
v2.6.6 to v2.6.9&lt;/p>
&lt;/li>
&lt;li>
&lt;p>升級rancher cluster的k8s version&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="升級rancher-cluster">升級Rancher Cluster
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>確認Rancher Cluster&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~/nfs&amp;gt; helm get values rancher -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">USER-SUPPLIED VALUES:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hostname: rms.rancher.ken.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm get values rancher -n cattle-system -o yaml &amp;gt; values.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; cat values.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">hostname: rms.rancher.ken.lab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認rancher helm chart&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm repo list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME URL
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-stable https://releases.rancher.com/server-charts/stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">jetstack https://charts.jetstack.io
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector https://neuvector.github.io/neuvector-helm/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>update helm chart&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm repo update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hang tight while we grab the latest from your chart repositories...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...Successfully got an update from the &amp;#34;rancher-stable&amp;#34; chart repository
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...Successfully got an update from the &amp;#34;neuvector&amp;#34; chart repository
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...Successfully got an update from the &amp;#34;jetstack&amp;#34; chart repository
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Update Complete. ⎈Happy Helming!⎈
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認目前rancher 最新版本&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm search repo rancher-stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME CHART VERSION APP VERSION DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-stable/rancher 2.6.9 v2.6.9 Install Rancher Server to manage Kubernetes clu...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認更新項目&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm fetch rancher-stable/rancher --version=2.6.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; tar xvf rancher-2.6.9.tgz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/Chart.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/values.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/NOTES.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/_helpers.tpl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/clusterRoleBinding.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/deployment.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/ingress.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/issuer-letsEncrypt.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/issuer-rancher.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/post-delete-hook-cluster-role-binding.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/post-delete-hook-cluster-role.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/post-delete-hook-config-map.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/post-delete-hook-job.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/post-delete-hook-psp.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/post-delete-hook-service-account.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/pvc.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/secret.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/service.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/templates/serviceAccount.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/.helmignore
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/README.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher/scripts/post-delete-hook.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">----
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; tree rancher
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── Chart.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── README.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── scripts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   └── post-delete-hook.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">├── templates
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── clusterRoleBinding.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── deployment.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── _helpers.tpl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── ingress.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── issuer-letsEncrypt.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── issuer-rancher.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── NOTES.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post-delete-hook-cluster-role-binding.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post-delete-hook-cluster-role.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post-delete-hook-config-map.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post-delete-hook-job.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post-delete-hook-psp.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── post-delete-hook-service-account.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── pvc.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── secret.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   ├── serviceAccount.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">│   └── service.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">└── values.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2 directories, 21 files
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>執行更新&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm upgrade rancher rancher-stable/rancher --namespace cattle-system -f values.yaml --version=2.6.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Release &amp;#34;rancher&amp;#34; has been upgraded. Happy Helming!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME: rancher
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">LAST DEPLOYED: Tue Nov 8 15:52:00 2022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE: cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">STATUS: deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">REVISION: 2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TEST SUITE: None
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOTES:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Rancher Server has been installed.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOTE: Rancher may take several minutes to fully initialize. Please standby while Certificates are being issued, Containers are started and the Ingress rule comes up.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Check out our docs at https://rancher.com/docs/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If you provided your own bootstrap password during installation, browse to https://rms.rancher.ken.lab to get started.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If this is the first time you installed Rancher, get started by running this command and clicking the URL it generates:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo https://rms.rancher.ken.lab/dashboard/?setup=$(kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&amp;#39;{{.data.bootstrapPassword|base64decode}}&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">To get just the bootstrap password on its own, run:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&amp;#39;{{.data.bootstrapPassword|base64decode}}{{ &amp;#34;\n&amp;#34; }}&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">```
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Happy Containering!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認status&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get pod -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">helm-operation-trgz9 0/2 Completed 0 17m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-47hfd 0/1 ContainerCreating 0 43s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-g666k 0/1 ContainerCreating 0 43s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-m9gt7 1/1 Running 2 (7d1h ago) 13d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-vjcpk 1/1 Running 2 (7d1h ago) 13d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-5b65595df9-9xsrc 1/1 Running 2 (7d1h ago) 13d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get pod -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">helm-operation-ffdn6 0/2 Completed 0 13m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">helm-operation-kjqgc 0/2 Completed 0 14m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">helm-operation-tfbhr 0/2 Completed 0 13m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">helm-operation-trgz9 0/2 Completed 0 33m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-47hfd 1/1 Running 0 16m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-g666k 1/1 Running 0 16m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-nkfkb 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-d6f8b6cb-xzjxc 1/1 Running 0 13m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm history rancher -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">REVISION UPDATED STATUS CHART APP VERSION DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 Tue Oct 25 17:05:13 2022 superseded rancher-2.6.6 v2.6.6 Install complete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2 Tue Nov 8 15:52:00 2022 superseded rancher-2.6.9 v2.6.9 Upgrade complete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3 Wed Nov 9 10:55:25 2022 superseded rancher-2.6.6 v2.6.6 Rollback to 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4 Wed Nov 9 12:04:06 2022 deployed rancher-2.6.9 v2.6.9 Upgrade complete
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>從Web UI確認版本 v2.6.9
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221108160654097.png"
loading="lazy"
alt="image-20221108160654097"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>升級k8s version，針對升級後的Rancher Cluster點選edit config&lt;/p>
&lt;p>v1.23.9 to v1.24.4
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109121235714.png"
loading="lazy"
alt="image-20221109121235714"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>點選save，查看升級狀態 rolling upgrade ，期間Web UI不受影響&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109121345121.png"
loading="lazy"
alt="image-20221109121345121"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109121459412.png"
loading="lazy"
alt="image-20221109121459412"
>&lt;/p>
&lt;ol start="11">
&lt;li>
&lt;p>nodes輪流升級 (RAM的使用率會飆高)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109121632971.png"
loading="lazy"
alt="image-20221109121632971"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>升級完成
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109134021037.png"
loading="lazy"
alt="image-20221109134021037"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="roll-backup-rancher-helm">Roll Backup Rancher (Helm)
&lt;/h2>&lt;p>&lt;a class="link" href="https://docs.ranchermanager.rancher.io/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/rollbacks" target="_blank" rel="noopener"
>https://docs.ranchermanager.rancher.io/getting-started/installation-and-upgrade/install-upgrade-on-a-kubernetes-cluster/rollbacks&lt;/a>&lt;/p>
&lt;p>&lt;strong>雖官方文件有寫到，但原廠不建議這麼做&lt;/strong> ，只針對rancher 版本回復&lt;/p>
&lt;ol>
&lt;li>
&lt;p>查看rancher安裝過的版本&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm history rancher -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">REVISION UPDATED STATUS CHART APP VERSION DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 Tue Oct 25 17:05:13 2022 superseded rancher-2.6.6 v2.6.6 Install complete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2 Tue Nov 8 15:52:00 2022 deployed rancher-2.6.9 v2.6.9 Upgrade complete
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>利用helm 還原rancher版本&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm rollback rancher 1 -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Rollback was a success! Happy Helming!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認status&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; watch kubectl get po -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-kcqxc 1/1 Running 0 23m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-6c8f689f57-w5hsz 1/1 Running 0 23m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-hsbhg 0/1 ContainerCreating 0 24s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-zrdm8 0/1 Running 0 24s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-d6f8b6cb-xzjxc 1/1 Running 0 19h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; helm history rancher -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">REVISION UPDATED STATUS CHART APP VERSION DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 Tue Oct 25 17:05:13 2022 superseded rancher-2.6.6 v2.6.6 Install complete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2 Tue Nov 8 15:52:00 2022 superseded rancher-2.6.9 v2.6.9 Upgrade complete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3 Wed Nov 9 10:55:25 2022 deployed rancher-2.6.6 v2.6.6 Rollback to 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get po -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-hsbhg 1/1 Running 0 34m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-qz9xb 1/1 Running 0 33m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-zrdm8 1/1 Running 0 34m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-d6f8b6cb-xzjxc 1/1 Running 0 19h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl describe po rancher-7fd65d9cd6-hsbhg -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Containers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rancher:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Container ID: containerd://13a9d5362e57776b8cfb54f63e872cd81b6ec38623716d7d3b3006f57acc9f89
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Image: rancher/rancher:v2.6.6
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>重整Web UI確認版本已為v2.6.6
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109105523237.png"
loading="lazy"
alt="image-20221109105523237"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="還原rancher-cluster-etcd">還原Rancher Cluster etcd
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="err">順序：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">1.&lt;/span> &lt;span class="err">停止所有&lt;/span>&lt;span class="n">node的rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="n">service&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">2.&lt;/span> &lt;span class="err">在第一個節點&lt;/span> &lt;span class="err">執行&lt;/span>&lt;span class="n">restore指令&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">3.&lt;/span> &lt;span class="err">啟動第一個節點的&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="n">service&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">4.&lt;/span> &lt;span class="err">刪除剩下兩個節點的&lt;/span>&lt;span class="n">db目錄&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">5.&lt;/span> &lt;span class="err">啟動剩下兩個節點的&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="n">service&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol>
&lt;li>
&lt;p>先確認先前做snapshot的檔案都在&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">wangken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">wangken&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">MAC&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">ansible&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">shell&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;ls -l /var/lib/rancher/rke2/server/db/snapshots&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BECOME&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">270504&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41029664&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667793600&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41029664&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667836800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41029664&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667880000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41029664&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667923200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">56426528&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966400&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">56426528&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">58&lt;/span> &lt;span class="n">pre&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">upgrade&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">6.6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966290&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">270512&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">40488992&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667793600&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">40488992&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667836800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">40488992&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667880000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">40488992&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667923200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">57511968&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966400&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">57511968&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">58&lt;/span> &lt;span class="n">pre&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">upgrade&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">6.6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966291&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">269656&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667793600&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667836800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667880000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667923200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">54976544&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966400&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">54976544&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">58&lt;/span> &lt;span class="n">pre&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">upgrade&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">6.6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966289&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認目錄etcd&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">wangken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">wangken&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">MAC&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">ansible&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">shell&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;ls -l /var/lib/rancher/rke2/server/db/&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BECOME&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">20&lt;/span> &lt;span class="n">etcd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">400&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="n">etcd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">400&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">17&lt;/span> &lt;span class="n">etcd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">400&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>停用rke2-server service&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC rke2-lab % ansible rke2-cluster -m shell -a &amp;#39;systemctl stop rke2-server&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">BECOME password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.41 | CHANGED | rc=0 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.43 | CHANGED | rc=0 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.33.42 | CHANGED | rc=0 &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>在rke2-1執行 restore指令並啟動rke2-server service&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rke2&lt;/span> &lt;span class="n">server&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">--&lt;/span>&lt;span class="n">cluster&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">reset&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">--&lt;/span>&lt;span class="n">cluster&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">reset&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">restore&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">=&amp;lt;&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">TO&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">SNAPSHOT&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">snapshots&lt;/span> &lt;span class="c1"># pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">snapshots&lt;/span> &lt;span class="c1"># ll&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total&lt;/span> &lt;span class="mi">269656&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667793600&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667836800&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667880000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">41537568&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667923200&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">54976544&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966400&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">54976544&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">58&lt;/span> &lt;span class="n">pre&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">upgrade&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshot&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">6.6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667966289&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">snapshots&lt;/span> &lt;span class="c1"># rke2 server --cluster-reset --cluster-reset-restore-path=/var/lib/rancher/rke2/server/db/snapshots/pre-upgrade-snapshot-v2.6.6-rke2-1-1667966289&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0032&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Defragmenting&lt;/span> &lt;span class="n">etcd&lt;/span> &lt;span class="n">database&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0032&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Reconciling&lt;/span> &lt;span class="n">bootstrap&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="n">between&lt;/span> &lt;span class="n">datastore&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">disk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0032&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Cluster&lt;/span> &lt;span class="n">reset&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">backing&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="n">certificates&lt;/span> &lt;span class="n">directory&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">tls&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667973877&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0033&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Defragmenting&lt;/span> &lt;span class="n">etcd&lt;/span> &lt;span class="n">database&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0033&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">etcd&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="n">store&lt;/span> &lt;span class="n">connection&lt;/span> &lt;span class="n">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0033&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Waiting&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">API&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">become&lt;/span> &lt;span class="n">available&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0033&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">ETCD&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">now&lt;/span> &lt;span class="n">running&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0033&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">rke2&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">running&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">WARN&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0033&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">bootstrap&lt;/span> &lt;span class="n">key&lt;/span> &lt;span class="n">already&lt;/span> &lt;span class="n">exists&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0033&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Reconciling&lt;/span> &lt;span class="n">etcd&lt;/span> &lt;span class="n">snapshot&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">snapshots&lt;/span> &lt;span class="n">ConfigMap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0035&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Waiting&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">retrieve&lt;/span> &lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">proxy&lt;/span> &lt;span class="n">configuration&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">ready&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">127.0&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">0.1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6444&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">readyz&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">500&lt;/span> &lt;span class="n">Internal&lt;/span> &lt;span class="n">Server&lt;/span> &lt;span class="n">Error&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">INFO&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0037&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">Managed&lt;/span> &lt;span class="n">etcd&lt;/span> &lt;span class="n">cluster&lt;/span> &lt;span class="n">membership&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">reset&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">restart&lt;/span> &lt;span class="n">without&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">cluster&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">reset&lt;/span> &lt;span class="n">flag&lt;/span> &lt;span class="n">now&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">Backup&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">delete&lt;/span> &lt;span class="o">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">datadir&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">each&lt;/span> &lt;span class="n">peer&lt;/span> &lt;span class="n">etcd&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">rejoin&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">nodes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span> &lt;span class="c1"># ll&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">05&lt;/span> &lt;span class="n">etcd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">20&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">old&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667973863&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">426&lt;/span> &lt;span class="n">Nov&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">04&lt;/span> &lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">snapshots&lt;/span> &lt;span class="c1"># systemctl start rke2-server&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>刪除剩下兩個節點的 /var/lib/rancher/rke2/server/db&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db_old&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">rm&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">rf&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db_old&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="err">的密碼：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">rm&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">rf&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">db&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">devop&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">start&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>切換到rms確認node狀態&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get nodes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS ROLES AGE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-1 Ready control-plane,etcd,master 14d v1.24.4+rke2r1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-2 Ready control-plane,etcd,master 14d v1.24.4+rke2r1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rke2-3 Ready control-plane,etcd,master 14d v1.24.4+rke2r1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>Web UI 版本回到v2.6.6
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221109141718197.png"
loading="lazy"
alt="image-20221109141718197"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>/var/lib/rancher/rke2/server/db/ 檔案路徑&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">wangken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">wangken&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">MAC&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">ansible&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">shell&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;ls -l /var/lib/rancher/rke2/server/db/&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">BECOME&lt;/span> &lt;span class="n">password&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.42&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">16&lt;/span> &lt;span class="n">etcd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">17&lt;/span> &lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.43&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">15&lt;/span> &lt;span class="n">etcd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">15&lt;/span> &lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">33.41&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">CHANGED&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">rc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">總用量&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">05&lt;/span> &lt;span class="n">etcd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">32&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">20&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">old&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1667973863&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwx&lt;/span>&lt;span class="o">------&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">426&lt;/span> &lt;span class="mi">11&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">04&lt;/span> &lt;span class="n">snapshots&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認pod status 卡在Terminating&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get po -o wide -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-fjvxr 1/1 Running 0 16m 10.42.0.127 rke2-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-hsbhg 0/1 Terminating 0 3h33m &amp;lt;none&amp;gt; rke2-3 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-qz9xb 1/1 Terminating 0 3h33m 10.42.1.58 rke2-2 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-zk2f9 1/1 Running 0 16m 10.42.0.123 rke2-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-zrdm8 1/1 Running 0 3h33m 10.42.0.117 rke2-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-d6f8b6cb-j2whv 1/1 Running 0 16m 10.42.0.126 rke2-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>強制刪除pod&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete pod --grace-period=0 --force -n cattle-system rancher-7fd65d9cd6-qz9xb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">warning: Immediate deletion does not wait for confirmation that the running resource has been terminated. The resource may continue to run on the cluster indefinitely.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod &amp;#34;rancher-7fd65d9cd6-qz9xb&amp;#34; force deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl delete pod --grace-period=0 --force -n cattle-system rancher-7fd65d9cd6-hsbhg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">warning: Immediate deletion does not wait for confirmation that the running resource has been terminated. The resource may continue to run on the cluster indefinitely.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod &amp;#34;rancher-7fd65d9cd6-hsbhg&amp;#34; force deleted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">devop@rms:~&amp;gt; kubectl get po -o wide -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-5rglz 0/1 ContainerCreating 0 12m &amp;lt;none&amp;gt; rke2-3 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-fjvxr 1/1 Running 0 29m 10.42.0.127 rke2-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-zk2f9 1/1 Running 0 30m 10.42.0.123 rke2-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-webhook-d6f8b6cb-j2whv 1/1 Running 0 29m 10.42.0.126 rke2-1 &amp;lt;none&amp;gt; &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>重建rke2-2、rke2-3&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo systemctl stop rke2-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo rke2 server --cluster-reset
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start rke2-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h2 id="備份downstream-cluster">備份Downstream Cluster
&lt;/h2>&lt;p>調整備份排程,目前每五小時備份一次
&lt;strong>/var/lib/rancher/rke2/server/db/snapshots&lt;/strong>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221216114859715.png"
loading="lazy"
alt="image-20221216114859715"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221216115017093.png"
loading="lazy"
alt="image-20221216115017093"
>&lt;/p>
&lt;h2 id="還原downstream-cluster">還原Downstream Cluster
&lt;/h2>&lt;p>在Cluster Management可針對Cluster做還原&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221216115047603.png"
loading="lazy"
alt="image-20221216115047603"
>&lt;/p>
&lt;p>選擇要還原的時間點、還原的版本及etcd&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20221216115059772.png"
loading="lazy"
alt="image-20221216115059772"
>&lt;/p></description></item><item><title>Guide_RKE2&amp;Rancher_install</title><link>https://wangken0129.github.io/p/guide_rke2rancher_install/</link><pubDate>Sat, 23 Sep 2023 07:39:03 +0800</pubDate><guid>https://wangken0129.github.io/p/guide_rke2rancher_install/</guid><description>&lt;h1 id="rke2-and-rancher-install">RKE2 and Rancher install
&lt;/h1>&lt;h2 id="0-install-dns">0. Install DNS
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo zypper in -t pattern dhcp_dns_server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="1-login">1. login
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sam@sam:~&amp;gt; ssh rancher@192.168.122.41
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last failed login: Wed Sep 21 08:33:47 CST 2022 from 192.168.122.1 on ssh:notty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There was 1 failed login attempt since the last successful login.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Last login: Wed Sep 21 08:31:58 2022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; curl -sfL https://get.rke2.io --output install.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; chmod +x install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-config-rke2-basic-parameters">2. config rke2 basic parameters
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; sudo mkdir -p /etc/rancher/rke2/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; sudo vim /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; cat /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node-name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;rms1&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">token: my-shared-secret
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="3-install-rke2-with-1239">3. install rke2 with 1.23.9
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">INSTALL_RKE2_CHANNEL&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">WARN&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">only&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">mount&lt;/span> &lt;span class="n">point&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">installing&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">finding&lt;/span> &lt;span class="n">release&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">channel&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span> &lt;span class="n">as&lt;/span> &lt;span class="n">release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">checksums&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sha256sum&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.9&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">verifying&lt;/span> &lt;span class="n">tarball&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">unpacking&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">updating&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">contents&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">reflect&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">systemd&lt;/span> &lt;span class="n">units&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">complete&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">may&lt;/span> &lt;span class="n">want&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">run&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="4-enable-rke2-and-setup-kubeconfig">4. enable rke2 and setup kubeconfig
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">start&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="err">的密碼：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">chown&lt;/span> &lt;span class="n">rancher&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubectl&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="5-check-pod-status">5. check pod status
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No resources found in default namespace.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl get po -A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system cloud-controller-manager-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system etcd-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-canal-6bpd4 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-coredns-mjflj 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-ingress-nginx-76r2c 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-metrics-server-wkc4k 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-apiserver-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-controller-manager-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-proxy-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-scheduler-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-canal-8x56p 2/2 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-coredns-rke2-coredns-545d64676-zlnk9 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-coredns-rke2-coredns-autoscaler-5dd676f5c7-zrdbb 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-ingress-nginx-controller-xhxr6 1/1 Running 0 14m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-metrics-server-6564db4569-542hx 1/1 Running 0 14m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="6-install-helm3">6. install helm3
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="mi">2022&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">09&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">21&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">06&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">57&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Resolving&lt;/span> &lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="mf">152.199&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">39.108&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2606&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2800&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">247&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="n">cb7&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">261&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="n">f9c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2074&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Connecting&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">152.199&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">39.108&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">443.&lt;/span>&lt;span class="o">..&lt;/span> &lt;span class="n">connected&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">HTTP&lt;/span> &lt;span class="n">request&lt;/span> &lt;span class="n">sent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">awaiting&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="mi">200&lt;/span> &lt;span class="n">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Length&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">13633605&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="n">M&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Saving&lt;/span> &lt;span class="n">to&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="err">‘&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>&lt;span class="err">’&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">=============================================================&amp;gt;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="mf">13.00&lt;/span>&lt;span class="n">M&lt;/span> &lt;span class="mf">5.95&lt;/span>&lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="mf">2.2&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2022&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">09&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">21&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">07&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mf">5.95&lt;/span> &lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">‘&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>&lt;span class="err">’&lt;/span> &lt;span class="n">saved&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">13633605&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">13633605&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">tar&lt;/span> &lt;span class="n">zxvf&lt;/span> &lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">LICENSE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">README&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">md&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">bin&lt;/span> &lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">8.2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span> &lt;span class="n">install&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span> &lt;span class="n">public_html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="err">的密碼：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">help&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">The&lt;/span> &lt;span class="n">Kubernetes&lt;/span> &lt;span class="n">package&lt;/span> &lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Common&lt;/span> &lt;span class="n">actions&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">Helm&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">search&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">search&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">charts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">pull&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">download&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">local&lt;/span> &lt;span class="n">directory&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">view&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">install&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">upload&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">Kubernetes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">list&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="n">releases&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">charts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="7-install-rancher-and-cert-manager">7. install rancher and cert-manager
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;span class="lnt">85
&lt;/span>&lt;span class="lnt">86
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">stable&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">charts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">stable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;rancher-stable&amp;#34;&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">added&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">repositories&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">create&lt;/span> &lt;span class="n">namespace&lt;/span> &lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">namespace&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">apply&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crds&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificaterequests&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificates&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">challenges&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">clusterissuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">issuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">jetstack&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">charts&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jetstack&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;jetstack&amp;#34;&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">added&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">repositories&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">update&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Hang&lt;/span> &lt;span class="n">tight&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="n">we&lt;/span> &lt;span class="n">grab&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">latest&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repositories&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;span class="n">Successfully&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">update&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="s2">&amp;#34;rancher-stable&amp;#34;&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repository&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;span class="n">Successfully&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">update&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="s2">&amp;#34;jetstack&amp;#34;&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repository&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Update&lt;/span> &lt;span class="n">Complete&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="err">⎈&lt;/span>&lt;span class="n">Happy&lt;/span> &lt;span class="n">Helming&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="err">⎈&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">jetstack&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">create&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">namespace&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">version&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">LAST&lt;/span> &lt;span class="n">DEPLOYED&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Wed&lt;/span> &lt;span class="n">Sep&lt;/span> &lt;span class="mi">21&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">15&lt;/span> &lt;span class="mi">2022&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAMESPACE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">STATUS&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">deployed&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">REVISION&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">TEST&lt;/span> &lt;span class="n">SUITE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NOTES&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">deployed&lt;/span> &lt;span class="n">successfully&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="n">order&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">begin&lt;/span> &lt;span class="n">issuing&lt;/span> &lt;span class="n">certificates&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">will&lt;/span> &lt;span class="n">need&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">set&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">ClusterIssuer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="ow">or&lt;/span> &lt;span class="n">Issuer&lt;/span> &lt;span class="n">resource&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">for&lt;/span> &lt;span class="n">example&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">creating&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;letsencrypt-staging&amp;#39;&lt;/span> &lt;span class="n">issuer&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">More&lt;/span> &lt;span class="n">information&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">different&lt;/span> &lt;span class="n">types&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">issuers&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">how&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">them&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">can&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">found&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">our&lt;/span> &lt;span class="n">documentation&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">configuration&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">For&lt;/span> &lt;span class="n">information&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">how&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">automatically&lt;/span> &lt;span class="n">provision&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Certificates&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">Ingress&lt;/span> &lt;span class="n">resources&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">take&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">look&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="err">`&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">shim&lt;/span>&lt;span class="err">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">documentation&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">usage&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">pods&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span> &lt;span class="n">READY&lt;/span> &lt;span class="n">STATUS&lt;/span> &lt;span class="n">RESTARTS&lt;/span> &lt;span class="n">AGE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">76&lt;/span>&lt;span class="n">d44b459c&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">zhpp2&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cainjector&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">9&lt;/span>&lt;span class="n">b679cc6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="n">tzd8&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">webhook&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">57&lt;/span>&lt;span class="n">c994b6b9&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="n">dfvs&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">32&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">rancher&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">stable&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">set&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">version&lt;/span> &lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">rancher&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">LAST&lt;/span> &lt;span class="n">DEPLOYED&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Wed&lt;/span> &lt;span class="n">Sep&lt;/span> &lt;span class="mi">21&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">14&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">06&lt;/span> &lt;span class="mi">2022&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAMESPACE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">STATUS&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">deployed&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">REVISION&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">TEST&lt;/span> &lt;span class="n">SUITE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NOTES&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Rancher&lt;/span> &lt;span class="n">Server&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">installed&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NOTE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Rancher&lt;/span> &lt;span class="n">may&lt;/span> &lt;span class="n">take&lt;/span> &lt;span class="n">several&lt;/span> &lt;span class="n">minutes&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">fully&lt;/span> &lt;span class="n">initialize&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">Please&lt;/span> &lt;span class="n">standby&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="n">Certificates&lt;/span> &lt;span class="n">are&lt;/span> &lt;span class="n">being&lt;/span> &lt;span class="n">issued&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Containers&lt;/span> &lt;span class="n">are&lt;/span> &lt;span class="n">started&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">Ingress&lt;/span> &lt;span class="n">rule&lt;/span> &lt;span class="n">comes&lt;/span> &lt;span class="n">up&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Check&lt;/span> &lt;span class="n">out&lt;/span> &lt;span class="n">our&lt;/span> &lt;span class="n">docs&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docs&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">If&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">provided&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">own&lt;/span> &lt;span class="n">bootstrap&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="n">during&lt;/span> &lt;span class="n">installation&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">browse&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">started&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">If&lt;/span> &lt;span class="n">this&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">first&lt;/span> &lt;span class="n">time&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">installed&lt;/span> &lt;span class="n">Rancher&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">started&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">running&lt;/span> &lt;span class="n">this&lt;/span> &lt;span class="n">command&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">clicking&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">URL&lt;/span> &lt;span class="n">it&lt;/span> &lt;span class="n">generates&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">echo&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">example&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">dashboard&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">?&lt;/span>&lt;span class="n">setup&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">secret&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">bootstrap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">secret&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">o&lt;/span> &lt;span class="n">go&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">template&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;{{.data.bootstrapPassword|base64decode}}&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">To&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">just&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">bootstrap&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">its&lt;/span> &lt;span class="n">own&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">run&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">secret&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cattle&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">bootstrap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">secret&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">o&lt;/span> &lt;span class="n">go&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">template&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;{{.data.bootstrapPassword|base64decode}}{{ &amp;#34;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#34; }}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Happy&lt;/span> &lt;span class="n">Containering&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="8-check-rancher-status">8. check rancher status
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n cattle-system get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-8krrq 0/1 ContainerCreating 0 16s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-h28fw 0/1 ContainerCreating 0 16s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-k9hrr 0/1 ContainerCreating 0 16s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; watch kubectl -n cattle-system get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n cattle-system rollout status deploy/rancher
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Waiting for deployment &amp;#34;rancher&amp;#34; rollout to finish: 0 of 3 updated replicas are available...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Waiting for deployment spec update to be observed...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Waiting for deployment &amp;#34;rancher&amp;#34; rollout to finish: 0 of 3 updated replicas are available...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Waiting for deployment &amp;#34;rancher&amp;#34; rollout to finish: 1 of 3 updated replicas are available...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Waiting for deployment &amp;#34;rancher&amp;#34; rollout to finish: 2 of 3 updated replicas are available...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment &amp;#34;rancher&amp;#34; successfully rolled out
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n cattle-system get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-8krrq 1/1 Running 1 (51s ago) 3m11s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-h28fw 1/1 Running 0 3m11s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-7fd65d9cd6-k9hrr 1/1 Running 1 (51s ago) 3m11s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="notice">notice
&lt;/h2>&lt;ol>
&lt;li>must use DNS for rancher.&lt;/li>
&lt;li>downstream must resolve rancher portal from dns.&lt;/li>
&lt;li>good luck.&lt;/li>
&lt;/ol></description></item><item><title>Guide_NeuVector</title><link>https://wangken0129.github.io/p/guide_neuvector/</link><pubDate>Sat, 23 Sep 2023 07:38:37 +0800</pubDate><guid>https://wangken0129.github.io/p/guide_neuvector/</guid><description>&lt;h1 id="neuvector">NeuVector
&lt;/h1>&lt;h2 id="0-install-rke2">0. install RKE2
&lt;/h2>&lt;h3 id="01-下載安裝腳本">0.1. 下載安裝腳本
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; curl -sfL https://get.rke2.io --output install.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; chmod +x install.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="02-設定rke2基本餐數">0.2. 設定RKE2基本餐數
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; sudo mkdir -p /etc/rancher/rke2/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; sudo vim /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; cat /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node-name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;rms1&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">token: my-shared-secret
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="03-安裝rke2">0.3. 安裝rke2
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">WARN&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">only&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">mount&lt;/span> &lt;span class="n">point&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">installing&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">finding&lt;/span> &lt;span class="n">release&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">channel&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">24.6&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">using&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">24.6&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span> &lt;span class="n">as&lt;/span> &lt;span class="n">release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">checksums&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">24.6&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sha256sum&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">downloading&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">24.6&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">rke2r1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">verifying&lt;/span> &lt;span class="n">tarball&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">unpacking&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">updating&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">contents&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">reflect&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">systemd&lt;/span> &lt;span class="n">units&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">complete&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">may&lt;/span> &lt;span class="n">want&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">run&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="04-enable-rke2-and-setup-kubeconfig">0.4. enable rke2 and setup kubeconfig
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">start&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="err">的密碼：&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">chown&lt;/span> &lt;span class="n">rancher&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubectl&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="05-check-pod-status">0.5. check pod status
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No resources found in default namespace.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl get po -A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system cloud-controller-manager-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system etcd-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-canal-6bpd4 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-coredns-mjflj 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-ingress-nginx-76r2c 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system helm-install-rke2-metrics-server-wkc4k 0/1 Completed 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-apiserver-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-controller-manager-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-proxy-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system kube-scheduler-rms1 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-canal-8x56p 2/2 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-coredns-rke2-coredns-545d64676-zlnk9 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-coredns-rke2-coredns-autoscaler-5dd676f5c7-zrdbb 1/1 Running 0 15m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-ingress-nginx-controller-xhxr6 1/1 Running 0 14m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kube-system rke2-metrics-server-6564db4569-542hx 1/1 Running 0 14m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="1-install-helm3">1. install helm3
&lt;/h2>&lt;h3 id="11-check-kubernetes-version">1.1. check kubernetes version
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl get no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS ROLES AGE VERSION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rms1 Ready control-plane,etcd,master 37h v1.24.6+rke2r1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="12-下載與安裝helm">1.2. 下載與安裝helm
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">9.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="mi">2022&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">16&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">56&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">9.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Resolving&lt;/span> &lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="mf">152.199&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">39.108&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2606&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2800&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">247&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="n">cb7&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">261&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="n">f9c&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2074&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="n">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Connecting&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="mf">152.199&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">39.108&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mf">443.&lt;/span>&lt;span class="o">..&lt;/span> &lt;span class="n">connected&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">HTTP&lt;/span> &lt;span class="n">request&lt;/span> &lt;span class="n">sent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">awaiting&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="mi">200&lt;/span> &lt;span class="n">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Length&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">14026634&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="n">M&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">application&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Saving&lt;/span> &lt;span class="n">to&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="err">‘&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">9.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>&lt;span class="err">’&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">9.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span> &lt;span class="mi">100&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">========================================&amp;gt;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="mf">13.38&lt;/span>&lt;span class="n">M&lt;/span> &lt;span class="mf">7.86&lt;/span>&lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="mf">1.7&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2022&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">16&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">59&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mf">7.86&lt;/span> &lt;span class="n">MB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="err">‘&lt;/span>&lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">9.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>&lt;span class="err">’&lt;/span> &lt;span class="n">saved&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">14026634&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">14026634&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">tar&lt;/span> &lt;span class="n">zxvf&lt;/span> &lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v3&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">9.4&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">LICENSE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">README&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">md&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">helm&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">help&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">The&lt;/span> &lt;span class="n">Kubernetes&lt;/span> &lt;span class="n">package&lt;/span> &lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Common&lt;/span> &lt;span class="n">actions&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">Helm&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">search&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">search&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">charts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">pull&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">download&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">local&lt;/span> &lt;span class="n">directory&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">view&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">install&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">upload&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">Kubernetes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">list&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="n">releases&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">charts&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-install-neuvector">2. install NeuVector
&lt;/h2>&lt;h3 id="21-加入neuvector-helm-chart">2.1. 加入neuvector helm chart
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm repo add neuvector https://neuvector.github.io/neuvector-helm/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;neuvector&amp;#34; has been added to your repositories
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm search repo neuvector/core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME CHART VERSION APP VERSION DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 2.2.3 5.0.3 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm search repo neuvector/core -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME CHART VERSION APP VERSION DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 2.2.3 5.0.3 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 2.2.2 5.0.2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 2.2.1 5.0.1 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 2.2.0 5.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.9.2 4.4.4-s2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.9.1 4.4.4 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.9.0 4.4.4 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.9 4.4.3 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.8 4.4.2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.7 4.4.1 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.6 4.4.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.5 4.3.2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.4 4.3.2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.3 4.3.2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.2 4.3.1 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.8.0 4.3.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.7.7 4.2.2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.7.6 4.2.2 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.7.5 4.2.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.7.2 4.2.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.7.1 4.2.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.7.0 4.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.6.9 4.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.6.8 4.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.6.7 4.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.6.6 4.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.6.5 4.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.6.4 4.0.0 Helm chart for NeuVector&amp;#39;s core services
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector/core 1.6.1 4.0.0 NeuVector Full Lifecycle Container Security Pla...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm show values neuvector/core --version 2.2.3 &amp;gt; neuvector-values.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="22-調整yaml---part-1replicas-for-test">2.2. 調整yaml - part-1(replicas for test)
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">controller:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> replicas: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scanner:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> enabled: true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> replicas: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="23-調整yaml---part-2cri-for-k3s">2.3. 調整yaml - part-2(CRI for k3s)
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">k3s:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> enabled: true
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="24-建立neuvector-namespace-and-create-neuvector">2.4. 建立NeuVector NameSpace and create neuvector
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl create ns neuvector
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">namespace/neuvector created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm install neuvector neuvector/core --version 2.2.3 --namespace neuvector --values neuvector-values.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME: neuvector
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">LAST DEPLOYED: Sun Oct 16 13:10:22 2022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE: neuvector
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">STATUS: deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">REVISION: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TEST SUITE: None
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOTES:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Get the NeuVector URL by running these commands:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> NODE_PORT=$(kubectl get --namespace neuvector -o jsonpath=&amp;#34;{.spec.ports[0].nodePort}&amp;#34; services neuvector-service-webui)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> NODE_IP=$(kubectl get nodes --namespace neuvector -o jsonpath=&amp;#34;{.items[0].status.addresses[0].address}&amp;#34;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> echo https://$NODE_IP:$NODE_PORT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n neuvector get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-controller-pod-6cf58c7894-hvvlw 1/1 Running 0 42s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-enforcer-pod-rpzqg 1/1 Running 0 42s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-manager-pod-8488cb586c-87q9n 1/1 Running 0 42s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-scanner-pod-7d6bc8f775-pfwkk 1/1 Running 0 42s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n neuvector get svc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-service-webui NodePort 10.43.189.243 &amp;lt;none&amp;gt; 8443:30805/TCP 66s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-svc-admission-webhook ClusterIP 10.43.103.17 &amp;lt;none&amp;gt; 443/TCP 67s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-svc-controller ClusterIP None &amp;lt;none&amp;gt; 18300/TCP,18301/TCP,18301/UDP 67s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neuvector-svc-crd-webhook ClusterIP 10.43.185.195 &amp;lt;none&amp;gt; 443/TCP 66s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="3-其他">3. 其他
&lt;/h2>&lt;h3 id="31-image-registry">3.1. image registry
&lt;/h3>&lt;ol>
&lt;li>Name: Nginx&lt;/li>
&lt;li>Registry: &lt;a class="link" href="https://registry.hub.docker.com/" target="_blank" rel="noopener"
>https://registry.hub.docker.com/&lt;/a>&lt;/li>
&lt;li>Filter: nginx:stable&lt;/li>
&lt;/ol>
&lt;h3 id="32-response-rule">3.2. Response Rule
&lt;/h3>&lt;ol>
&lt;li>Category: &lt;code>Security Event&lt;/code>&lt;/li>
&lt;li>Group: &lt;code>nv.default&lt;/code>&lt;/li>
&lt;li>Criteria: &lt;code>name:Process.Profile.Violation&lt;/code>&lt;/li>
&lt;li>Action: &lt;code>Quarantine&lt;/code>&lt;/li>
&lt;li>Status: &lt;code>Enabled&lt;/code>&lt;/li>
&lt;/ol>
&lt;h3 id="33-cli-reference">3.3. CLI reference
&lt;/h3>&lt;h4 id="331-nginx-install-recon-ng">3.3.1. nginx install recon-ng
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">rms1&lt;/span>&lt;span class="p">:~&amp;gt;&lt;/span> &lt;span class="nx">kubectl&lt;/span> &lt;span class="nx">create&lt;/span> &lt;span class="nx">deploy&lt;/span> &lt;span class="nx">web&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">image&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">nginx&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">port&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">80&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">replicas&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">deployment&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">apps&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">web&lt;/span> &lt;span class="nx">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">rms1&lt;/span>&lt;span class="p">:~&amp;gt;&lt;/span> &lt;span class="nx">kubectl&lt;/span> &lt;span class="nx">get&lt;/span> &lt;span class="nx">po&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">NAME&lt;/span> &lt;span class="nx">READY&lt;/span> &lt;span class="nx">STATUS&lt;/span> &lt;span class="nx">RESTARTS&lt;/span> &lt;span class="nx">AGE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cff6559d7&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">jddwt&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="nx">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">rms1&lt;/span>&lt;span class="p">:~&amp;gt;&lt;/span> &lt;span class="nx">kubectl&lt;/span> &lt;span class="nx">exec&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">it&lt;/span> &lt;span class="nx">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cff6559d7&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">jddwt&lt;/span> &lt;span class="o">--&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="nx">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cff6559d7&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">jddwt&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">apt&lt;/span> &lt;span class="nx">update&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Get&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//deb.debian.org/debian bullseye InRelease [116 kB]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Get&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Get&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">3&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//deb.debian.org/debian bullseye-updates InRelease [44.1 kB]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Get&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//deb.debian.org/debian bullseye/main amd64 Packages [8184 kB]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Get&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//deb.debian.org/debian-security bullseye-security/main amd64 Packages [189 kB] &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Get&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">6&lt;/span> &lt;span class="nx">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="c1">//deb.debian.org/debian bullseye-updates/main amd64 Packages [6340 B] &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Fetched&lt;/span> &lt;span class="mi">8588&lt;/span> &lt;span class="nx">kB&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="nf">s&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1050&lt;/span> &lt;span class="nx">kB&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Reading&lt;/span> &lt;span class="kn">package&lt;/span> &lt;span class="nx">lists&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="nx">Done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Building&lt;/span> &lt;span class="nx">dependency&lt;/span> &lt;span class="nx">tree&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="nx">Done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Reading&lt;/span> &lt;span class="nx">state&lt;/span> &lt;span class="nx">information&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="nx">Done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">1&lt;/span> &lt;span class="kn">package&lt;/span> &lt;span class="nx">can&lt;/span> &lt;span class="nx">be&lt;/span> &lt;span class="nx">upgraded&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">Run&lt;/span> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">apt&lt;/span> &lt;span class="nx">list&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="nx">upgradable&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">see&lt;/span> &lt;span class="nx">it&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cff6559d7&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">jddwt&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">apt&lt;/span> &lt;span class="nx">install&lt;/span> &lt;span class="nx">recon&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ng&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Reading&lt;/span> &lt;span class="kn">package&lt;/span> &lt;span class="nx">lists&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="nx">Done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Building&lt;/span> &lt;span class="nx">dependency&lt;/span> &lt;span class="nx">tree&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="nx">Done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Reading&lt;/span> &lt;span class="nx">state&lt;/span> &lt;span class="nx">information&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="nx">Done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">The&lt;/span> &lt;span class="nx">following&lt;/span> &lt;span class="nx">additional&lt;/span> &lt;span class="nx">packages&lt;/span> &lt;span class="nx">will&lt;/span> &lt;span class="nx">be&lt;/span> &lt;span class="nx">installed&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">javascript&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">common&lt;/span> &lt;span class="nx">libgpm2&lt;/span> &lt;span class="nx">libjs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">jquery&lt;/span> &lt;span class="nx">libjs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">skeleton&lt;/span> &lt;span class="nx">libjs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">sphinxdoc&lt;/span> &lt;span class="nx">libjs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">underscore&lt;/span> &lt;span class="nx">libmpdec3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">0&lt;/span> &lt;span class="nx">upgraded&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">69&lt;/span> &lt;span class="nx">newly&lt;/span> &lt;span class="nx">installed&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">remove&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="nx">not&lt;/span> &lt;span class="nx">upgraded&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Need&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">get&lt;/span> &lt;span class="mf">13.0&lt;/span> &lt;span class="nx">MB&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">archives&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">After&lt;/span> &lt;span class="nx">this&lt;/span> &lt;span class="nx">operation&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mf">55.7&lt;/span> &lt;span class="nx">MB&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">additional&lt;/span> &lt;span class="nx">disk&lt;/span> &lt;span class="nx">space&lt;/span> &lt;span class="nx">will&lt;/span> &lt;span class="nx">be&lt;/span> &lt;span class="nx">used&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Do&lt;/span> &lt;span class="nx">you&lt;/span> &lt;span class="nx">want&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="k">continue&lt;/span>&lt;span class="err">?&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">Y&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">y&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Setting&lt;/span> &lt;span class="nx">up&lt;/span> &lt;span class="nx">recon&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nf">ng&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mf">5.1.1&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Processing&lt;/span> &lt;span class="nx">triggers&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">libc&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nf">bin&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mf">2.31&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">13&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nx">deb11u4&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">web&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">cff6559d7&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">jddwt&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="err">#&lt;/span> &lt;span class="nx">recon&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ng&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">Version&lt;/span> &lt;span class="nx">check&lt;/span> &lt;span class="nx">disabled&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>\
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span> &lt;span class="err">\\&lt;/span> &lt;span class="o">/&lt;/span>\
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Sponsored&lt;/span> &lt;span class="nx">by&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="err">\\&lt;/span>&lt;span class="nx">V&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="o">/&lt;/span>\
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span> &lt;span class="err">\\&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="c1">// \\\\\ \\ \/\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// // BLACK HILLS \/ \\&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">www&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">blackhillsinfosec&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">com&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">____&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="nx">_____&lt;/span> &lt;span class="nx">_&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="nx">____&lt;/span> &lt;span class="nx">____&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span>&lt;span class="nx">____&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">___&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="nx">____&lt;/span>&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="nx">____&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="nx">____&lt;/span> &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="err">\&lt;/span>&lt;span class="nx">_&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="nx">____&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">____&lt;/span>&lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="nx">____&lt;/span> &lt;span class="p">|&lt;/span>&lt;span class="nx">____&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">www&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">practisec&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">com&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">[&lt;/span>&lt;span class="nx">recon&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ng&lt;/span> &lt;span class="nx">v5&lt;/span>&lt;span class="mf">.1.1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">Tim&lt;/span> &lt;span class="nf">Tomes&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="nx">lanmaster53&lt;/span>&lt;span class="p">)]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nx">No&lt;/span> &lt;span class="nx">modules&lt;/span> &lt;span class="nx">enabled&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">installed&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">recon&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">ng&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="k">default&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="332-nginx-bash">3.3.2. nginx bash
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">web-cff6559d7-jddwt 1/1 Running 0 5m4s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl exec -it web-cff6559d7-jddwt -- /bin/bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Guide_rke2_offline_install</title><link>https://wangken0129.github.io/p/guide_rke2_offline_install/</link><pubDate>Sat, 23 Sep 2023 07:02:38 +0800</pubDate><guid>https://wangken0129.github.io/p/guide_rke2_offline_install/</guid><description>&lt;h1 id="rke2-offline-install">rke2 offline install
&lt;/h1>&lt;h2 id="1-下載1246離線安裝所需image">1. 下載1.24.6離線安裝所需image
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">cd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mkdir&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cannot&lt;/span> &lt;span class="n">create&lt;/span> &lt;span class="n">directory&lt;/span> &lt;span class="err">‘&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span>&lt;span class="err">’&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="ne">File&lt;/span> &lt;span class="n">exists&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">su&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span> &lt;span class="c1"># cd /root/rke2-artifacts/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># ll&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># curl -OLs https://github.com/rancher/rke2/releases/download/v1.24.6%2Brke2r1/rke2-images.linux-amd64.tar.zst&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># curl -OLs https://github.com/rancher/rke2/releases/download/v1.24.6%2Brke2r1/rke2.linux-amd64.tar.gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># curl -OLs https://github.com/rancher/rke2/releases/download/v1.24.6%2Brke2r1/sha256sum-amd64.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># curl -sfL https://get.rke2.io --output install.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># ll&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total&lt;/span> &lt;span class="mi">823052&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">21438&lt;/span> &lt;span class="n">Oct&lt;/span> &lt;span class="mi">11&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">19&lt;/span> &lt;span class="n">install&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">794531974&lt;/span> &lt;span class="n">Oct&lt;/span> &lt;span class="mi">11&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">17&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zst&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">48238609&lt;/span> &lt;span class="n">Oct&lt;/span> &lt;span class="mi">11&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="mi">3626&lt;/span> &lt;span class="n">Oct&lt;/span> &lt;span class="mi">11&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">18&lt;/span> &lt;span class="n">sha256sum&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="2-解壓縮與基本設定">2. 解壓縮與基本設定
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># INSTALL_RKE2_ARTIFACT_PATH=/root/rke2-artifacts sh install.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">WARN&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">read&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">only&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">mount&lt;/span> &lt;span class="n">point&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">installing&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">staging&lt;/span> &lt;span class="n">local&lt;/span> &lt;span class="n">checksums&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sha256sum&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">staging&lt;/span> &lt;span class="n">zst&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">image&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zst&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">staging&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">verifying&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">tarball&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">grep&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">tmp&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">XRvs61dJ7e&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">images&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">checksums&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">No&lt;/span> &lt;span class="n">such&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">directory&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">installing&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">agent&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">images&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">verifying&lt;/span> &lt;span class="n">tarball&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">unpacking&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">updating&lt;/span> &lt;span class="n">tarball&lt;/span> &lt;span class="n">contents&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">reflect&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">moving&lt;/span> &lt;span class="n">systemd&lt;/span> &lt;span class="n">units&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">complete&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">may&lt;/span> &lt;span class="n">want&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">run&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="k">export&lt;/span> &lt;span class="n">PATH&lt;/span>&lt;span class="o">=$&lt;/span>&lt;span class="n">PATH&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">opt&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># export PATH=$PATH:/opt/rke2/bin&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="3-叢集基礎組態">3. 叢集基礎組態
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rms1:~/rke2-artifacts # mkdir -p /etc/rancher/rke2/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] root 的密碼：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rms1:~/rke2-artifacts # vim /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rms1:~/rke2-artifacts # cat /etc/rancher/rke2/config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">node-name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;#34;rms1&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">token: my-shared-secret
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="4-啟用rke2服務">4. 啟用RKE2服務
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rms1:~/rke2-artifacts # systemctl enable --now rke2-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/rke2-server.service → /etc/systemd/system/rke2-server.service.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="5-設定一般帳號使用kubectl">5. 設定一般帳號使用kubectl
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">artifacts&lt;/span> &lt;span class="c1"># exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">chown&lt;/span> &lt;span class="n">rancher&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rancher&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubectl&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">po&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">A&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAMESPACE&lt;/span> &lt;span class="n">NAME&lt;/span> &lt;span class="n">READY&lt;/span> &lt;span class="n">STATUS&lt;/span> &lt;span class="n">RESTARTS&lt;/span> &lt;span class="n">AGE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">cloud&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">controller&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rms1&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="n">m5s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">etcd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rms1&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m46s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">canal&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lpv22&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Completed&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="n">m&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">coredns&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">xndpj&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Completed&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="n">m&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">r5sq&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Completed&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="n">m&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">helm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">install&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">metrics&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">wkz6c&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Completed&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="n">m&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">apiserver&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rms1&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m37s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">controller&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rms1&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m30s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">proxy&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rms1&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m57s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">scheduler&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rms1&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m37s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">canal&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">clqp4&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m41s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">coredns&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">coredns&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">76&lt;/span>&lt;span class="n">cb76d66&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">xpnqg&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m42s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">coredns&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">coredns&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">autoscaler&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">58867&lt;/span>&lt;span class="n">f8fc5&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">hzz2l&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="n">m42s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">nginx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">controller&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">zfbvx&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">93&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kube&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">system&lt;/span> &lt;span class="n">rke2&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">metrics&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">6979&lt;/span>&lt;span class="n">d95f95&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">kmbcv&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">109&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="6-加入其他節點">6. 加入其他節點
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="7-安裝helm">7. 安裝helm
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; wget https://get.helm.sh/helm-v3.9.4-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--2022-10-11 20:33:57-- https://get.helm.sh/helm-v3.9.4-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Resolving get.helm.sh (get.helm.sh)... 152.199.39.108, 2606:2800:247:1cb7:261b:1f9c:2074:3c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connecting to get.helm.sh (get.helm.sh)|152.199.39.108|:443... connected.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTTP request sent, awaiting response... 200 OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Length: 14026634 (13M) [application/x-tar]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Saving to: ‘helm-v3.9.4-linux-amd64.tar.gz’
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">helm-v3.9.4-linux-amd64.tar.gz 100%[======================================================&amp;gt;] 13.38M 11.0MB/s in 1.2s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2022-10-11 20:34:00 (11.0 MB/s) - ‘helm-v3.9.4-linux-amd64.tar.gz’ saved [14026634/14026634]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; tar zxvf helm-v3.9.4-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/helm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/LICENSE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/README.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; sudo cp linux-amd64/helm /usr/local/bin/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="8-啟用cert-manageroptional">8. 啟用cert-manager(optional)
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">apply&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crds&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificaterequests&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificates&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">challenges&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">clusterissuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">issuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">created&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">add&lt;/span> &lt;span class="n">jetstack&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">charts&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">jetstack&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;jetstack&amp;#34;&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">added&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">repositories&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">repo&lt;/span> &lt;span class="n">update&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Hang&lt;/span> &lt;span class="n">tight&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="n">we&lt;/span> &lt;span class="n">grab&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">latest&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repositories&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">...&lt;/span>&lt;span class="n">Successfully&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">update&lt;/span> &lt;span class="n">from&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="s2">&amp;#34;jetstack&amp;#34;&lt;/span> &lt;span class="n">chart&lt;/span> &lt;span class="n">repository&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Update&lt;/span> &lt;span class="n">Complete&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="err">⎈&lt;/span>&lt;span class="n">Happy&lt;/span> &lt;span class="n">Helming&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="err">⎈&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">helm&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">jetstack&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">namespace&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">create&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">namespace&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">version&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">LAST&lt;/span> &lt;span class="n">DEPLOYED&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Tue&lt;/span> &lt;span class="n">Oct&lt;/span> &lt;span class="mi">11&lt;/span> &lt;span class="mi">20&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">35&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">43&lt;/span> &lt;span class="mi">2022&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAMESPACE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">STATUS&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">deployed&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">REVISION&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">TEST&lt;/span> &lt;span class="n">SUITE&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">None&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NOTES&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">7.1&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">been&lt;/span> &lt;span class="n">deployed&lt;/span> &lt;span class="n">successfully&lt;/span>&lt;span class="o">!&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="n">order&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">begin&lt;/span> &lt;span class="n">issuing&lt;/span> &lt;span class="n">certificates&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">will&lt;/span> &lt;span class="n">need&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">set&lt;/span> &lt;span class="n">up&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">ClusterIssuer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="ow">or&lt;/span> &lt;span class="n">Issuer&lt;/span> &lt;span class="n">resource&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="k">for&lt;/span> &lt;span class="n">example&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">creating&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="s1">&amp;#39;letsencrypt-staging&amp;#39;&lt;/span> &lt;span class="n">issuer&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">More&lt;/span> &lt;span class="n">information&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">different&lt;/span> &lt;span class="n">types&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">issuers&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">how&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">them&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">can&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">found&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">our&lt;/span> &lt;span class="n">documentation&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">configuration&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">For&lt;/span> &lt;span class="n">information&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">how&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">automatically&lt;/span> &lt;span class="n">provision&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Certificates&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">Ingress&lt;/span> &lt;span class="n">resources&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">take&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">look&lt;/span> &lt;span class="n">at&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="err">`&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">shim&lt;/span>&lt;span class="err">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">documentation&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">docs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">usage&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ingress&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rancher&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">rms1&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~&amp;gt;&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">po&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span> &lt;span class="n">READY&lt;/span> &lt;span class="n">STATUS&lt;/span> &lt;span class="n">RESTARTS&lt;/span> &lt;span class="n">AGE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">646&lt;/span>&lt;span class="n">c67487&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">p9w77&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cainjector&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">7&lt;/span>&lt;span class="n">cb8669d6b&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cwghz&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">webhook&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">696&lt;/span>&lt;span class="n">c5db7ff&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">sjbw4&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">72&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="9-啟用rancher-268">9. 啟用Rancher 2.6.8
&lt;/h2>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm repo add rancher-stable https://releases.rancher.com/server-charts/stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;#34;rancher-stable&amp;#34; has been added to your repositories
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl create namespace cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">namespace/cattle-system created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm repo update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Hang tight while we grab the latest from your chart repositories...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...Successfully got an update from the &amp;#34;jetstack&amp;#34; chart repository
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...Successfully got an update from the &amp;#34;rancher-stable&amp;#34; chart repository
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Update Complete. ⎈Happy Helming!⎈
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; helm install rancher rancher-stable/rancher --namespace cattle-system --set hostname=rancher.example.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME: rancher
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">LAST DEPLOYED: Tue Oct 11 20:37:49 2022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAMESPACE: cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">STATUS: deployed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">REVISION: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">TEST SUITE: None
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOTES:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Rancher Server has been installed.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NOTE: Rancher may take several minutes to fully initialize. Please standby while Certificates are being issued, Containers are started and the Ingress rule comes up.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Check out our docs at https://rancher.com/docs/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If you provided your own bootstrap password during installation, browse to https://rancher.example.com to get started.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">If this is the first time you installed Rancher, get started by running this command and clicking the URL it generates:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">echo https://rancher.example.com/dashboard/?setup=$(kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&amp;#39;{{.data.bootstrapPassword|base64decode}}&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">To get just the bootstrap password on its own, run:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&amp;#39;{{.data.bootstrapPassword|base64decode}}{{ &amp;#34;\n&amp;#34; }}&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Happy Containering!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n cattle-system get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-mrhwt 0/1 ContainerCreating 0 2m17s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-nhl5m 0/1 ContainerCreating 0 2m17s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-tswd8 0/1 ContainerCreating 0 2m17s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n cattle-system get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-mrhwt 0/1 Running 0 2m27s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-nhl5m 0/1 Running 0 2m27s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-tswd8 0/1 ContainerCreating 0 2m27s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher@rms1:~&amp;gt; kubectl -n cattle-system get po
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-mrhwt 1/1 Running 2 (77s ago) 7m12s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-nhl5m 1/1 Running 1 (2m39s ago) 7m12s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rancher-69595dc9c4-tswd8 1/1 Running 2 (77s ago) 7m12s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Hello World</title><link>https://wangken0129.github.io/p/hello-world/</link><pubDate>Tue, 19 Sep 2023 05:10:00 +0800</pubDate><guid>https://wangken0129.github.io/p/hello-world/</guid><description>&lt;h1 id="hello-world">Hello World
&lt;/h1>&lt;h2 id="description">Description
&lt;/h2>&lt;p>This is a blog for my labs and knowledge bases.&lt;/p>
&lt;p>Happy engineering.&lt;/p>
&lt;p>這是Ken的部落格，用來放我的Lab跟知識庫。&lt;/p>
&lt;p>當個快樂的工程師。&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/0*ngAthWxOvKZHvsw9.jpeg"
loading="lazy"
alt="The Dangers of Hacking and What a Hacker Can Do to Your Computer? | by Sravan Cynixit | Quick Code | Medium"
>&lt;/p>
&lt;h2 id="this-is-a-test-shell-script">This is a test shell script
&lt;/h2>&lt;p>Generate certificate script&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1"># Create certificate given a specific url name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$#&lt;/span> -ne &lt;span class="m">1&lt;/span> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;No arguments supplied or too many arguments&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Usage: &lt;/span>&lt;span class="nv">$0&lt;/span>&lt;span class="s2"> domain_name&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">MYNAME&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Generating a private key...for &lt;/span>&lt;span class="nv">$MYNAME&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl genrsa -out &lt;span class="nv">$MYNAME&lt;/span>.key &lt;span class="m">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Generating a CSR...for &lt;/span>&lt;span class="nv">$MYNAME&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl req -new -key &lt;span class="nv">$MYNAME&lt;/span>.key &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-out &lt;span class="nv">$MYNAME&lt;/span>.csr &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-subj &lt;span class="s2">&amp;#34;/C=US/ST=NC/L=Raleigh/O=RedHat/OU=RHT/CN=&lt;/span>&lt;span class="nv">$MYNAME&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Generating a certificate...for &lt;/span>&lt;span class="nv">$MYNAME&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl x509 -req -days &lt;span class="m">366&lt;/span> -in &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>&lt;span class="nv">$MYNAME&lt;/span>.csr -signkey &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>&lt;span class="nv">$MYNAME&lt;/span>.key &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>-out &lt;span class="nv">$MYNAME&lt;/span>.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>