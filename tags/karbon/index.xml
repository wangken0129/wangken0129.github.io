<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Karbon on Ken's blog</title><link>https://wangken0129.github.io/tags/karbon/</link><description>Recent content in Karbon on Ken's blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 23 Sep 2023 02:46:09 +0800</lastBuildDate><atom:link href="https://wangken0129.github.io/tags/karbon/index.xml" rel="self" type="application/rss+xml"/><item><title>Nutanix Karbon&amp;Files</title><link>https://wangken0129.github.io/p/karbonfiles/</link><pubDate>Sat, 23 Sep 2023 02:46:09 +0800</pubDate><guid>https://wangken0129.github.io/p/karbonfiles/</guid><description>&lt;h1 id="karbonfiles">Karbon、Files
&lt;/h1>&lt;p>測試安裝Nutanix 內建的Kubernetes，並使用內建的Storage儲存空間(NFS、Volume)&lt;/p>
&lt;h2 id="linux主機安裝設定測試用">Linux主機安裝設定(測試用)
&lt;/h2>&lt;p>(測試功能又不佔用ip才需要此Linux主機)&lt;/p>
&lt;h3 id="安裝一台centos-stream9">安裝一台CentOS-Stream9
&lt;/h3>&lt;p>IP: 172.16.90.205 , 192.168.1.1
Host: bastion.netfos.ken.lab&lt;/p>
&lt;p>此VM作用為 Router, NAT, DHCP, DNS,Web等等&lt;/p>
&lt;p>PE Network設定,新增192.168.1.1的subnet並綁到vSwitch上 (啟動IPAM)&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230111135752295.png"
loading="lazy"
alt="image-20230111135752295"
>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>upload iso to Prism Element&lt;/p>
&lt;/li>
&lt;li>
&lt;p>on Prism Central import iso&lt;/p>
&lt;/li>
&lt;li>
&lt;p>create VM on Prism Central
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230111114303181.png"
loading="lazy"
alt="image-20230111114303181"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>安裝OS&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="設定router--nat">設定Router &amp;amp; NAT
&lt;/h3>&lt;p>&lt;a class="link" href="https://linux.vbird.org/linux_server/centos6/0230router.php" target="_blank" rel="noopener"
>https://linux.vbird.org/linux_server/centos6/0230router.php&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>啟動Linux Kernal 的 ip_forwarder功能&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo vim /etc/sysctl.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv4.ip_forward = 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo sysctl -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv4.ip_forward = 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo cat /proc/sys/net/ipv4/ip_forward
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>NAT設定&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo iptables -A INPUT -i ens4 -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo iptables -A INPUT -i lo -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j MASQUERADE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo iptables -L
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Chain INPUT (policy ACCEPT)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">target prot opt source destination
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ACCEPT all -- anywhere anywhere
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Chain FORWARD (policy ACCEPT)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">target prot opt source destination
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Chain OUTPUT (policy ACCEPT)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">target prot opt source destination
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo iptables-save
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Generated by iptables-save v1.8.8 (nf_tables) on Wed Jan 11 12:06:10 2023
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*filter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:INPUT ACCEPT [0:0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:FORWARD ACCEPT [0:0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:OUTPUT ACCEPT [0:0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A INPUT -i ens4 -j ACCEPT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">COMMIT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Completed on Wed Jan 11 12:06:10 2023
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Generated by iptables-save v1.8.8 (nf_tables) on Wed Jan 11 12:06:10 2023
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*nat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:PREROUTING ACCEPT [0:0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:INPUT ACCEPT [0:0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:OUTPUT ACCEPT [0:0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">:POSTROUTING ACCEPT [0:0]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-A POSTROUTING -s 192.168.1.0/24 -j MASQUERADE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">COMMIT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># Completed on Wed Jan 11 12:06:10 2023
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">關閉防火牆
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl disable firewalld --now
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>DNAT設定
&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Port-Reference:NKE_Airgap_port_auto_r.html" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Port-Reference:NKE_Airgap_port_auto_r.html&lt;/a>
&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Port-Reference:Nutanix_Kubernetes_Engine_port_auto_r.html" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Port-Reference:Nutanix_Kubernetes_Engine_port_auto_r.html&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">## For NKE Registry
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables -t nat -A PREROUTING -i ens3 -p tcp --dport 22 \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -j DNAT --to-destination 192.168.1.5:22
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables -t nat -A PREROUTING -i ens3 -p tcp --dport 5000 \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -j DNAT --to-destination 192.168.1.5:5000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables-save
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">## For NKE Loadbalnacer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables -t nat -A PREROUTING -i ens3 -p tcp --dport 443 \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -j DNAT --to-destination 192.168.1.10:22
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables -t nat -A PREROUTING -i ens3 -p tcp --dport 2379 \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -j DNAT --to-destination 192.168.1.10:2379
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables -t nat -A PREROUTING -i ens3 -p tcp --dport 30001 \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -j DNAT --to-destination 192.168.1.10:30001
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables -t nat -A PREROUTING -i ens3 -p tcp --dport 30000:32767 \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -j DNAT --to-destination 192.168.1.10:30000-32767
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo iptables-save
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>拿一台測試VM確認可ping 通
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230111135706837.png"
loading="lazy"
alt="image-20230111135706837"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="安裝dns-server-named">安裝DNS Server (named)
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>安裝named&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo yum install bind bind-libs bind-chroot bind-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] password for ken:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>修改named 設定檔 /etc/named.conf&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">data&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="c1"># cat /etc/named.conf &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">named&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">Provided&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">Red&lt;/span> &lt;span class="n">Hat&lt;/span> &lt;span class="n">bind&lt;/span> &lt;span class="n">package&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">configure&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">ISC&lt;/span> &lt;span class="n">BIND&lt;/span> &lt;span class="n">named&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">DNS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">as&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">caching&lt;/span> &lt;span class="n">only&lt;/span> &lt;span class="n">nameserver&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">as&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">localhost&lt;/span> &lt;span class="n">DNS&lt;/span> &lt;span class="n">resolver&lt;/span> &lt;span class="n">only&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span> &lt;span class="n">See&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">share&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">doc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="o">*/&lt;/span>&lt;span class="n">sample&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">example&lt;/span> &lt;span class="n">named&lt;/span> &lt;span class="n">configuration&lt;/span> &lt;span class="n">files&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">//&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">options&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listen&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">on&lt;/span> &lt;span class="n">port&lt;/span> &lt;span class="mi">53&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">//&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">on&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">v6&lt;/span> &lt;span class="n">port&lt;/span> &lt;span class="mi">53&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">::&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">directory&lt;/span> &lt;span class="s2">&amp;#34;/var/named&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dump&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;/var/named/data/cache_dump.db&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">statistics&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;/var/named/data/named_stats.txt&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">memstatistics&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;/var/named/data/named_mem_stats.txt&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">secroots&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;/var/named/data/named.secroots&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recursing&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;/var/named/data/named.recursing&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">allow&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">query&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">any&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">## 設定轉寄站&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">forwarders&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">102.1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">102.2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">If&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">are&lt;/span> &lt;span class="n">building&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">AUTHORITATIVE&lt;/span> &lt;span class="n">DNS&lt;/span> &lt;span class="n">server&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="n">NOT&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">recursion&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">If&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">are&lt;/span> &lt;span class="n">building&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">RECURSIVE&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">caching&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">DNS&lt;/span> &lt;span class="n">server&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">need&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recursion&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">If&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">recursive&lt;/span> &lt;span class="n">DNS&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">has&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">public&lt;/span> &lt;span class="ne">IP&lt;/span> &lt;span class="n">address&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">you&lt;/span> &lt;span class="n">MUST&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">access&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">control&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">limit&lt;/span> &lt;span class="n">queries&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">legitimate&lt;/span> &lt;span class="n">users&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">Failing&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="n">so&lt;/span> &lt;span class="n">will&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cause&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">become&lt;/span> &lt;span class="n">part&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">large&lt;/span> &lt;span class="n">scale&lt;/span> &lt;span class="n">DNS&lt;/span> &lt;span class="n">amplification&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">attacks&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">Implementing&lt;/span> &lt;span class="n">BCP38&lt;/span> &lt;span class="n">within&lt;/span> &lt;span class="n">your&lt;/span> &lt;span class="n">network&lt;/span> &lt;span class="n">would&lt;/span> &lt;span class="n">greatly&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">reduce&lt;/span> &lt;span class="n">such&lt;/span> &lt;span class="n">attack&lt;/span> &lt;span class="n">surface&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recursion&lt;/span> &lt;span class="n">yes&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dnssec&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">validation&lt;/span> &lt;span class="n">no&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dnssec&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">enable&lt;/span> &lt;span class="n">yes&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">managed&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">keys&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">directory&lt;/span> &lt;span class="s2">&amp;#34;/var/named/dynamic&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">geoip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">directory&lt;/span> &lt;span class="s2">&amp;#34;/usr/share/GeoIP&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pid&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;/run/named/named.pid&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">session&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">keyfile&lt;/span> &lt;span class="s2">&amp;#34;/run/named/session.key&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/*&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">fedoraproject&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">org&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">wiki&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">Changes&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">CryptoPolicy&lt;/span> &lt;span class="o">*/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">include&lt;/span> &lt;span class="s2">&amp;#34;/etc/crypto-policies/back-ends/bind.config&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">logging&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">channel&lt;/span> &lt;span class="n">default_debug&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;data/named.run&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">severity&lt;/span> &lt;span class="n">dynamic&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">zone&lt;/span> &lt;span class="s2">&amp;#34;.&amp;#34;&lt;/span> &lt;span class="n">IN&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">type&lt;/span> &lt;span class="n">hint&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;named.ca&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s2">&amp;#34;/etc/named.rfc1912.zones&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">include&lt;/span> &lt;span class="s2">&amp;#34;/etc/named.root.key&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">zone&lt;/span> &lt;span class="s2">&amp;#34;netfos.ken.lab&amp;#34;&lt;/span> &lt;span class="n">IN&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">type&lt;/span> &lt;span class="n">master&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;ken.zone&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">allow&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">update&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">none&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">allow&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">query&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">any&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">allow&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">transfer&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">none&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">zone&lt;/span> &lt;span class="s2">&amp;#34;1.168.192.in-addr.arpa&amp;#34;&lt;/span> &lt;span class="n">IN&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">type&lt;/span> &lt;span class="n">master&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file&lt;/span> &lt;span class="s2">&amp;#34;ken.reverse&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">allow&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">update&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">none&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">allow&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">query&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">any&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">allow&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">transfer&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="n">none&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>修改正向解析 /var/named/ken.zone&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-dns" data-lang="dns">&lt;span class="line">&lt;span class="cl">&lt;span class="err">[root@bastion&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">named]#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">cat&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nc">ken.zone&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="na">$TTL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="sc">1&lt;/span>&lt;span class="err">W&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nc">@&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">IN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">SOA&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="py">bastion.netfos.ken.lab. &lt;/span>&lt;span class="err">root&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">2019070700&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; serial&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">3&lt;/span>&lt;span class="err">H&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; refresh (3 hours)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">30&lt;/span>&lt;span class="err">M&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; retry (30 minutes)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">2&lt;/span>&lt;span class="err">W&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; expiry (2 weeks)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">1&lt;/span>&lt;span class="err">W&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; minimum (1 week)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">IN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="py">bastion.netfos.ken.lab.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="py">bastion.netfos.ken.lab. &lt;/span>&lt;span class="k">IN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">A&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">192.168.1.1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c">;EOF&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>修改反解析 /var/named/ken.reverse&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-dns" data-lang="dns">&lt;span class="line">&lt;span class="cl">&lt;span class="err">[root@bastion&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">named]#&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="err">cat&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nc">ken.reverse&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="na">$TTL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="sc">10&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nc">@&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">IN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">SOA&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="py">bastion.netfos.ken.lab. &lt;/span>&lt;span class="err">root&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">2019070700&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; serial&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">3&lt;/span>&lt;span class="err">H&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; refresh (3 hours)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">30&lt;/span>&lt;span class="err">M&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; retry (30 minutes)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">2&lt;/span>&lt;span class="err">W&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; expiry (2 weeks)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="sc">1&lt;/span>&lt;span class="err">W&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">; minimum (1 week)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">IN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="py">bastion.netfos.ken.lab.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c">;EOF&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>調整防火牆&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="c1"># firewall-cmd --add-service=dns --permanent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="c1"># firewall-cmd --reload&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>啟動服務&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[root@bastion ~]# systemctl enable named --now
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>驗證DNS&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ dig +noall +answer @192.168.1.1 bastion.netfos.ken.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bastion.netfos.ken.lab. 604800 IN A 192.168.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ nslookup 168.95.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1.1.95.168.in-addr.arpa name = dns.hinet.net.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Authoritative answers can be found from:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h3 id="安裝nfs-server">安裝NFS Server
&lt;/h3>&lt;ol>
&lt;li>
&lt;p>install&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo yum install nfs-utils
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>setting&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">nfs01&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">chmod&lt;/span> &lt;span class="mi">777&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">nfs01&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">vim&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">exports&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">/&lt;/span>&lt;span class="n">nfs01&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">24&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">no_root_squash&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">now&lt;/span> &lt;span class="n">rpcbind&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">防火牆關閉或是開&lt;/span>&lt;span class="n">nfs&lt;/span> &lt;span class="n">service&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="karbon-airgap">Karbon (Airgap)
&lt;/h2>&lt;p>&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:top-airgap-deploy-t.html" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:top-airgap-deploy-t.html&lt;/a>
&lt;a class="link" href="https://next.nutanix.com/nutanix-kubernetes-engine-30/karbon-install-40404" target="_blank" rel="noopener"
>https://next.nutanix.com/nutanix-kubernetes-engine-30/karbon-install-40404&lt;/a>
&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:Nutanix-Kubernetes-Engine-v2_6" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:Nutanix-Kubernetes-Engine-v2_6&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/airgap-architecture-diagram.png"
loading="lazy"
alt="img"
>&lt;/p>
&lt;h4 id="安裝httpd">安裝httpd
&lt;/h4>&lt;ol>
&lt;li>
&lt;p>安裝httpd&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo yum install httpd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>新增資料夾並複製Karbon檔案&amp;amp;解壓縮&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">sudo&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">ken&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">scp&lt;/span> &lt;span class="n">airgap&lt;/span>&lt;span class="o">-*&lt;/span> &lt;span class="n">root&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mf">172.16&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">90.205&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">airgap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">0.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">airgap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manifest&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">json&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">tar&lt;/span> &lt;span class="n">xvzf&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">www&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">airgap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">0.&lt;/span>&lt;span class="n">tar&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">gz&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>啟動httpd,確認可以瀏覽至該目錄&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ sudo systemctl enable httpd --now
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service → /usr/lib/systemd/system/httpd.service.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230111164809319.png" alt="image-20230111164809319" style="zoom:33%;" />
&lt;/li>
&lt;/ol>
&lt;h4 id="安裝karbon">安裝Karbon
&lt;/h4>&lt;p>&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:Nutanix-Kubernetes-Engine-v2_6" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:Nutanix-Kubernetes-Engine-v2_6&lt;/a>
&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:top-airgap-c.html" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_6:top-airgap-c.html&lt;/a>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>PC Enable Karbon&lt;/p>
&lt;/li>
&lt;li>
&lt;p>LCM確認Karbon版本為最新 (2.6.0)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>PC 加一張網卡(連192.168.1.0的網段)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ sudo ifconfig eth1 192.168.1.2 netmask 255.255.255.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ sudo ip link set eth1 down
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ sudo ip link set eth1 up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ route -n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Kernel IP routing table
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Destination Gateway Genmask Flags Metric Ref Use Iface
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0.0.0.0 172.16.90.254 0.0.0.0 UG 0 0 0 eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">169.254.0.0 0.0.0.0 255.255.0.0 U 1002 0 0 eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">172.16.90.0 0.0.0.0 255.255.255.0 U 0 0 0 eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.1.0 0.0.0.0 255.255.255.0 U 0 0 0 eth1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>
&lt;p>用nutanix登入進prism central, cd 進/home/nutanix/karbon&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC % ssh -m hmac-sha2-256 nutanix@172.16.90.219
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Prism Central VM
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@172.16.90.219&amp;#39;s password: nutanix/4u
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ pwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/home/nutanix/karbon
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">karbonctl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">登入prism central
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ ./karbonctl login --pc-ip 172.16.90.219 \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--pc-username admin \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--pc-password Nutanix@20230109
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Login successful
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>填入資訊並執行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">pcvm&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbon&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbonctl&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">enable&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">webserver&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">url&lt;/span> &lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">webserver_url&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">version&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">number&lt;/span>&lt;span class="o">/&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">vlan&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="n">network_name&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">static&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ip&lt;/span> &lt;span class="k">static&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">address&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">storage&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">container&lt;/span> &lt;span class="n">storage_container_name&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">pe&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="n">PE_cluster_name&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">–&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pe&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">username&lt;/span> &lt;span class="n">user&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----&lt;/span> &lt;span class="err">執行安裝指令&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="err">若出現&lt;/span>&lt;span class="n">pe&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">username的error可以把它調到最前面&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">pcvm&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">karbonctl&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">enable&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">–&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pe&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">username&lt;/span> &lt;span class="n">admin&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">webserver&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">url&lt;/span> &lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">172.16&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">90.205&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">vlan&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.0&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">static&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ip&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.5&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">storage&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">container&lt;/span> &lt;span class="n">VM&lt;/span> \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">--&lt;/span>&lt;span class="n">pe&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="n">NX3360NG8&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Cluster&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">NTNX&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">172&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">90&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">219&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">PCVM&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">karbon&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbon&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbonctl&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">pe&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">username&lt;/span> &lt;span class="n">admin&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">webserver&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">url&lt;/span> &lt;span class="n">http&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">172.16&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">90.205&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">ntnx&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">2.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">vlan&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.0&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="k">static&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">ip&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.5&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">storage&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">container&lt;/span> &lt;span class="n">VM&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">pe&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cluster&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="n">NX3360NG8&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">Cluster&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Please&lt;/span> &lt;span class="n">enter&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">password&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">PE&lt;/span> &lt;span class="n">user&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">admin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Successfully&lt;/span> &lt;span class="n">submitted&lt;/span> &lt;span class="n">request&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">airgap&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">POST&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">airgap&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="mi">202&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="n">postAirgapAccepted&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">TaskUUID&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mh">0xc000370140&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">----&lt;/span> &lt;span class="err">確認執行進度&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">NTNX&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">172&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">90&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">219&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">PCVM&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">karbon&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">karbonctl&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Airgap&lt;/span> &lt;span class="n">UUID&lt;/span> &lt;span class="n">VM&lt;/span> &lt;span class="ne">IP&lt;/span> &lt;span class="n">URL&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Package&lt;/span> &lt;span class="n">Upload&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Registry&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Message&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">33844&lt;/span>&lt;span class="n">fb8&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">a677&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4412&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5440&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">b099f4a5289d&lt;/span> &lt;span class="p">:&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">Deploying&lt;/span> &lt;span class="n">host&lt;/span> &lt;span class="ne">OS&lt;/span> &lt;span class="n">images&lt;/span> &lt;span class="n">Not&lt;/span> &lt;span class="n">running&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230111173203221.png"
loading="lazy"
alt="image-20230111173203221"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112092547218.png"
loading="lazy"
alt="image-20230112092547218"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>check ok&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">NTNX&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">172&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">90&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">219&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">PCVM&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">karbon&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">karbonctl&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Airgap&lt;/span> &lt;span class="n">UUID&lt;/span> &lt;span class="n">VM&lt;/span> &lt;span class="ne">IP&lt;/span> &lt;span class="n">URL&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Package&lt;/span> &lt;span class="n">Upload&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Registry&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Status&lt;/span> &lt;span class="n">Message&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mf">00e01072&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">b5a6&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4055&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">f55d78a8d57b&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.5&lt;/span> &lt;span class="n">airgap&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">5000&lt;/span> &lt;span class="n">Airgap&lt;/span> &lt;span class="n">registry&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">running&lt;/span> &lt;span class="n">Healthy&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>在Web UI新增Production Cluster
連線方式用External Loadbalancer: 192.168.1.10 &amp;ndash;&amp;gt; 要額外設定LoadBalancer
control plane: 192.168.1.6-8&lt;/p>
&lt;p>改用Active-Passive Mode &amp;ndash;&amp;gt; VIP 192.168.1.9&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112164205242.png"
loading="lazy"
alt="image-20230112164205242"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112164222735.png"
loading="lazy"
alt="image-20230112164222735"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112164247610.png"
loading="lazy"
alt="image-20230112164247610"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112164318768.png"
loading="lazy"
alt="image-20230112164318768"
>&lt;/p>
&lt;p>抽換為 Active-Passive Mode&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112170725765.png"
loading="lazy"
alt="image-20230112170725765"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112164346300.png"
loading="lazy"
alt="image-20230112164346300"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112164407434.png"
loading="lazy"
alt="image-20230112164407434"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112164422938.png"
loading="lazy"
alt="image-20230112164422938"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>安裝完畢
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112173209983.png"
loading="lazy"
alt="image-20230112173209983"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="連線測試nke">連線測試NKE
&lt;/h4>&lt;ol>
&lt;li>
&lt;p>下載kubeconfig
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112173233274.png" alt="image-20230112173233274" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>linux 安裝kubectl&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">curl&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">LO&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">dl&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">release&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">linux&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">amd64&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubectl&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">%&lt;/span> &lt;span class="n">Total&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">Received&lt;/span> &lt;span class="o">%&lt;/span> &lt;span class="n">Xferd&lt;/span> &lt;span class="n">Average&lt;/span> &lt;span class="n">Speed&lt;/span> &lt;span class="n">Time&lt;/span> &lt;span class="n">Time&lt;/span> &lt;span class="n">Time&lt;/span> &lt;span class="n">Current&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Dload&lt;/span> &lt;span class="n">Upload&lt;/span> &lt;span class="n">Total&lt;/span> &lt;span class="n">Spent&lt;/span> &lt;span class="n">Left&lt;/span> &lt;span class="n">Speed&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">100&lt;/span> &lt;span class="mi">138&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="mi">138&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">380&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="mi">379&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">100&lt;/span> &lt;span class="mf">44.4&lt;/span>&lt;span class="n">M&lt;/span> &lt;span class="mi">100&lt;/span> &lt;span class="mf">44.4&lt;/span>&lt;span class="n">M&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">8858&lt;/span>&lt;span class="n">k&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">05&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">05&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">--&lt;/span> &lt;span class="mf">10.6&lt;/span>&lt;span class="n">M&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">o&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">g&lt;/span> &lt;span class="n">root&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="mi">0755&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">local&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubectl&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">version&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">client&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Client&lt;/span> &lt;span class="n">Version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">version&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Info&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">Major&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Minor&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;23&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GitVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;v1.23.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GitCommit&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;ab69524f795c42094a6630298ff53f3c3ebab7f4&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GitTreeState&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;clean&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">BuildDate&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;2021-12-07T18:16:20Z&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">GoVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;go1.17.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Compiler&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;gc&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Platform&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s2">&amp;#34;linux/amd64&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">###將kubeconfig放到.kube/config &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">cp&lt;/span> &lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">kubectl&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cfg&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">rm&lt;/span> &lt;span class="o">.&lt;/span>&lt;span class="n">kube&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">kubeconfig&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cfg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">nodes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span> &lt;span class="n">STATUS&lt;/span> &lt;span class="n">ROLES&lt;/span> &lt;span class="n">AGE&lt;/span> &lt;span class="n">VERSION&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">master&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">master&lt;/span> &lt;span class="mi">25&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">master&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">master&lt;/span> &lt;span class="mi">25&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">worker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">node&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">worker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">node&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">worker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">node&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="n">m&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">node&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">o&lt;/span> &lt;span class="n">wide&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span> &lt;span class="n">STATUS&lt;/span> &lt;span class="n">ROLES&lt;/span> &lt;span class="n">AGE&lt;/span> &lt;span class="n">VERSION&lt;/span> &lt;span class="n">INTERNAL&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="ne">IP&lt;/span> &lt;span class="n">EXTERNAL&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="ne">IP&lt;/span> &lt;span class="ne">OS&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">IMAGE&lt;/span> &lt;span class="n">KERNEL&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">VERSION&lt;/span> &lt;span class="n">CONTAINER&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">RUNTIME&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">master&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">master&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="n">h&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.27&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">none&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">CentOS&lt;/span> &lt;span class="n">Linux&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Core&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mf">3.10&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1160.71&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.&lt;/span>&lt;span class="n">el7&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">x86_64&lt;/span> &lt;span class="n">containerd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">1.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">master&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">master&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="n">h&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.13&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">none&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">CentOS&lt;/span> &lt;span class="n">Linux&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Core&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mf">3.10&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1160.71&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.&lt;/span>&lt;span class="n">el7&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">x86_64&lt;/span> &lt;span class="n">containerd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">1.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">worker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">node&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="n">h&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.84&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">none&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">CentOS&lt;/span> &lt;span class="n">Linux&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Core&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mf">3.10&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1160.71&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.&lt;/span>&lt;span class="n">el7&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">x86_64&lt;/span> &lt;span class="n">containerd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">1.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">worker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">node&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="n">h&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.15&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">none&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">CentOS&lt;/span> &lt;span class="n">Linux&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Core&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mf">3.10&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1160.71&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.&lt;/span>&lt;span class="n">el7&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">x86_64&lt;/span> &lt;span class="n">containerd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">1.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">nke&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">34&lt;/span>&lt;span class="n">f192&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">worker&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">2&lt;/span> &lt;span class="n">Ready&lt;/span> &lt;span class="n">node&lt;/span> &lt;span class="mi">17&lt;/span>&lt;span class="n">h&lt;/span> &lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">23.11&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.82&lt;/span> &lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">none&lt;/span>&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">CentOS&lt;/span> &lt;span class="n">Linux&lt;/span> &lt;span class="mi">7&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Core&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mf">3.10&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mf">1160.71&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.&lt;/span>&lt;span class="n">el7&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">x86_64&lt;/span> &lt;span class="n">containerd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="mf">1.6&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mi">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### 新增測試pod&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">run&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">t&lt;/span> &lt;span class="n">busybox&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">radial&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">busyboxplus&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="n">curl&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">restart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Never&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h4 id="新增測試服務-redmine">新增測試服務-redmine
&lt;/h4>&lt;ol>
&lt;li>
&lt;p>postgresql的yaml檔-pvc&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">kind: PersistentVolumeClaim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: redmine-postgres-pv-claim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storageClassName: default-storageclass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> accessModes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - ReadWriteOnce
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> requests:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storage: 20Gi
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>postgresql的yaml檔-configmap&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">cat&lt;/span> &lt;span class="n">pgsql&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">apiVersion&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">v1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kind&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ConfigMap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">metadata&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgres&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">labels&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">namespace&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">data&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">POSTGRES_USER&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">POSTGRES_PASSWORD&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">P&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="mi">55&lt;/span>&lt;span class="n">w&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">rd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PGDATA&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">postgresql&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pgdata&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">POSTGRES_DB&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>postgresql的yaml檔-deployment&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">cat&lt;/span> &lt;span class="n">pgsql&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">deploy&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">apiVersion&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">apps&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">kind&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Deployment&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">metadata&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgres&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">deployment&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">namespace&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">spec&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">strategy&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">type&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Recreate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">selector&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">matchLabels&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">replicas&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">template&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">metadata&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">labels&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">spec&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">containers&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">image&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">postgres&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">12&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">imagePullPolicy&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;IfNotPresent&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ports&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">containerPort&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5432&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">envFrom&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">configMapRef&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgres&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">config&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">volumeMounts&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">mountPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">postgresql&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgredb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">subPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pgsql&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">mountPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">postgresql&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pg_hba&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgredb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">subPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pgsql&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">pghba&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">mountPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">postgresql&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">postgresql&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgredb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">subPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pgsql&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">postgresql&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">volumes&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">-&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgredb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">persistentVolumeClaim&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">claimName&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">redmine&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">postgres&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">pv&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">claim&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>postgresql的yaml檔-svc&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ cat pgsql-svc.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: redmine-postgres-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type: NodePort
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ports:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - port: 5432
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nodePort: 31432
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> selector:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: postgres
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>deploy pgsql&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ kubectl apply -f pgsql-pvc.yaml -n redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolumeclaim/redmine-postgres-pv-claim created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ kubectl apply -f pgsql-config.yaml -f pgsql-deploy.yaml -f pgsql-svc.yaml -n redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configmap/redmine-postgres-config created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/redmine-postgres-deployment created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/redmine-postgres-service created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">### 確認PV,PVC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ kubectl get pv,pvc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME CAPACITY ACCESS MODES RECLAIM POLICY STATUS CLAIM STORAGECLASS REASON AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolume/pvc-6e4760a1-6884-492f-8ecb-b2dc89ddfdde 30Gi RWO Delete Bound ntnx-system/prometheus-k8s-db-prometheus-k8s-0 default-storageclass 17h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolume/pvc-7875f29e-0b6e-409f-bcc2-d03b315ff2ac 20Gi RWO Delete Bound redmine/redmine-postgres-pv-claim default-storageclass 4s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolume/pvc-d5e769a0-3c74-4e99-b401-2deb620f90c0 30Gi RWO Delete Bound ntnx-system/prometheus-k8s-db-prometheus-k8s-1 default-storageclass 17h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persistentvolumeclaim/redmine-postgres-pv-claim Bound pvc-7875f29e-0b6e-409f-bcc2-d03b315ff2ac 20Gi RWO default-storageclass 7s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">### 確認pgsql status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ kubectl get all -n redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/redmine-postgres-deployment-6f6f66f9cd-4ph9q 1/1 Running 0 6m4s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/redmine-postgres-service NodePort 172.19.202.4 &amp;lt;none&amp;gt; 5432:31432/TCP 6m4s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY UP-TO-DATE AVAILABLE AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/redmine-postgres-deployment 1/1 1 1 6m4s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME DESIRED CURRENT READY AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">replicaset.apps/redmine-postgres-deployment-6f6f66f9cd 1 1 1 6m4s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">### Test node port 31432
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ telnet 192.168.1.84 31432
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Trying 192.168.1.84...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connected to 192.168.1.84.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Escape character is &amp;#39;^]&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">^CConnection closed by foreign host.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>redmine的yaml檔-config&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">data:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> configuration.yml: |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # = Redmine configuration file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # Each environment has its own configuration options. If you are only
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # running in production, only the production block needs to be configured.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # Environment specific configuration options override the default ones.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # Note that this file needs to be a valid YAML file.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # DO NOT USE TABS! Use 2 spaces instead of tabs for indentation.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # default configuration options for all environments
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> default:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> email_delivery:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> autologin_cookie_name:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> autologin_cookie_path:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_mercurial_command:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_git_command:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_cvs_command:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_bazaar_command:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_subversion_path_regexp:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_mercurial_path_regexp:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_git_path_regexp:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_cvs_path_regexp:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_bazaar_path_regexp:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_filesystem_path_regexp:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scm_stderr_log_file:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> database_cipher_key:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> minimagick_font_path:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> production:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> development:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: ConfigMap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: redmine-config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: redmine
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>redmine的yaml檔-deploy&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ cat redmine-deploy.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Deployment
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> replicas: 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> selector:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> matchLabels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> template:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> initContainers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 修正configmap所需的讀寫權限
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: fix-permission-for-configfile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> image: busybox:1.33.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> imagePullPolicy: IfNotPresent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> command: [&amp;#39;sh&amp;#39;, &amp;#39;-c&amp;#39;, &amp;#39;cat /tmp/configuration.yml &amp;amp;&amp;amp; cp /tmp/configuration.yml /config-tmp-dir/configuration.yml &amp;amp;&amp;amp; chmod -R 777 /config-tmp-dir&amp;#39;]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 同時掛載兩個空間(一個有redmine要得檔案, 另外一個有可自由讀寫的空間)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumeMounts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-config-vol
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: /tmp/configuration.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> subPath: configuration.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-config-tmp-dir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: /config-tmp-dir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> containers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> image: redmine:4.1.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> env:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: REDMINE_DB_POSTGRES
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> value: redmine-postgres-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: REDMINE_DB_USER
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> value: postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: REDMINE_DB_PASSWORD
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> value: P@55w.rd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: REDMINE_DB_DATABASE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> value: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # default password admin/admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumeMounts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-config-tmp-dir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: /usr/src/redmine/config/configuration.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> subPath: configuration.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-files-dir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: /usr/src/redmine/files
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-plugins
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: /usr/src/redmine/plugins
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-themes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mountPath: /usr/src/redmine/public/themes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ports:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - containerPort: 3000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: ui
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 向k8s取得redmine的yaml檔案
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> volumes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-config-vol
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> configMap:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: redmine-config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> items:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - key: configuration.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> path: configuration.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # 暫存給redmine與初始化需要的儲存空間(會隨刪除消失)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-config-tmp-dir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> emptyDir: {}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-files-dir
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> path: /nfs01/redmine/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server: 192.168.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-themes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> path: /nfs01/redmine/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server: 192.168.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: redmine-plugins
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> path: /nfs01/redmine/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> server: 192.168.1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>redmine的yaml檔-service (NodePort)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion ~]$ cat redmine-svc.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: redmine-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type: NodePort
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> selector:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ports:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: ui
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> protocol: TCP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> port: 3000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nodePort: 32748
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ----------------- ClusterIP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: redmine-service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labels:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type: ClusterIP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> selector:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app: redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> externalIPs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 172.16.90.213
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ports:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: ui
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> protocol: TCP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> port: 80
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> targetPort: 3000
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>部署redmine&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ kubectl apply -f redmine-config.yaml -f redmine-deploy.yaml -f redmine-svc.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configmap/redmine-config created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/redmine created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/redmine-service created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion redmine]$ kubectl get all -n redmine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/redmine-54b45b447c-89rm4 1/1 Running 0 51s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/redmine-postgres-deployment-6f6f66f9cd-6ngtz 1/1 Running 0 86s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/redmine-postgres-service NodePort 172.19.202.4 &amp;lt;none&amp;gt; 5432:31432/TCP 172m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/redmine-service NodePort 172.19.220.153 &amp;lt;none&amp;gt; 3000:32748/TCP 51s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY UP-TO-DATE AVAILABLE AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/redmine 1/1 1 1 52s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/redmine-postgres-deployment 1/1 1 1 172m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME DESIRED CURRENT READY AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">replicaset.apps/redmine-54b45b447c 1 1 1 52s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">replicaset.apps/redmine-postgres-deployment-6f6f66f9cd 1 1 1 172m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>預設帳密 admin/admin , 服務皆走node port , 確認連線OK
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113132436022.png" alt="image-20230113132436022" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="enable-advance-k8s">Enable Advance k8s
&lt;/h4>&lt;p>&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_5:top-install-advanced-t.html" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Engine-v2_5:top-install-advanced-t.html&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>登入Prism Central的VM&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">wangken@wangken-MAC ~ % ssh nutanix@172.16.90.219
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Prism Central VM
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@172.16.90.219&amp;#39;s password:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>karbonctl 登入PC&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~$ cd karbon/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ ll
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">total 66020
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rwxr-x---. 1 nutanix nutanix 53464168 Oct 14 11:04 karbonctl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-------. 1 nutanix nutanix 14136153 Jan 11 00:56 kps-cloud-deployer-pc.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix@NTNX-172-16-90-219-A-PCVM:~/karbon$ ./karbonctl login --pc-username admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Please enter the password for the PC user: admin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Login successful
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>Enable Advance K8s Management &amp;ndash; airgap mode 不能啟用&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">NTNX&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">172&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">90&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">219&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">PCVM&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">~/&lt;/span>&lt;span class="n">karbon&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="o">./&lt;/span>&lt;span class="n">karbonctl&lt;/span> &lt;span class="n">karbon&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">management&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">cluster&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="n">nke&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Advanced&lt;/span> &lt;span class="n">Kubernetes&lt;/span> &lt;span class="n">Managment&lt;/span> &lt;span class="n">can&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">be&lt;/span> &lt;span class="n">enabled&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">airgap&lt;/span> &lt;span class="n">mode&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">panic&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">runtime&lt;/span> &lt;span class="n">error&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">invalid&lt;/span> &lt;span class="n">memory&lt;/span> &lt;span class="n">address&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">nil&lt;/span> &lt;span class="n">pointer&lt;/span> &lt;span class="n">dereference&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="k">signal&lt;/span> &lt;span class="n">SIGSEGV&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">segmentation&lt;/span> &lt;span class="n">violation&lt;/span> &lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mh">0x1&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mh">0x68&lt;/span> &lt;span class="n">pc&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mh">0x155813e&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">goroutine&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">running&lt;/span>&lt;span class="p">]:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">executeK8sRESTAPI&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="mh">0x1b93ae8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0xc00013f1c0&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x0&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x190b901&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x5&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0xc000148200&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0xc000523510&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0xc000356880&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x28bff08&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">...&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbonmgmt_enable&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">140&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x5e&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">actionKarbonMgmtYaml&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="mh">0x1b93ae8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0xc00013f1c0&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x0&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0xc0003ec0c0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x0&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x28bff08&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x0&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbonmgmt&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">213&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x191&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">processKarbonMgmtYaml&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="mh">0x1b93ae8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0xc00013f1c0&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x190e83e&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x16eeb40&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="mh">0x1b29ac0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x32&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x2b&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0xc0004dcea0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">...&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbonmgmt_enable&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">483&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x165&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">glob&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="n">func64&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x286ba80&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0xc00013d060&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x2&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">karbonmgmt_enable&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">426&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x1c5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">spf13&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cobra&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">Command&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">execute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x286ba80&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="mh">0xc00013d040&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mh">0x2&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vendor&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">spf13&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cobra&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">860&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x5f8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">spf13&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cobra&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">Command&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ExecuteC&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mh">0x2870580&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vendor&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">spf13&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cobra&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">974&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x3bc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">spf13&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cobra&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">Command&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Execute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">vendor&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">spf13&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cobra&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">command&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">902&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Execute&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cmd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">root&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">44&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x25&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">main&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">/&lt;/span>&lt;span class="n">home&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">circleci&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">core&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">acs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">karbonctl&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">main&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">go&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">19&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="mh">0x17&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol>
&lt;h4 id="rancher-install">Rancher install
&lt;/h4>&lt;ol>
&lt;li>
&lt;p>下載安裝cert-manager&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">wget&lt;/span> &lt;span class="n">https&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">//&lt;/span>&lt;span class="n">github&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">com&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">jetstack&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">releases&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">download&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">v1&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">0.4&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">create&lt;/span> &lt;span class="n">ns&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">apply&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">pods&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">NAME&lt;/span> &lt;span class="n">READY&lt;/span> &lt;span class="n">STATUS&lt;/span> &lt;span class="n">RESTARTS&lt;/span> &lt;span class="n">AGE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">7455&lt;/span>&lt;span class="n">bdc9bd&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">jxjrs&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">109&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">cainjector&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">bcbb87487&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">j27cl&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Error&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">60&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ago&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="mi">109&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">webhook&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">55&lt;/span>&lt;span class="n">b97fbb44&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="n">xbsd&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="n">Running&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="mi">109&lt;/span>&lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">複製檔案過來&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">ll&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total&lt;/span> &lt;span class="mi">3324&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--.&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">ken&lt;/span> &lt;span class="n">ken&lt;/span> &lt;span class="mi">1679688&lt;/span> &lt;span class="n">Jan&lt;/span> &lt;span class="mi">16&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">44&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crds&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--.&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">ken&lt;/span> &lt;span class="n">ken&lt;/span> &lt;span class="mi">1701573&lt;/span> &lt;span class="n">Dec&lt;/span> &lt;span class="mi">8&lt;/span> &lt;span class="mi">2021&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--.&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="n">ken&lt;/span> &lt;span class="n">ken&lt;/span> &lt;span class="mi">262&lt;/span> &lt;span class="n">Jan&lt;/span> &lt;span class="mi">16&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">44&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">rancher&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">kubectl&lt;/span> &lt;span class="n">apply&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">validate&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">false&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">f&lt;/span> &lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">crds&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">yaml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificaterequests&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">configured&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">certificates&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">configured&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">challenges&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">configured&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">clusterissuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">configured&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">issuers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">configured&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">customresourcedefinition&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apiextensions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">k8s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">orders&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">acme&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">cert&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">manager&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">io&lt;/span> &lt;span class="n">configured&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>安裝rancher&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion rancher]$ kubectl create namespace cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">namespace/cattle-system created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion rancher]$ kubectl apply -f rancher-service.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/rancher-service created
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">### helm install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion rancher]$ wget https://get.helm.sh/helm-v3.11.0-rc.2-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion rancher]$ tar xvf helm-v3.10.3-linux-amd64.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/helm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/LICENSE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">linux-amd64/README.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion linux-amd64]$ sudo cp helm /usr/local/bin/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[sudo] password for ken:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion linux-amd64]$ helm version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: Kubernetes configuration file is group-readable. This is insecure. Location: /home/ken/nke.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WARNING: Kubernetes configuration file is world-readable. This is insecure. Location: /home/ken/nke.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">version.BuildInfo{Version:&amp;#34;v3.10.3&amp;#34;, GitCommit:&amp;#34;835b7334cfe2e5e27870ab3ed4135f136eecc704&amp;#34;, GitTreeState:&amp;#34;clean&amp;#34;, GoVersion:&amp;#34;go1.18.9&amp;#34;}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">##rancher install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion rancher]$ helm repo add rancher-stable https://releases.rancher.com/server-charts/stable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion rancher]$ helm install rancher rancher-stable/rancher --namespace cattle-system --set hostname=rancher.netfos.ken.lab --set replicas=1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion rancher]$ kubectl get all -n cattle-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY STATUS RESTARTS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/helm-operation-9bhx6 0/2 Completed 0 72s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/helm-operation-h7rnz 0/2 Completed 0 25s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/helm-operation-j8wx2 0/2 Completed 0 6s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pod/rancher-687bc6596d-xf4pw 1/1 Running 0 2m38s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/rancher ClusterIP 172.19.196.248 &amp;lt;none&amp;gt; 80/TCP,443/TCP 2m39s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">service/rancher-service NodePort 172.19.29.29 &amp;lt;none&amp;gt; 443:31443/TCP 36m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME READY UP-TO-DATE AVAILABLE AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">deployment.apps/rancher 1/1 1 1 2m39s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME DESIRED CURRENT READY AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">replicaset.apps/rancher-687bc6596d 1 1 1 2m39s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>browser to https://192.168.1.15:31443
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230116102459000.png"
loading="lazy"
alt="image-20230116102459000"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>改密碼
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230116102741258.png" alt="image-20230116102741258" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>即可透過Rancher來查看叢集Status
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230116102900002.png"
loading="lazy"
alt="image-20230116102900002"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230116103502845.png"
loading="lazy"
alt="image-20230116103502845"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="files">FIles
&lt;/h2>&lt;p>&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:fil-file-server-create-wc-t.html#ntask_dgl_l3j_j5" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:fil-file-server-create-wc-t.html#ntask_dgl_l3j_j5&lt;/a>
&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:Files-v4_2" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:Files-v4_2&lt;/a>&lt;/p>
&lt;ul>
&lt;li>
&lt;p>安裝設定AD (optional 如要使用SMB就需有AD)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Domain: netfos.ken.lab&lt;/p>
&lt;/li>
&lt;li>
&lt;p>分為Storage Network (172.16.90.0)、Client Network (192.168.1.0)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Client Network不能與CVM同網段&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Virtual IP用在Storage Network, Client 的IP, FSVM會自動HA&lt;/p>
&lt;/li>
&lt;li>
&lt;p>先用LCM將File升級到最新&lt;/p>
&lt;/li>
&lt;li>
&lt;p>網路Port圖
&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Port-Reference:Files_port_auto_r.html" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Port-Reference:Files_port_auto_r.html&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="架構">架構
&lt;/h4>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/fs-file-server-network-relationship.png" alt="img" style="zoom:50%;" />
&lt;h4 id="安裝ad">安裝AD
&lt;/h4>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112103131877.png" alt="image-20230112103131877" style="zoom:50%;" />
&lt;h4 id="安裝file-server-on-pe">安裝File Server on PE
&lt;/h4>&lt;p>&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:fil-file-server-create-wc-t.html#ntask_dgl_l3j_j5" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:fil-file-server-create-wc-t.html#ntask_dgl_l3j_j5&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>在PE的 File Server ADD,先確認有達到最低需求
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112104219863.png" alt="image-20230112104219863" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>設定FQDN、大小&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112104042391.png"
loading="lazy"
alt="image-20230112104042391"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>設定Client Network (192.168.1.0 要與CVM的網段不同)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112105256290.png" alt="image-20230112105256290" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>設定DNS&amp;amp;NTP&lt;/p>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112105434906.png" alt="image-20230112105434906" style="zoom:50%;" />
&lt;/li>
&lt;li>
&lt;p>設定Storage Network (172.16.90.206-209)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112105545032.png" alt="image-20230112105545032" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>設定目錄服務 SMB、NFS (SMB要AD)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112104942496.png" alt="image-20230112104942496" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Summary &amp;amp; Protection Domain (Snapshot)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112105055627.png" alt="image-20230112105055627" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>去PE的Setting查看fs被分配到什麼IP (192.168.1.26,81,97)&lt;/p>
&lt;p>並在DNS上註記 &amp;ndash; 使用auto update&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113151039168.png"
loading="lazy"
alt="image-20230113151039168"
>&lt;/p>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112105750255.png" alt="image-20230112105750255" style="zoom:50%;" />
&lt;/li>
&lt;li>
&lt;p>查看Takss
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112110132893.png"
loading="lazy"
alt="image-20230112110132893"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>安裝完畢
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112111921165.png"
loading="lazy"
alt="image-20230112111921165"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>可以點選console來查看File Server的狀態
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112112012184.png"
loading="lazy"
alt="image-20230112112012184"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>有出現無法連到AD 需查找問題&amp;ndash; 將兩台DNS Server的註記都設定上去後即正常
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112112151953.png"
loading="lazy"
alt="image-20230112112151953"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>新增Share資料夾 (SMB)
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112112521953.png" alt="image-20230112112521953" style="zoom:50%;" />&lt;/p>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112112613066.png" alt="image-20230112112613066" style="zoom:50%;" />
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112112657224.png"
loading="lazy"
alt="image-20230112112657224"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>測試連線,點進去file-test即可看到mount path
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112112723327.png"
loading="lazy"
alt="image-20230112112723327"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在一台Windows上連線測試 ( 走的是192.168.1.0網段 )&lt;/p>
&lt;p>測試資料夾有出現，但要開權限&lt;/p>
&lt;p>&lt;a class="link" href="https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:fil-fs-rbac-workflow-c.html![image-20230112112909758]%28https://kenkenny.synology.me:5543/images/2023/09/image-20230112112909758.png%29" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/details?targetId=Files-v4_2:fil-fs-rbac-workflow-c.html![image-20230112112909758](https://kenkenny.synology.me:5543/images/2023/09/image-20230112112909758.png)&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>查詢
&lt;a class="link" href="https://portal.nutanix.com/page/documents/kbs/details?targetId=kA032000000TWZMCA4" target="_blank" rel="noopener"
>https://portal.nutanix.com/page/documents/kbs/details?targetId=kA032000000TWZMCA4&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">nutanix@NTNX-22SH6M380125-C-CVM:172.16.90.213:~$ ncli fs ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Uuid : dcb7f7d3-1beb-423e-92d8-0004978542c8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Name : fs01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> DNS Domain Name : netfos.ken.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Version : 4.2.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Container ID : 0005f1d0-ce0d-147b-16c3-7cc25505da5a::169299
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Container Uuid : 5d3fd980-8192-4a8c-ab18-5fb605f58bae
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual IP address : 172.16.90.206
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> DNS Server IP Addresses : 192.168.1.1, 192.168.1.100
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> NTP Servers : clock.stdtime.gov.tw, tick.stdtime.gov.tw, time.stdtime.gov.tw, tock.stdtime.gov.tw, watch.stdtime.gov.tw
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File server PD name : NTNX-fs01
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File server PD status : Active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File server status : Active
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AD Domain Name : netfos.ken.lab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AD Username : administrator
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Preferred Domain Contr... : true
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Overwrite User Account : false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> AD Protocol Type : SMB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Local Protocol Type : NFS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nfs version : NFSV3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Total Snapshot Space Used : 0 bytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Total Space Used : 808 KiB (827,392 bytes)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Total Space Available : 1024 GiB (1,099,510,800,384 bytes)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Total SMB Connections : 1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Storage User Capacity : 23.31 TiB (25,633,686,087,723 bytes)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Size : 1 TiB (1,099,511,627,776 bytes)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Data savings : 0 bytes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Data reduction ratio : 1:1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Controller Num IOPs : 100
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Controller IO Bandwidth : 751
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Controller Avg IO Latency : 867
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Network UUID : c5b9824f-4fba-4c01-9fb2-d02a88daf933
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Default Gateway : 172.16.90.254
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Subnet Mask : 255.255.255.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Network Type : Internal
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> IP Pool : 172.16.90.206 - 172.16.90.209
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Network UUID : ac09299f-322e-4750-9183-6d106be2a0df
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Default Gateway : 192.168.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Subnet Mask : 255.255.255.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Network Type : External
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm UUID : 5a7aef2d-2052-4a6b-935a-bfa46b493b98
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm ID : 0005f1d0-ce0d-147b-16c3-7cc25505da5a::0749859d-c8d7-4199-876f-92ee9215ba26
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm Name : NTNX-fs01-3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Memory In GiB : 12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual CPUs : 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm IP Addresses : 192.168.1.26, 172.16.90.209
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm UUID : 275adefc-0e3f-4f26-8680-9dd7ff7223b4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm ID : 0005f1d0-ce0d-147b-16c3-7cc25505da5a::a0a930a7-cafd-4dd3-b4f9-559a48a6db00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm Name : NTNX-fs01-1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Memory In GiB : 12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual CPUs : 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm IP Addresses : 192.168.1.97, 172.16.90.207
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm UUID : 3eec8305-8d7c-41ec-804d-9f217b41669c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm ID : 0005f1d0-ce0d-147b-16c3-7cc25505da5a::d3b41d19-1bf1-4c4b-8ece-e09d2b9dac2d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm Name : NTNX-fs01-2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Memory In GiB : 12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Virtual CPUs : 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Nvm IP Addresses : 192.168.1.81, 172.16.90.208
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>最後問題點是FQDN帶了多個IP出來，直接用IP就可以連線&lt;/p>
&lt;p>並且資料會同步到其他FSVM上
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112145143605.png"
loading="lazy"
alt="image-20230112145143605"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112153035796.png"
loading="lazy"
alt="image-20230112153035796"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>可以針對檔案副檔名封鎖存取&lt;/p>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112145238291.png" alt="image-20230112145238291" style="zoom:50%;" />
&lt;/li>
&lt;li>
&lt;p>Dashboard查看目前Share Folder的狀態&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112145309865.png"
loading="lazy"
alt="image-20230112145309865"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>測試NFS,新增NFS Share&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112150448407.png"
loading="lazy"
alt="image-20230112150448407"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在Linux上安裝nfs-utils後mount測試&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">yum&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">utils&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">mount&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">t&lt;/span> &lt;span class="n">nfs&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.26&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs01&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">remote&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">fs&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rpc&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">statd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rpc&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">statd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">mount&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">access&lt;/span> &lt;span class="n">denied&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="n">mounting&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.26&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs01&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>出現 Access Denied 需要調整權限,Authentication調整為none,mount時要加sec=none
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112150700831.png" alt="image-20230112150700831" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>測試連線&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">mount&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">t&lt;/span> &lt;span class="n">nfs&lt;/span> &lt;span class="mf">192.168&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="mf">1.26&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs01&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">o&lt;/span> &lt;span class="n">sec&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">none&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">cd&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="k">var&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">mkdir&lt;/span> &lt;span class="n">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">touch&lt;/span> &lt;span class="mi">123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">touch&lt;/span> &lt;span class="mf">321.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">ken&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">bastion&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">ll&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">total&lt;/span> &lt;span class="mi">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--.&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="mi">4294967294&lt;/span> &lt;span class="mi">4294967294&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="n">Jan&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="mi">2023&lt;/span> &lt;span class="mi">123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span>&lt;span class="n">rw&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="n">r&lt;/span>&lt;span class="o">--.&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="mi">4294967294&lt;/span> &lt;span class="mi">4294967294&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="n">Jan&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="mi">2023&lt;/span> &lt;span class="mf">321.&lt;/span>&lt;span class="n">txt&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">drwxr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">xr&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="mi">4294967294&lt;/span> &lt;span class="mi">4294967294&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="n">Jan&lt;/span> &lt;span class="mi">12&lt;/span> &lt;span class="mi">15&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="n">test&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>測試阻擋副檔名*.txt
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112151230300.png" alt="image-20230112151230300" style="zoom:50%;" />&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[ken@bastion nfs]$ touch 333.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">touch: cannot touch &amp;#39;333.txt&amp;#39;: Permission denied
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion nfs]$ rm 321.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm: cannot remove &amp;#39;321.txt&amp;#39;: Operation not permitted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[ken@bastion nfs]$ rm 123
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm: cannot remove &amp;#39;123&amp;#39;: Operation not permitted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>若新增時選擇的是Use &amp;ldquo;Distributed&amp;rdquo; share type instead of &amp;ldquo;Standard&amp;rdquo;&lt;/p>
&lt;p>提示要安裝MMC Plugin&lt;/p>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112152924185.png" alt="image-20230112152924185" style="zoom:50%;" />
&lt;/li>
&lt;li>
&lt;p>可以連線至該資料夾，但無法新增檔案
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230112153247015.png" alt="image-20230112153247015" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>可以新增資料夾並在子資料夾內可新增檔案&lt;/p>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113141034500.png" alt="image-20230113141034500" style="zoom:50%;" />
&lt;/li>
&lt;li>
&lt;p>Standard vs Distributed&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Standard: 一般的Share Folder,實測資料都會同步到其他FSVM上,第一層資料夾即可開始使用。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Distributed: 多用來當作家目錄資料夾底下會放多個使用者的資料夾，可以有比較好的效能跟分流作用。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113140218786.png"
loading="lazy"
>&lt;/p>
&lt;h5 id="distributed">Distributed
&lt;/h5>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/share-export-distributed.png"
loading="lazy"
alt="Shares, in this example \profile, distributed across FSVMs."
>&lt;/p>
&lt;h5 id="standard">Standard
&lt;/h5>&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/share-export-standard.png"
loading="lazy"
alt="Shares, in this example \finance, \hr, and \eng, are not distributed across FSVMs."
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="file-ha">File HA
&lt;/h4>&lt;ol>
&lt;li>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Fail&lt;/span> &lt;span class="n">over&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">VMs&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">FSVMs&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">High&lt;/span> &lt;span class="n">Availability&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">HA&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">Files&lt;/span> &lt;span class="n">insures&lt;/span> &lt;span class="n">that&lt;/span> &lt;span class="n">during&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">disruption&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">service&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">file&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="n">VM&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">FSVM&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">clusters&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">two&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">more&lt;/span> &lt;span class="n">FSVMs&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">can&lt;/span> &lt;span class="n">fail&lt;/span> &lt;span class="n">over&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">another&lt;/span> &lt;span class="n">FSVM&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">High&lt;/span> &lt;span class="n">Availability&lt;/span> &lt;span class="n">is&lt;/span> &lt;span class="n">enabled&lt;/span> &lt;span class="n">by&lt;/span> &lt;span class="n">default&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">all&lt;/span> &lt;span class="n">clusters&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">two&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">more&lt;/span> &lt;span class="n">FSVMs&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">When&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">FSVM&lt;/span> &lt;span class="n">experiences&lt;/span> &lt;span class="n">an&lt;/span> &lt;span class="n">issue&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">Files&lt;/span> &lt;span class="n">reassigns&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="ne">IP&lt;/span> &lt;span class="n">address&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">FSVM&lt;/span> &lt;span class="n">to&lt;/span> &lt;span class="n">another&lt;/span> &lt;span class="n">FSVM&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">cluster&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">The&lt;/span> &lt;span class="ne">IP&lt;/span> &lt;span class="n">address&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">out&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">of&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="n">FSVM&lt;/span> &lt;span class="n">remains&lt;/span> &lt;span class="n">available&lt;/span>&lt;span class="o">.&lt;/span> &lt;span class="n">However&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">shares&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">exports&lt;/span> &lt;span class="n">on&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">impacted&lt;/span> &lt;span class="n">FSVM&lt;/span> &lt;span class="n">are&lt;/span> &lt;span class="n">unavailable&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">several&lt;/span> &lt;span class="n">minutes&lt;/span> &lt;span class="n">during&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">failover&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Affinity&lt;/span> &lt;span class="n">rules&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">affect&lt;/span> &lt;span class="n">HA&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">multiple&lt;/span> &lt;span class="n">FSVMs&lt;/span> &lt;span class="n">can&lt;/span> &lt;span class="n">share&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">single&lt;/span> &lt;span class="n">host&lt;/span> &lt;span class="n">during&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="n">HA&lt;/span> &lt;span class="n">event&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>情境模擬,目前DNS設定
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113152719949.png" alt="image-20230113152719949" style="zoom:50%;" />&lt;/p>
&lt;/li>
&lt;li>
&lt;p>資料夾連線狀態,兩邊都可以新增檔案
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113152849603.png"
loading="lazy"
alt="image-20230113152849603"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>將ntnx-fs01-1關機
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113153317896.png"
loading="lazy"
alt="image-20230113153317896"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>同樣路徑下還是可以進行檔案編輯、新增
192.168.1.97 還是ping得通。&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113153249886.png"
loading="lazy"
alt="image-20230113153249886"
>&lt;/p>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230113153717326.png" alt="image-20230113153717326" style="zoom:50%;" />
&lt;/li>
&lt;/ol>
&lt;h4 id="csi">CSI
&lt;/h4>&lt;p>&lt;a class="link" href="https://github.com/nutanix/csi-plugin/blob/master/README.md" target="_blank" rel="noopener"
>https://github.com/nutanix/csi-plugin/blob/master/README.md&lt;/a>&lt;/p>
&lt;p>分為Volume 跟Files
Files 分為專用的Share以及Dynamic NFS
先確認worker node 有啟動nfs-server服務&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-gdscript3" data-lang="gdscript3">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab01&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">workerVm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">enable&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span> &lt;span class="o">--&lt;/span>&lt;span class="n">now&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Created&lt;/span> &lt;span class="n">symlink&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">etc&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">multi&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">wants&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="err">→&lt;/span> &lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="n">nutanix&lt;/span>&lt;span class="err">@&lt;/span>&lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab01&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">workerVm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">$&lt;/span> &lt;span class="n">sudo&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">status&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">●&lt;/span> &lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">NFS&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">services&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Loaded&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">loaded&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">lib&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">systemd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">system&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">nfs&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">server&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">service&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">enabled&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">vendor&lt;/span> &lt;span class="n">preset&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">disabled&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Active&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">active&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">since&lt;/span> &lt;span class="n">Fri&lt;/span> &lt;span class="mi">2023&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">07&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">14&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="n">UTC&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="mi">12&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">ago&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Process&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">46413&lt;/span> &lt;span class="n">ExecStart&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">bin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sh&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">c&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">q&lt;/span> &lt;span class="n">is&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">active&lt;/span> &lt;span class="n">gssproxy&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">then&lt;/span> &lt;span class="n">systemctl&lt;/span> &lt;span class="n">reload&lt;/span> &lt;span class="n">gssproxy&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">fi&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SUCCESS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Process&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">46400&lt;/span> &lt;span class="n">ExecStart&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">rpc&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">nfsd&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SUCCESS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Process&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">46398&lt;/span> &lt;span class="n">ExecStartPre&lt;/span>&lt;span class="o">=/&lt;/span>&lt;span class="n">usr&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">sbin&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">exportfs&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="n">r&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SUCCESS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Main&lt;/span> &lt;span class="n">PID&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">46413&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">exited&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">status&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">SUCCESS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">7&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">14&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab01&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">workerVm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">systemd&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="n">Starting&lt;/span> &lt;span class="n">NFS&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">services&lt;/span>&lt;span class="o">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="mi">7&lt;/span>&lt;span class="err">月&lt;/span> &lt;span class="mi">14&lt;/span> &lt;span class="mi">09&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">00&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">lab01&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">anthos&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">workerVm&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">0&lt;/span> &lt;span class="n">systemd&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="n">Started&lt;/span> &lt;span class="n">NFS&lt;/span> &lt;span class="n">server&lt;/span> &lt;span class="ow">and&lt;/span> &lt;span class="n">services&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="files-dynamic">Files Dynamic
&lt;/h5>&lt;p>Prism 上有建立Files Server即可使用，不用新增Share&lt;/p>
&lt;ol>
&lt;li>
&lt;p>建立Secret&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ cat ntnx-secret74.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Secret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: ntnx-secret74
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: ntnx-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">data:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # base64 encoded prism-ip:prism-port:admin:password.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # E.g.: echo -n &amp;#34;172.16.90.74:9440:admin:mypassword&amp;#34; | base64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> key: MTcyLjE2LjkwLjc0Ojk0NDA6YWRtaW46TnV0YW5peC9MYWIxMjM=
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>建立Dynamic NFS Storageclass&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ cat ntnx-secret74.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: Secret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: ntnx-secret74
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> namespace: ntnx-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">data:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # base64 encoded prism-ip:prism-port:admin:password.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> # E.g.: echo -n &amp;#34;10.6.47.155:9440:admin:mypassword&amp;#34; | base64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> key: MTcyLjE2LjkwLjc0Ojk0NDA6YWRtaW46TnV0YW5peC9MYWIxMjM=
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ cat dyn-files.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: StorageClass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: storage.k8s.io/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: ntnx-files
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">provisioner: csi.nutanix.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">parameters:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dynamicProv: ENABLED
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfsServerName: Files
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> csi.storage.k8s.io/provisioner-secret-name: ntnx-secret74
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> csi.storage.k8s.io/provisioner-secret-namespace: ntnx-system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storageType: NutanixFiles
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>建立測試pvc&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ cat test-claim.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: PersistentVolumeClaim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: claim2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spec:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> accessModes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - ReadWriteMany
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> resources:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> requests:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storage: 10Gi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storageClassName: ntnx-files
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>驗證OK&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ kubectl get pvc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME STATUS VOLUME CAPACITY ACCESS MODES STORAGECLASS AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">claim2 Bound pvc-a338991c-13f8-4c2f-811b-10911f543e97 10Gi RWX ntnx-files 93m
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>實際Prism 畫面
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/dyn-files.png"
loading="lazy"
alt="image-20230714135126573"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Anthos 畫面
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230714135206479.png"
loading="lazy"
alt="image-20230714135206479"
>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h5 id="files-share">Files Share
&lt;/h5>&lt;ol>
&lt;li>
&lt;p>Prism 建立Files Share
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230714140331520.png"
loading="lazy"
alt="image-20230714140331520"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230714140358134.png"
loading="lazy"
alt="image-20230714140358134"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230714140415066.png"
loading="lazy"
alt="image-20230714140415066"
>&lt;/p>
&lt;p>&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230714140434787.png"
loading="lazy"
alt="image-20230714140434787"
>
&lt;img src="https://kenkenny.synology.me:5543/images/2023/09/image-20230714140451932.png"
loading="lazy"
alt="image-20230714140451932"
>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>建立Storageclass 針對anthos 這個share&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ cat ntnx-files.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kind: StorageClass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apiVersion: storage.k8s.io/v1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">metadata:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: ntnx-files-anthos
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> annotations:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storageclass.kubernetes.io/is-default-class: &amp;#34;false&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">provisioner: csi.nutanix.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">parameters:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfsServer: Files.nutanixlab.local
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nfsPath: anthos
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> storageType: NutanixFiles
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reclaimPolicy: Delete
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>確認Storageclass &amp;ldquo;ntnx-files-anthos&amp;rdquo;&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ kubectl get storageclass
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME PROVISIONER RECLAIMPOLICY VOLUMEBINDINGMODE ALLOWVOLUMEEXPANSION AGE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">anthos-system kubernetes.io/no-provisioner Delete WaitForFirstConsumer false 29d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">local-disks kubernetes.io/no-provisioner Delete WaitForFirstConsumer false 29d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">local-shared kubernetes.io/no-provisioner Delete WaitForFirstConsumer false 29d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ntnx-files csi.nutanix.com Delete Immediate false 108m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ntnx-files-anthos csi.nutanix.com Delete Immediate false 6s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nutanix-volume (default) csi.nutanix.com Delete Immediate true 29d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[nutanix@anthos-lab01-anthos-adminVm-0 ~]$ kubectl describe storageclass ntnx-files-anthos
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name: ntnx-files-anthos
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">IsDefaultClass: No
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Annotations: storageclass.kubernetes.io/is-default-class=false
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Provisioner: csi.nutanix.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Parameters: nfsPath=anthos,nfsServer=Files.nutanixlab.local,storageType=NutanixFiles
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">AllowVolumeExpansion: &amp;lt;unset&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MountOptions: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ReclaimPolicy: Delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">VolumeBindingMode: Immediate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Events: &amp;lt;none&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ol></description></item></channel></rss>