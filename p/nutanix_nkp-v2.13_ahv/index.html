<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Nutanix_NKP-v2.13_AHV"><title>Nutanix_NKP-v2.13_AHV</title>
<link rel=canonical href=https://wangken0129.github.io/p/nutanix_nkp-v2.13_ahv/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Nutanix_NKP-v2.13_AHV"><meta property='og:description' content="Nutanix_NKP-v2.13_AHV"><meta property='og:url' content='https://wangken0129.github.io/p/nutanix_nkp-v2.13_ahv/'><meta property='og:site_name' content="Ken's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Nutanix'><meta property='article:tag' content='NKP'><meta property='article:tag' content='Kubernetes'><meta property='article:published_time' content='2025-03-07T05:53:22+08:00'><meta property='article:modified_time' content='2025-03-07T05:53:22+08:00'><meta name=twitter:title content="Nutanix_NKP-v2.13_AHV"><meta name=twitter:description content="Nutanix_NKP-v2.13_AHV"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切換選單>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c68a00bbf16dac8.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🇹🇼</span></figure><div class=site-meta><h1 class=site-name><a href=/>Ken's blog</a></h1><h2 class=site-description>紀錄與分享，當個快樂的工程師</h2></div></header><ol class=menu-social><li><a href=https://github.com/wangken0129/wangken0129.github.io target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/ken-wang-88924b181/ target=_blank title=LinkedIn rel=me><svg class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4m0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2z"/><path d="M8 11v5"/><path d="M8 8v.01"/><path d="M12 16v-5"/><path d="M16 16v-3a2 2 0 00-4 0"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>夜晚模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目錄</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#環境資訊>環境資訊</a><ol><li><a href=#版本>版本</a></li><li><a href=#ip-與名稱>IP 與名稱</a></li></ol></li><li><a href=#bastion>Bastion</a><ol><li><a href=#軟體下載>軟體下載</a></li><li><a href=#軟體安裝>軟體安裝</a></li><li><a href=#基本設定>基本設定</a></li><li><a href=#registry>Registry</a><ol><li><a href=#啟動-registry>啟動 Registry</a></li><li><a href=#推送-nkp-image>推送 NKP Image</a></li><li><a href=#load-image>load image</a></li></ol></li></ol></li><li><a href=#create-cluster>Create Cluster</a><ol><li><a href=#bootstrap-cluster>Bootstrap Cluster</a></li><li><a href=#machine-image-if-required>Machine Image (if required)</a></li><li><a href=#management-cluster>Management Cluster</a><ol><li><a href=#env-設定環境變數>Env 設定環境變數</a></li><li><a href=#create--cluster>Create Cluster</a></li><li><a href=#delete-bootstrap>Delete bootstrap</a></li><li><a href=#取得-dashboard>取得 Dashboard</a></li><li><a href=#其他叢集資訊>其他叢集資訊</a></li></ol></li></ol></li><li><a href=#upgrade-nkp>Upgrade NKP</a><ol><li><a href=#目前版本>目前版本</a></li><li><a href=#升級前先確認>升級前先確認</a></li><li><a href=#upgrade-path>Upgrade Path</a></li><li><a href=#upgrade-order-nutanix>Upgrade Order (Nutanix)</a></li><li><a href=#upgrade-nkp-pro>Upgrade NKP PRO</a><ol><li><a href=#1--bastion-指令升級及bundle>1. Bastion 指令升級及bundle</a></li><li><a href=#2-下載-airgapped-包>2. 下載 airgapped 包</a></li><li><a href=#3-上傳-image>3. 上傳 Image</a></li><li><a href=#4-製作-os-image>4. 製作 OS Image</a></li><li><a href=#5-升級-kommander>5. 升級 Kommander</a></li><li><a href=#6-升級-cluster>6. 升級 Cluster</a></li></ol></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/lab-category/ style=background-color:#2a9d8f;color:#fff>Lab Category</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/nutanix_nkp-v2.13_ahv/>Nutanix_NKP-v2.13_AHV</a></h2><h3 class=article-subtitle>Nutanix_NKP-v2.13_AHV</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Mar 07, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>閱讀時間: 24 分鐘</time></div></footer></div></header><section class=article-content><h1 id=nutanix-nkp-v2131-install-with-private-registry>Nutanix NKP v2.13.1 Install with private registry</h1><p>NKP 安裝 Lab，安裝在 AHV 環境上 ，透過 cli 方式安裝</p><p>會建立 image registry 來放置 NKP 需要的 image，建置完成後會升級到 2.14</p><h2 id=環境資訊>環境資訊</h2><h3 id=版本>版本</h3><p>Prism Central: 2024.2.0.3</p><p>AOS: 6.5.1.1</p><p>NKP: 2.13.1</p><p>Kubernetes: 1.30.5</p><p>OS Image: ubuntu-22.04</p><p>KIB: v2.18.0</p><h3 id=ip-與名稱>IP 與名稱</h3><p>Prism Central: https://10.38.14.10:9440</p><p>Prism Element (PHX-SPOC014-1): https://10.38.14.7:9440/</p><p>bastion ip : 10.38.14.24</p><p>Storage Container: default</p><p>Subnet: primary</p><p>kubeVIP: 10.38.14.51</p><p>kube Ingress ip Range: 10.38.14.52-10.38.14.54</p><p>Subnet Mask: 255.255.255.192</p><p>Gateway IP Address: 10.38.14.1</p><h2 id=bastion>Bastion</h2><h3 id=軟體下載>軟體下載</h3><p>nkp-airgapped, nkp cli , kib 從 Portal 上直接用 copy link 方式下載</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>curl</span> <span class=o>-</span><span class=n>o</span> <span class=n>nkp</span><span class=o>-</span><span class=n>air</span><span class=o>-</span><span class=n>gapped</span><span class=o>-</span><span class=n>bundle_v2</span><span class=o>.</span><span class=mf>13.1</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=s2>&#34;https://download.nutanix.com/downloads/nkp/v2.13.1/nkp-air-gapped-bundle_v2.13.1_linux_amd64.tar.gz?Expires=1740156924&amp;Key-Pair-xx__&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>%</span> <span class=n>Total</span>    <span class=o>%</span> <span class=n>Received</span> <span class=o>%</span> <span class=n>Xferd</span>  <span class=n>Average</span> <span class=n>Speed</span>   <span class=n>Time</span>    <span class=n>Time</span>     <span class=n>Time</span>  <span class=n>Current</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Dload</span>  <span class=n>Upload</span>   <span class=n>Total</span>   <span class=n>Spent</span>    <span class=n>Left</span>  <span class=n>Speed</span>
</span></span><span class=line><span class=cl><span class=mi>100</span> <span class=mf>14.3</span><span class=n>G</span>  <span class=mi>100</span> <span class=mf>14.3</span><span class=n>G</span>    <span class=mi>0</span>     <span class=mi>0</span>   <span class=mi>317</span><span class=n>M</span>      <span class=mi>0</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>46</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>46</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span>  <span class=mi>289</span><span class=n>M</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>curl</span> <span class=o>-</span><span class=n>o</span> <span class=n>nkp_v2</span><span class=o>.</span><span class=mf>13.1</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=s2>&#34;https://download.nutanix.com/downloads/nkp/v2.13.1/nkp_v2.13.1_linux_amd64.tar.gz?Expires=1740156983&amp;Key-Pair-xx__&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>%</span> <span class=n>Total</span>    <span class=o>%</span> <span class=n>Received</span> <span class=o>%</span> <span class=n>Xferd</span>  <span class=n>Average</span> <span class=n>Speed</span>   <span class=n>Time</span>    <span class=n>Time</span>     <span class=n>Time</span>  <span class=n>Current</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Dload</span>  <span class=n>Upload</span>   <span class=n>Total</span>   <span class=n>Spent</span>    <span class=n>Left</span>  <span class=n>Speed</span>
</span></span><span class=line><span class=cl><span class=mi>100</span> <span class=mf>97.5</span><span class=n>M</span>  <span class=mi>100</span> <span class=mf>97.5</span><span class=n>M</span>    <span class=mi>0</span>     <span class=mi>0</span>  <span class=mf>16.5</span><span class=n>M</span>      <span class=mi>0</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>05</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>05</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span> <span class=mf>17.5</span><span class=n>M</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>curl</span> <span class=o>-</span><span class=n>o</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>18.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=s2>&#34;https://download.nutanix.com/downloads/nkp/v2.13.1/konvoy-image-bundle-v2.18.0_linux_amd64.tar.gz?Expires=1740157007&amp;Key-Pair-xxx__&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>%</span> <span class=n>Total</span>    <span class=o>%</span> <span class=n>Received</span> <span class=o>%</span> <span class=n>Xferd</span>  <span class=n>Average</span> <span class=n>Speed</span>   <span class=n>Time</span>    <span class=n>Time</span>     <span class=n>Time</span>  <span class=n>Current</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Dload</span>  <span class=n>Upload</span>   <span class=n>Total</span>   <span class=n>Spent</span>    <span class=n>Left</span>  <span class=n>Speed</span>
</span></span><span class=line><span class=cl><span class=mi>100</span>  <span class=mi>334</span><span class=n>M</span>  <span class=mi>100</span>  <span class=mi>334</span><span class=n>M</span>    <span class=mi>0</span>     <span class=mi>0</span>  <span class=mf>15.7</span><span class=n>M</span>      <span class=mi>0</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>21</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>21</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span> <span class=mf>15.9</span><span class=n>M</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>ll</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mi>15484132</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span>   <span class=mi>350719341</span> <span class=n>Feb</span> <span class=mi>20</span> <span class=mi>22</span><span class=p>:</span><span class=mi>57</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>18.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span> <span class=mi>15402765171</span> <span class=n>Feb</span> <span class=mi>20</span> <span class=mi>22</span><span class=p>:</span><span class=mi>56</span> <span class=n>nkp</span><span class=o>-</span><span class=n>air</span><span class=o>-</span><span class=n>gapped</span><span class=o>-</span><span class=n>bundle_v2</span><span class=o>.</span><span class=mf>13.1</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span>   <span class=mi>102264118</span> <span class=n>Feb</span> <span class=mi>20</span> <span class=mi>22</span><span class=p>:</span><span class=mi>56</span> <span class=n>nkp_v2</span><span class=o>.</span><span class=mf>13.1</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=軟體安裝>軟體安裝</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>yum</span> <span class=n>install</span> <span class=n>podman</span> <span class=n>yum</span><span class=o>-</span><span class=n>utils</span> <span class=n>bzip2</span> <span class=n>wget</span> <span class=n>tar</span> <span class=o>-</span><span class=n>y</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>yum</span> <span class=n>install</span> <span class=n>git</span><span class=o>-</span><span class=n>all</span> <span class=o>-</span><span class=n>y</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>get</span><span class=o>.</span><span class=n>helm</span><span class=o>.</span><span class=n>sh</span><span class=o>/</span><span class=n>helm</span><span class=o>-</span><span class=n>v3</span><span class=o>.</span><span class=mf>17.1</span><span class=o>-</span><span class=n>linux</span><span class=o>-</span><span class=n>amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>cp</span> <span class=n>linux</span><span class=o>-</span><span class=n>amd64</span><span class=o>/</span><span class=n>helm</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>mkdir</span> <span class=o>-</span><span class=n>p</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>mkdir</span> <span class=o>-</span><span class=n>p</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>kib</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>mkdir</span> <span class=o>-</span><span class=n>p</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>tar</span> <span class=n>xvf</span> <span class=n>nkp_v2</span><span class=o>.</span><span class=mf>13.1</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=o>-</span><span class=n>C</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>tar</span> <span class=n>xvf</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>18.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=o>-</span><span class=n>C</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>kib</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>tar</span> <span class=n>xvf</span> <span class=n>nkp</span><span class=o>-</span><span class=n>air</span><span class=o>-</span><span class=n>gapped</span><span class=o>-</span><span class=n>bundle_v2</span><span class=o>.</span><span class=mf>13.1</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=o>-</span><span class=n>C</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>cp</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkp</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>cp</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>kib</span><span class=o>/</span><span class=n>konvoy</span><span class=o>-</span><span class=n>image</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>cp</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>/</span><span class=n>kubectl</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>nkp</span> <span class=n>version</span>
</span></span><span class=line><span class=cl><span class=n>diagnose</span><span class=p>:</span> <span class=n>v0</span><span class=o>.</span><span class=mf>10.1</span>
</span></span><span class=line><span class=cl><span class=n>imagebuilder</span><span class=p>:</span> <span class=n>v0</span><span class=o>.</span><span class=mf>20.0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span><span class=p>:</span> <span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span>
</span></span><span class=line><span class=cl><span class=n>konvoy</span><span class=p>:</span> <span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span>
</span></span><span class=line><span class=cl><span class=n>mindthegap</span><span class=p>:</span> <span class=n>v1</span><span class=o>.</span><span class=mf>16.0</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=p>:</span> <span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>kubectl</span> <span class=n>version</span>
</span></span><span class=line><span class=cl><span class=n>Client</span> <span class=n>Version</span><span class=p>:</span> <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl><span class=n>Kustomize</span> <span class=n>Version</span><span class=p>:</span> <span class=n>v5</span><span class=o>.</span><span class=mf>0.4</span><span class=o>-</span><span class=mf>0.20230601165947</span><span class=o>-</span><span class=mi>6</span><span class=n>ce0bf390ce3</span>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>connection</span> <span class=n>to</span> <span class=n>the</span> <span class=n>server</span> <span class=n>localhost</span><span class=p>:</span><span class=mi>8080</span> <span class=n>was</span> <span class=n>refused</span> <span class=o>-</span> <span class=n>did</span> <span class=n>you</span> <span class=n>specify</span> <span class=n>the</span> <span class=n>right</span> <span class=n>host</span> <span class=ow>or</span> <span class=n>port</span><span class=err>?</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=基本設定>基本設定</h3><p>disable firewalld, selinux</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[nkp@nkp-bastion ~]$ sudo systemctl disable firewalld --now
</span></span><span class=line><span class=cl>Removed &#34;/etc/systemd/system/multi-user.target.wants/firewalld.service&#34;.
</span></span><span class=line><span class=cl>Removed &#34;/etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service&#34;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[nkp@nkp-bastion ~]$ sudo vi /etc/selinux/config
</span></span><span class=line><span class=cl>SELINUXTYPE=disabled
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>reboot
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[nkp@nkp-bastion ~]$ getenforce
</span></span><span class=line><span class=cl>Disabled
</span></span></code></pre></td></tr></table></div></div><h3 id=registry>Registry</h3><h4 id=啟動-registry>啟動 Registry</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=s2>&#34;switch to root&#34;</span> <span class=p>(</span><span class=err>方便使用，也可以用一般使用者，但要另外設定</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>podman</span> <span class=n>login</span> <span class=n>registry</span><span class=o>-</span><span class=mf>1.</span><span class=n>docker</span><span class=o>.</span><span class=n>io</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;Start registry&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>podman</span> <span class=n>run</span> <span class=o>-</span><span class=n>d</span> <span class=o>-</span><span class=n>p</span> <span class=mi>5000</span><span class=p>:</span><span class=mi>5000</span> <span class=o>--</span><span class=n>restart</span> <span class=n>always</span> <span class=o>--</span><span class=n>name</span> <span class=n>nkp</span><span class=o>-</span><span class=n>registry</span> <span class=n>registry</span><span class=p>:</span><span class=n>latest</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=k>export</span> <span class=n>BOOTSTRAP_HOST_IP</span><span class=o>=</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.24</span> <span class=o>&gt;&gt;</span> <span class=o>.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>echo</span> <span class=s2>&#34;export REGISTRY_URL=http://10.38.14.24:5000&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>source</span> <span class=o>.</span><span class=n>bashrc</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=推送-nkp-image>推送 NKP Image</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=s2>&#34;Push Image&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>push</span> <span class=n>bundle</span> <span class=o>--</span><span class=n>bundle</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>/</span><span class=n>container</span><span class=o>-</span><span class=n>images</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>.</span><span class=n>tar</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>=$</span><span class=n>REGISTRY_URL</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>skip</span><span class=o>-</span><span class=n>tls</span><span class=o>-</span><span class=n>verify</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Creating</span> <span class=n>temporary</span> <span class=n>directory</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Unarchiving</span> <span class=n>image</span> <span class=n>bundle</span> <span class=s2>&#34;/home/nkp/nkptools/nkp-airgap/nkp-v2.13.1/container-images/kommander-image-bundle-v2.13.1.tar&#34;</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Parsing</span> <span class=n>image</span> <span class=n>bundle</span> <span class=n>config</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Starting</span> <span class=n>temporary</span> <span class=n>Docker</span> <span class=n>registry</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Pushing</span> <span class=n>bundled</span> <span class=n>images</span> <span class=p>[</span><span class=o>================================&gt;</span><span class=mi>123</span><span class=o>/</span><span class=mi>123</span><span class=p>]</span> <span class=p>(</span><span class=n>time</span> <span class=n>elapsed</span> <span class=mi>57</span><span class=n>s</span><span class=p>)</span> 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>push</span> <span class=n>bundle</span> <span class=o>--</span><span class=n>bundle</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>/</span><span class=n>container</span><span class=o>-</span><span class=n>images</span><span class=o>/</span><span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>.</span><span class=n>tar</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>=$</span><span class=n>REGISTRY_URL</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>skip</span><span class=o>-</span><span class=n>tls</span><span class=o>-</span><span class=n>verify</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Creating</span> <span class=n>temporary</span> <span class=n>directory</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Unarchiving</span> <span class=n>image</span> <span class=n>bundle</span> <span class=s2>&#34;/home/nkp/nkptools/nkp-airgap/nkp-v2.13.1/container-images/konvoy-image-bundle-v2.13.1.tar&#34;</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Parsing</span> <span class=n>image</span> <span class=n>bundle</span> <span class=n>config</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Starting</span> <span class=n>temporary</span> <span class=n>Docker</span> <span class=n>registry</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Pushing</span> <span class=n>bundled</span> <span class=n>images</span> <span class=p>[</span><span class=o>================================&gt;</span><span class=mi>115</span><span class=o>/</span><span class=mi>115</span><span class=p>]</span> <span class=p>(</span><span class=n>time</span> <span class=n>elapsed</span> <span class=mi>35</span><span class=n>s</span><span class=p>)</span> 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>push</span> <span class=n>bundle</span> <span class=o>--</span><span class=n>bundle</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>/</span><span class=n>container</span><span class=o>-</span><span class=n>images</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>catalog</span><span class=o>-</span><span class=n>applications</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>.</span><span class=n>tar</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>=$</span><span class=n>REGISTRY_URL</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>skip</span><span class=o>-</span><span class=n>tls</span><span class=o>-</span><span class=n>verify</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Creating</span> <span class=n>temporary</span> <span class=n>directory</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Unarchiving</span> <span class=n>image</span> <span class=n>bundle</span> <span class=s2>&#34;/home/nkp/nkptools/nkp-airgap/nkp-v2.13.1/container-images/nkp-catalog-applications-image-bundle-v2.13.1.tar&#34;</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Parsing</span> <span class=n>image</span> <span class=n>bundle</span> <span class=n>config</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Starting</span> <span class=n>temporary</span> <span class=n>Docker</span> <span class=n>registry</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Pushing</span> <span class=n>bundled</span> <span class=n>images</span> <span class=p>[</span><span class=o>====================================&gt;</span><span class=mi>8</span><span class=o>/</span><span class=mi>8</span><span class=p>]</span> <span class=p>(</span><span class=n>time</span> <span class=n>elapsed</span> <span class=mi>04</span><span class=n>s</span><span class=p>)</span> 
</span></span></code></pre></td></tr></table></div></div><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221163239471.png loading=lazy alt=image-20250221163239471></p><h4 id=load-image>load image</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>podman</span> <span class=nb>load</span> <span class=o>-</span><span class=n>i</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>/</span><span class=n>konvoy</span><span class=o>-</span><span class=n>bootstrap</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl><span class=n>podman</span> <span class=nb>load</span> <span class=o>-</span><span class=n>i</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>builder</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>v0</span><span class=o>.</span><span class=mf>20.0</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>podman</span> <span class=n>images</span>
</span></span><span class=line><span class=cl><span class=n>REPOSITORY</span>                              <span class=n>TAG</span>         <span class=n>IMAGE</span> <span class=n>ID</span>      <span class=n>CREATED</span>        <span class=n>SIZE</span>
</span></span><span class=line><span class=cl><span class=n>localhost</span><span class=o>/</span><span class=n>mesosphere</span><span class=o>/</span><span class=n>konvoy</span><span class=o>-</span><span class=n>bootstrap</span>   <span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span>     <span class=n>e7b2ed9a825c</span>  <span class=mi>5</span> <span class=n>weeks</span> <span class=n>ago</span>    <span class=mf>2.13</span> <span class=n>GB</span>
</span></span><span class=line><span class=cl><span class=n>docker</span><span class=o>.</span><span class=n>io</span><span class=o>/</span><span class=n>library</span><span class=o>/</span><span class=n>registry</span>              <span class=n>latest</span>      <span class=mi>26</span><span class=n>b2eb03618e</span>  <span class=mi>16</span> <span class=n>months</span> <span class=n>ago</span>  <span class=mi>26</span> <span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>localhost</span><span class=o>/</span><span class=n>mesosphere</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>builder</span>  <span class=n>v0</span><span class=o>.</span><span class=mf>20.0</span>     <span class=n>f8ce7f154c3b</span>  <span class=mi>45</span> <span class=n>years</span> <span class=n>ago</span>   <span class=mi>779</span> <span class=n>MB</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=create-cluster>Create Cluster</h2><p>上述環境、Bastion 準備完成後，可以開始佈建 NKP Management Cluster</p><h3 id=bootstrap-cluster>Bootstrap Cluster</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[root@nkp-bastion ~] nkp create bootstrap
</span></span><span class=line><span class=cl> ✓ Creating a bootstrap cluster 
</span></span><span class=line><span class=cl> ✓ Initializing new CAPI components 
</span></span><span class=line><span class=cl> ✓ Initializing new CAPI components 
</span></span><span class=line><span class=cl> ✓ Creating ClusterClass resources 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl> [root@nkp-bastion ~] kubectl get nodes
</span></span><span class=line><span class=cl>NAME                                     STATUS   ROLES           AGE     VERSION
</span></span><span class=line><span class=cl>konvoy-capi-bootstrapper-control-plane   Ready    control-plane   2m27s   v1.30.5
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] kubectl get pods -A
</span></span><span class=line><span class=cl>NAMESPACE                           NAME                                                             READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>caaph-system                        caaph-controller-manager-5c4b55f8b6-n6l5j                        1/1     Running   0          93s
</span></span><span class=line><span class=cl>capa-system                         capa-controller-manager-6c9654f67d-4cr6z                         1/1     Running   0          108s
</span></span><span class=line><span class=cl>capg-system                         capg-controller-manager-6f85f89dbc-z4qgv                         1/1     Running   0          96s
</span></span><span class=line><span class=cl>capi-kubeadm-bootstrap-system       capi-kubeadm-bootstrap-controller-manager-679764b5b7-f5558       1/1     Running   0          111s
</span></span><span class=line><span class=cl>capi-kubeadm-control-plane-system   capi-kubeadm-control-plane-controller-manager-6db6bbdd85-zbhkg   1/1     Running   0          110s
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><h3 id=machine-image-if-required>Machine Image (if required)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;export NUTANIX_USER=admin&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;export NUTANIX_PASSWORD=nx2Tech702!&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;export PE_CLUSTER_NAME=PHX-SPOC014-1&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;export PC_ENDPOINT=10.38.14.10&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;export SUBNET=primary&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>source</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>env</span>
</span></span><span class=line><span class=cl><span class=n>REGISTRY_URL</span><span class=o>=</span><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.24</span><span class=p>:</span><span class=mi>5000</span>
</span></span><span class=line><span class=cl><span class=n>PE_CLUSTER_NAME</span><span class=o>=</span><span class=n>PHX</span><span class=o>-</span><span class=n>SPOC014</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>NUTANIX_USER</span><span class=o>=</span><span class=n>admin</span>
</span></span><span class=line><span class=cl><span class=n>PC_ENDPOINT</span><span class=o>=</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.10</span>
</span></span><span class=line><span class=cl><span class=n>BOOTSTRAP_HOST_IP</span><span class=o>=</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.24</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>create</span> <span class=n>image</span> <span class=n>nutanix</span> <span class=n>ubuntu</span><span class=o>-</span><span class=mf>22.04</span> <span class=o>--</span><span class=n>cluster</span><span class=o>=$</span><span class=n>PE_CLUSTER_NAME</span> <span class=o>--</span><span class=n>endpoint</span><span class=o>=$</span><span class=n>PC_ENDPOINT</span> <span class=o>--</span><span class=n>subnet</span><span class=o>=$</span><span class=n>SUBNET</span> <span class=o>--</span><span class=n>insecure</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>==&gt;</span> <span class=n>Wait</span> <span class=n>completed</span> <span class=n>after</span> <span class=mi>6</span> <span class=n>minutes</span> <span class=mi>33</span> <span class=n>seconds</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>==&gt;</span> <span class=n>Builds</span> <span class=n>finished</span><span class=o>.</span> <span class=n>The</span> <span class=n>artifacts</span> <span class=n>of</span> <span class=n>successful</span> <span class=n>builds</span> <span class=n>are</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=o>--&gt;</span> <span class=n>nutanix</span><span class=o>.</span><span class=n>kib_image</span><span class=p>:</span> <span class=n>nkp</span><span class=o>-</span><span class=n>ubuntu</span><span class=o>-</span><span class=mf>22.04</span><span class=o>-</span><span class=mf>1.30</span><span class=o>.</span><span class=mi>5</span><span class=o>-</span><span class=mi>20250221084439</span>
</span></span><span class=line><span class=cl><span class=o>--&gt;</span> <span class=n>nutanix</span><span class=o>.</span><span class=n>kib_image</span><span class=p>:</span> <span class=n>nkp</span><span class=o>-</span><span class=n>ubuntu</span><span class=o>-</span><span class=mf>22.04</span><span class=o>-</span><span class=mf>1.30</span><span class=o>.</span><span class=mi>5</span><span class=o>-</span><span class=mi>20250221084439</span>
</span></span><span class=line><span class=cl><span class=o>--&gt;</span> <span class=n>nutanix</span><span class=o>.</span><span class=n>kib_image</span><span class=p>:</span> <span class=n>nkp</span><span class=o>-</span><span class=n>ubuntu</span><span class=o>-</span><span class=mf>22.04</span><span class=o>-</span><span class=mf>1.30</span><span class=o>.</span><span class=mi>5</span><span class=o>-</span><span class=mi>20250221084439</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;export VM_IMAGE=nkp-ubuntu-22.04-1.30.5-20250221084439&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl><span class=n>source</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221164530515.png loading=lazy></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221164753010.png loading=lazy alt=image-20250221164753010></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221164808447.png loading=lazy alt=image-20250221164808447></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221164837208.png loading=lazy alt=image-20250221164837208></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221164908398.png loading=lazy alt=image-20250221164908398></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221165050977.png loading=lazy alt=image-20250221165050977></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221164925341.png loading=lazy alt=image-20250221164925341></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221165127407.png loading=lazy alt=image-20250221165127407></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221164704789.png loading=lazy alt=image-20250221164704789></p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221165200360.png loading=lazy alt=image-20250221165200360></p><h3 id=management-cluster>Management Cluster</h3><h4 id=env-設定環境變數>Env 設定環境變數</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>env</span><span class=o>.</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>MGMT_CLUSTER_NAME</span><span class=o>=</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>PE_CLUSTER_NAME</span><span class=o>=</span><span class=n>PHX</span><span class=o>-</span><span class=n>SPOC014</span><span class=o>-</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>SUBNET</span><span class=o>=</span><span class=n>primary</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>MGMT_CP_ENDPOINT</span><span class=o>=</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.51</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>VM_IMAGE</span><span class=o>=</span><span class=n>nkp</span><span class=o>-</span><span class=n>ubuntu</span><span class=o>-</span><span class=mf>22.04</span><span class=o>-</span><span class=mf>1.30</span><span class=o>.</span><span class=mi>5</span><span class=o>-</span><span class=mi>20250221084439</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>STORAGE_CONTAINER</span><span class=o>=</span><span class=n>default</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>MGMT_LB_IP_RANGE</span><span class=o>=</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.52</span><span class=o>-</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.54</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>NUTANIX_USER</span><span class=o>=</span><span class=n>admin</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>NUTANIX_PASSWORD</span><span class=o>=</span><span class=n>nx2Tech702</span><span class=o>!</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>PC_ENDPOINT</span><span class=o>=</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.10</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>CSI_HYPERVISOR_ATTACHED</span><span class=o>=</span><span class=s2>&#34;true&#34;</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>CSI_FILESYSTEM</span><span class=o>=</span><span class=s2>&#34;ext4&#34;</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>CONTROL_PLANE_IP</span><span class=o>=</span><span class=s2>&#34;10.38.14.51&#34;</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>SSH_PUBLIC_KEY</span><span class=o>=</span><span class=s2>&#34;/home/nkp/.ssh/id_rsa.pub&#34;</span>
</span></span><span class=line><span class=cl><span class=k>export</span> <span class=n>REGISTRY_URL</span><span class=o>=</span><span class=s2>&#34;http://10.38.14.24:5000&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>source</span> <span class=n>env</span><span class=o>.</span><span class=n>sh</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=create--cluster>Create Cluster</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>nkp</span> <span class=n>create</span> <span class=n>cluster</span> <span class=n>nutanix</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>cluster</span><span class=o>-</span><span class=n>name</span><span class=o>=$</span><span class=n>MGMT_CLUSTER_NAME</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>control</span><span class=o>-</span><span class=n>plane</span><span class=o>-</span><span class=n>prism</span><span class=o>-</span><span class=n>element</span><span class=o>-</span><span class=n>cluster</span><span class=o>=$</span><span class=n>PE_CLUSTER_NAME</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>control</span><span class=o>-</span><span class=n>plane</span><span class=o>-</span><span class=n>subnets</span><span class=o>=$</span><span class=n>SUBNET</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>control</span><span class=o>-</span><span class=n>plane</span><span class=o>-</span><span class=n>endpoint</span><span class=o>-</span><span class=n>ip</span><span class=o>=$</span><span class=n>MGMT_CP_ENDPOINT</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>control</span><span class=o>-</span><span class=n>plane</span><span class=o>-</span><span class=n>vm</span><span class=o>-</span><span class=n>image</span><span class=o>=$</span><span class=n>VM_IMAGE</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>worker</span><span class=o>-</span><span class=n>prism</span><span class=o>-</span><span class=n>element</span><span class=o>-</span><span class=n>cluster</span><span class=o>=$</span><span class=n>PE_CLUSTER_NAME</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>worker</span><span class=o>-</span><span class=n>subnets</span><span class=o>=$</span><span class=n>SUBNET</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>worker</span><span class=o>-</span><span class=n>vm</span><span class=o>-</span><span class=n>image</span><span class=o>=$</span><span class=n>VM_IMAGE</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>worker</span><span class=o>-</span><span class=n>memory</span><span class=o>=</span><span class=mi>16</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>csi</span><span class=o>-</span><span class=n>storage</span><span class=o>-</span><span class=n>container</span><span class=o>=$</span><span class=n>STORAGE_CONTAINER</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>kubernetes</span><span class=o>-</span><span class=n>service</span><span class=o>-</span><span class=nb>load</span><span class=o>-</span><span class=n>balancer</span><span class=o>-</span><span class=n>ip</span><span class=o>-</span><span class=nb>range</span><span class=o>=$</span><span class=n>MGMT_LB_IP_RANGE</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>endpoint</span><span class=o>=</span><span class=s2>&#34;https://$PC_ENDPOINT:9440&#34;</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>insecure</span><span class=o>=</span><span class=bp>true</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>registry</span><span class=o>-</span><span class=n>mirror</span><span class=o>-</span><span class=n>url</span><span class=o>=$</span><span class=n>REGISTRY_URL</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>ssh</span><span class=o>-</span><span class=n>public</span><span class=o>-</span><span class=n>key</span><span class=o>-</span><span class=n>file</span><span class=o>=$</span><span class=n>SSH_PUBLIC_KEY</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>dry</span><span class=o>-</span><span class=n>run</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>output</span><span class=o>=</span><span class=n>yaml</span> <span class=o>&gt;</span> <span class=n>deploy</span><span class=o>-</span><span class=n>nkp</span><span class=o>-$</span><span class=n>MGMT_CLUSTER_NAME</span><span class=o>.</span><span class=n>yaml</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>ll</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>  <span class=mi>997</span> <span class=n>Feb</span> <span class=mi>20</span> <span class=mi>22</span><span class=p>:</span><span class=mi>43</span> <span class=n>anaconda</span><span class=o>-</span><span class=n>ks</span><span class=o>.</span><span class=n>cfg</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span> <span class=mi>5913</span> <span class=n>Feb</span> <span class=mi>21</span> <span class=mi>01</span><span class=p>:</span><span class=mi>20</span> <span class=n>deploy</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>.</span><span class=n>yaml</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rwxr</span><span class=o>-</span><span class=n>xr</span><span class=o>-</span><span class=n>x</span><span class=o>.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>  <span class=mi>586</span> <span class=n>Feb</span> <span class=mi>21</span> <span class=mi>01</span><span class=p>:</span><span class=mi>17</span> <span class=n>env</span><span class=o>.</span><span class=n>sh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>kubectl</span> <span class=n>create</span> <span class=o>-</span><span class=n>f</span> <span class=n>deploy</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>.</span><span class=n>yaml</span>
</span></span><span class=line><span class=cl><span class=n>cluster</span><span class=o>.</span><span class=n>cluster</span><span class=o>.</span><span class=n>x</span><span class=o>-</span><span class=n>k8s</span><span class=o>.</span><span class=n>io</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span> <span class=n>created</span>
</span></span><span class=line><span class=cl><span class=n>secret</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>credentials</span> <span class=n>created</span>
</span></span><span class=line><span class=cl><span class=n>secret</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>credentials</span><span class=o>-</span><span class=k>for</span><span class=o>-</span><span class=n>csi</span> <span class=n>created</span>
</span></span><span class=line><span class=cl><span class=n>configmap</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>bootstrap</span><span class=o>-</span><span class=n>configuration</span> <span class=n>created</span>
</span></span><span class=line><span class=cl><span class=n>secret</span><span class=o>/</span><span class=n>prism</span><span class=o>-</span><span class=n>central</span><span class=o>-</span><span class=n>metadata</span> <span class=n>created</span>
</span></span><span class=line><span class=cl><span class=n>secret</span><span class=o>/</span><span class=n>global</span><span class=o>-</span><span class=n>nutanix</span><span class=o>-</span><span class=n>credentials</span> <span class=n>created</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>watch</span> <span class=o>-</span><span class=n>n</span> <span class=mi>5</span> <span class=n>nkp</span> <span class=n>describe</span> <span class=n>cluster</span> <span class=o>--</span><span class=n>cluster</span><span class=o>-</span><span class=n>name</span> <span class=o>$</span><span class=n>MGMT_CLUSTER_NAME</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250221172657309.png loading=lazy alt=image-20250221172657309></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>get</span> <span class=n>kubeconfig</span> <span class=o>--</span><span class=n>cluster</span><span class=o>-</span><span class=n>name</span> <span class=n>nkp</span><span class=o>-</span><span class=n>poc</span> <span class=o>&gt;</span> <span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>.</span><span class=n>conf</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>chmod</span> <span class=mi>600</span> <span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>.</span><span class=n>conf</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>ll</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mi>32</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>  <span class=mi>997</span> <span class=n>Feb</span> <span class=mi>20</span> <span class=mi>22</span><span class=p>:</span><span class=mi>43</span> <span class=n>anaconda</span><span class=o>-</span><span class=n>ks</span><span class=o>.</span><span class=n>cfg</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span> <span class=mi>5913</span> <span class=n>Feb</span> <span class=mi>21</span> <span class=mi>01</span><span class=p>:</span><span class=mi>20</span> <span class=n>deploy</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>.</span><span class=n>yaml</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span> <span class=mi>5913</span> <span class=n>Feb</span> <span class=mi>21</span> <span class=mi>01</span><span class=p>:</span><span class=mi>21</span> <span class=n>deploy</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>.</span><span class=n>yaml_bk</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rwxr</span><span class=o>-</span><span class=n>xr</span><span class=o>-</span><span class=n>x</span><span class=o>.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span>  <span class=mi>586</span> <span class=n>Feb</span> <span class=mi>21</span> <span class=mi>01</span><span class=p>:</span><span class=mi>17</span> <span class=n>env</span><span class=o>.</span><span class=n>sh</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-------.</span> <span class=mi>1</span> <span class=n>root</span> <span class=n>root</span> <span class=mi>5543</span> <span class=n>Feb</span> <span class=mi>21</span> <span class=mi>01</span><span class=p>:</span><span class=mi>28</span> <span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>.</span><span class=n>conf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>echo</span> <span class=s2>&#34;export KUBECONFIG=~/nkp-poc.conf&#34;</span> <span class=o>&gt;&gt;</span> <span class=o>~/.</span><span class=n>bashrc</span>
</span></span><span class=line><span class=cl><span class=n>source</span> <span class=o>.</span><span class=n>bashrc</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>kubectl</span> <span class=n>get</span> <span class=n>nodes</span>
</span></span><span class=line><span class=cl><span class=n>NAME</span>                             <span class=n>STATUS</span>   <span class=n>ROLES</span>           <span class=n>AGE</span>     <span class=n>VERSION</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>dkfnd</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>5</span><span class=n>m43s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>gmllf</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>8</span><span class=n>m8s</span>    <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>x989r</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>4</span><span class=n>m25s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>g5pnb</span><span class=o>-</span><span class=mi>4j</span><span class=n>bfm</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>6</span><span class=n>m17s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>g5pnb</span><span class=o>-</span><span class=n>cxlx7</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>6</span><span class=n>m40s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>g5pnb</span><span class=o>-</span><span class=n>kwvlj</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>6</span><span class=n>m15s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>g5pnb</span><span class=o>-</span><span class=n>m9dkw</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>6</span><span class=n>m18s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;建立 capi-components&#34;</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>create</span> <span class=n>capi</span><span class=o>-</span><span class=n>components</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Initializing</span> <span class=n>new</span> <span class=n>CAPI</span> <span class=n>components</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Initializing</span> <span class=n>new</span> <span class=n>CAPI</span> <span class=n>components</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Creating</span> <span class=n>ClusterClass</span> <span class=n>resources</span> 
</span></span></code></pre></td></tr></table></div></div><h4 id=delete-bootstrap>Delete bootstrap</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;從 bootstratp 移轉 capi-resources&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] unset KUBECONFIG
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] kubectl get nodes
</span></span><span class=line><span class=cl>NAME                                     STATUS   ROLES           AGE   VERSION
</span></span><span class=line><span class=cl>konvoy-capi-bootstrapper-control-plane   Ready    control-plane   60m   v1.30.5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] nkp move capi-resources --to-kubeconfig nkp-poc.conf
</span></span><span class=line><span class=cl> ✓ Moving cluster resources 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>You can now view resources in the moved cluster by using the --kubeconfig flag with kubectl.
</span></span><span class=line><span class=cl>For example: kubectl --kubeconfig=&#34;nkp-poc.conf&#34; get nodes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] nkp delete bootstrap
</span></span><span class=line><span class=cl> ✓ Deleting bootstrap cluster 
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] source ~/.bashrc
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] kubectl get nodes
</span></span><span class=line><span class=cl>NAME                             STATUS   ROLES           AGE   VERSION
</span></span><span class=line><span class=cl>nkp-poc-d78fs-dkfnd              Ready    control-plane   12m   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-d78fs-gmllf              Ready    control-plane   14m   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-d78fs-x989r              Ready    control-plane   10m   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-4jbfm   Ready    &lt;none&gt;          12m   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-cxlx7   Ready    &lt;none&gt;          13m   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-kwvlj   Ready    &lt;none&gt;          12m   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-m9dkw   Ready    &lt;none&gt;          12m   v1.30.5
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] kubectl get ns
</span></span><span class=line><span class=cl>NAME                                STATUS   AGE
</span></span><span class=line><span class=cl>caaph-system                        Active   4m56s
</span></span><span class=line><span class=cl>capa-system                         Active   5m9s
</span></span><span class=line><span class=cl>capg-system                         Active   4m59s
</span></span><span class=line><span class=cl>capi-kubeadm-bootstrap-system       Active   5m10s
</span></span><span class=line><span class=cl>capi-kubeadm-control-plane-system   Active   5m9s
</span></span><span class=line><span class=cl>capi-system                         Active   5m11s
</span></span><span class=line><span class=cl>cappp-system                        Active   5m1s
</span></span><span class=line><span class=cl>capv-system                         Active   5m
</span></span><span class=line><span class=cl>capvcd-system                       Active   4m58s
</span></span><span class=line><span class=cl>capx-system                         Active   4m57s
</span></span><span class=line><span class=cl>capz-system                         Active   5m7s
</span></span><span class=line><span class=cl>caren-system                        Active   3m50s
</span></span><span class=line><span class=cl>cert-manager                        Active   5m23s
</span></span><span class=line><span class=cl>default                             Active   14m
</span></span><span class=line><span class=cl>git-operator-system                 Active   88s
</span></span><span class=line><span class=cl>kommander                           Active   13m
</span></span><span class=line><span class=cl>kommander-flux                      Active   109s
</span></span><span class=line><span class=cl>kube-node-lease                     Active   14m
</span></span><span class=line><span class=cl>kube-public                         Active   14m
</span></span><span class=line><span class=cl>kube-system                         Active   14m
</span></span><span class=line><span class=cl>metallb-system                      Active   14m
</span></span><span class=line><span class=cl>node-feature-discovery              Active   13m
</span></span><span class=line><span class=cl>ntnx-system                         Active   14m
</span></span></code></pre></td></tr></table></div></div><h4 id=取得-dashboard>取得 Dashboard</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>watch kubectl get pods -n kommander
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] nkp get dashboard 
</span></span><span class=line><span class=cl>Username: clever_euclid
</span></span><span class=line><span class=cl>Password: 8JW63deYbPpIIrCtTPBXJihIF8xsWxw0YTCSVvcAa1SupyZ14GqEEVFGXzAb7ZB7
</span></span><span class=line><span class=cl>URL: https://10.38.14.52/dkp/kommander/dashboard
</span></span></code></pre></td></tr></table></div></div><p>串接LDAP、License匯入完成後登入畫面</p><p><img src=https://kenkenny.synology.me:5543/images/2025/02/image-20250225151046730.png loading=lazy alt=image-20250225151046730></p><h4 id=其他叢集資訊>其他叢集資訊</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&#34;叢集資訊&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] kubectl get namespace kube-system --output jsonpath={.metadata.uid}
</span></span><span class=line><span class=cl>7e1c859a-0d30-46a3-83d5-21398e4d7cc4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] kubectl get cluster
</span></span><span class=line><span class=cl>NAME      CLUSTERCLASS   PHASE         AGE     VERSION
</span></span><span class=line><span class=cl>nkp-poc   nkp-nutanix    Provisioned   2d20h   v1.30.5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&#34;POC License Key&#34;
</span></span><span class=line><span class=cl># AEAAN-AAAYY-T9A7V-5UL6S-49UQ2-H89DG-EP2AR
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~] kubectl describe cluster nkp-poc
</span></span><span class=line><span class=cl>Name:         nkp-poc
</span></span><span class=line><span class=cl>Namespace:    default
</span></span><span class=line><span class=cl>Labels:       cluster.x-k8s.io/cluster-name=nkp-poc
</span></span><span class=line><span class=cl>              cluster.x-k8s.io/provider=nutanix
</span></span><span class=line><span class=cl>              konvoy.d2iq.io/cluster-name=nkp-poc
</span></span><span class=line><span class=cl>              konvoy.d2iq.io/provider=nutanix
</span></span><span class=line><span class=cl>              topology.cluster.x-k8s.io/owned=
</span></span><span class=line><span class=cl>Annotations:  caren.nutanix.com/cluster-uuid: 019527cf-0ec5-7b3b-b4aa-3f50c7dc3b4f
</span></span><span class=line><span class=cl>API Version:  cluster.x-k8s.io/v1beta1
</span></span><span class=line><span class=cl>Kind:         Cluster
</span></span><span class=line><span class=cl>Metadata:
</span></span><span class=line><span class=cl>  Creation Timestamp:  2025-02-21T09:36:01Z
</span></span><span class=line><span class=cl>  Finalizers:
</span></span><span class=line><span class=cl>    cluster.cluster.x-k8s.io
</span></span><span class=line><span class=cl>  Generation:        2
</span></span><span class=line><span class=cl>  Resource Version:  10471
</span></span><span class=line><span class=cl>  UID:               4236d3d9-3d77-4c0b-8494-e67dfe774f92
</span></span><span class=line><span class=cl>Spec:
</span></span><span class=line><span class=cl>  Cluster Network:
</span></span><span class=line><span class=cl>    Pods:
</span></span><span class=line><span class=cl>      Cidr Blocks:
</span></span><span class=line><span class=cl>        192.168.0.0/16
</span></span><span class=line><span class=cl>    Services:
</span></span><span class=line><span class=cl>      Cidr Blocks:
</span></span><span class=line><span class=cl>        10.96.0.0/12
</span></span><span class=line><span class=cl>  Control Plane Endpoint:
</span></span><span class=line><span class=cl>    Host:  10.38.14.51
</span></span><span class=line><span class=cl>    Port:  6443
</span></span><span class=line><span class=cl>  Control Plane Ref:
</span></span><span class=line><span class=cl>    API Version:  controlplane.cluster.x-k8s.io/v1beta1
</span></span><span class=line><span class=cl>    Kind:         KubeadmControlPlane
</span></span><span class=line><span class=cl>    Name:         nkp-poc-d78fs
</span></span><span class=line><span class=cl>    Namespace:    default
</span></span><span class=line><span class=cl>  Infrastructure Ref:
</span></span><span class=line><span class=cl>    API Version:  infrastructure.cluster.x-k8s.io/v1beta1
</span></span><span class=line><span class=cl>    Kind:         NutanixCluster
</span></span><span class=line><span class=cl>    Name:         nkp-poc-5cvwf
</span></span><span class=line><span class=cl>    Namespace:    default
</span></span><span class=line><span class=cl>  Topology:
</span></span><span class=line><span class=cl>    Class:  nkp-nutanix
</span></span><span class=line><span class=cl>    Control Plane:
</span></span><span class=line><span class=cl>      Metadata:
</span></span><span class=line><span class=cl>      Replicas:  3
</span></span><span class=line><span class=cl>    Variables:
</span></span><span class=line><span class=cl>      Name:  clusterConfig
</span></span><span class=line><span class=cl>      Value:
</span></span><span class=line><span class=cl>        Addons:
</span></span><span class=line><span class=cl>          Ccm:
</span></span><span class=line><span class=cl>            Credentials:
</span></span><span class=line><span class=cl>              Secret Ref:
</span></span><span class=line><span class=cl>                Name:  nkp-poc-pc-credentials
</span></span><span class=line><span class=cl>            Strategy:  HelmAddon
</span></span><span class=line><span class=cl>          Cluster Autoscaler:
</span></span><span class=line><span class=cl>            Strategy:  HelmAddon
</span></span><span class=line><span class=cl>          Cni:
</span></span><span class=line><span class=cl>            Provider:  Cilium
</span></span><span class=line><span class=cl>            Strategy:  HelmAddon
</span></span><span class=line><span class=cl>          Csi:
</span></span><span class=line><span class=cl>            Default Storage:
</span></span><span class=line><span class=cl>              Provider:              nutanix
</span></span><span class=line><span class=cl>              Storage Class Config:  volume
</span></span><span class=line><span class=cl>            Providers:
</span></span><span class=line><span class=cl>              Nutanix:
</span></span><span class=line><span class=cl>                Credentials:
</span></span><span class=line><span class=cl>                  Secret Ref:
</span></span><span class=line><span class=cl>                    Name:  nkp-poc-pc-credentials-for-csi
</span></span><span class=line><span class=cl>                Storage Class Configs:
</span></span><span class=line><span class=cl>                  Volume:
</span></span><span class=line><span class=cl>                    Allow Expansion:  true
</span></span><span class=line><span class=cl>                    Parameters:
</span></span><span class=line><span class=cl>                      csi.storage.k8s.io/fstype:  ext4
</span></span><span class=line><span class=cl>                      Description:                CSI StorageClass nutanix-volume for nkp-poc
</span></span><span class=line><span class=cl>                      Flash Mode:                 DISABLED
</span></span><span class=line><span class=cl>                      Hypervisor Attached:        ENABLED
</span></span><span class=line><span class=cl>                      Storage Container:          default
</span></span><span class=line><span class=cl>                      Storage Type:               NutanixVolumes
</span></span><span class=line><span class=cl>                    Reclaim Policy:               Delete
</span></span><span class=line><span class=cl>                    Volume Binding Mode:          WaitForFirstConsumer
</span></span><span class=line><span class=cl>                Strategy:                         HelmAddon
</span></span><span class=line><span class=cl>            Snapshot Controller:
</span></span><span class=line><span class=cl>              Strategy:  HelmAddon
</span></span><span class=line><span class=cl>          Nfd:
</span></span><span class=line><span class=cl>            Strategy:  HelmAddon
</span></span><span class=line><span class=cl>          Service Load Balancer:
</span></span><span class=line><span class=cl>            Configuration:
</span></span><span class=line><span class=cl>              Address Ranges:
</span></span><span class=line><span class=cl>                End:    10.38.14.54
</span></span><span class=line><span class=cl>                Start:  10.38.14.52
</span></span><span class=line><span class=cl>            Provider:   MetalLB
</span></span><span class=line><span class=cl>        Control Plane:
</span></span><span class=line><span class=cl>          Nutanix:
</span></span><span class=line><span class=cl>            Machine Details:
</span></span><span class=line><span class=cl>              Boot Type:  uefi
</span></span><span class=line><span class=cl>              Cluster:
</span></span><span class=line><span class=cl>                Name:  PHX-SPOC014-1
</span></span><span class=line><span class=cl>                Type:  name
</span></span><span class=line><span class=cl>              Image:
</span></span><span class=line><span class=cl>                Name:       nkp-ubuntu-22.04-1.30.5-20250221084439
</span></span><span class=line><span class=cl>                Type:       name
</span></span><span class=line><span class=cl>              Memory Size:  16Gi
</span></span><span class=line><span class=cl>              Subnets:
</span></span><span class=line><span class=cl>                Name:            primary
</span></span><span class=line><span class=cl>                Type:            name
</span></span><span class=line><span class=cl>              System Disk Size:  80Gi
</span></span><span class=line><span class=cl>              Vcpu Sockets:      4
</span></span><span class=line><span class=cl>              Vcpus Per Socket:  1
</span></span><span class=line><span class=cl>        Dns:
</span></span><span class=line><span class=cl>          Core DNS:
</span></span><span class=line><span class=cl>        Encryption At Rest:
</span></span><span class=line><span class=cl>          Providers:
</span></span><span class=line><span class=cl>            Secretbox:
</span></span><span class=line><span class=cl>        Global Image Registry Mirror:
</span></span><span class=line><span class=cl>          URL:  http://10.38.14.24:5000
</span></span><span class=line><span class=cl>        Nutanix:
</span></span><span class=line><span class=cl>          Control Plane Endpoint:
</span></span><span class=line><span class=cl>            Host:  10.38.14.51
</span></span><span class=line><span class=cl>            Port:  6443
</span></span><span class=line><span class=cl>            Virtual IP:
</span></span><span class=line><span class=cl>              Provider:  KubeVIP
</span></span><span class=line><span class=cl>          Prism Central Endpoint:
</span></span><span class=line><span class=cl>            Credentials:
</span></span><span class=line><span class=cl>              Secret Ref:
</span></span><span class=line><span class=cl>                Name:  nkp-poc-pc-credentials
</span></span><span class=line><span class=cl>            Insecure:  true
</span></span><span class=line><span class=cl>            URL:       https://10.38.14.10:9440
</span></span><span class=line><span class=cl>    Version:           v1.30.5
</span></span><span class=line><span class=cl>    Workers:
</span></span><span class=line><span class=cl>      Machine Deployments:
</span></span><span class=line><span class=cl>        Class:  default-worker
</span></span><span class=line><span class=cl>        Metadata:
</span></span><span class=line><span class=cl>          Annotations:
</span></span><span class=line><span class=cl>            cluster.x-k8s.io/cluster-api-autoscaler-node-group-max-size:  4
</span></span><span class=line><span class=cl>            cluster.x-k8s.io/cluster-api-autoscaler-node-group-min-size:  4
</span></span><span class=line><span class=cl>        Name:                                                             md-0
</span></span><span class=line><span class=cl>        Variables:
</span></span><span class=line><span class=cl>          Overrides:
</span></span><span class=line><span class=cl>            Name:  workerConfig
</span></span><span class=line><span class=cl>            Value:
</span></span><span class=line><span class=cl>              Nutanix:
</span></span><span class=line><span class=cl>                Machine Details:
</span></span><span class=line><span class=cl>                  Boot Type:  uefi
</span></span><span class=line><span class=cl>                  Cluster:
</span></span><span class=line><span class=cl>                    Name:  PHX-SPOC014-1
</span></span><span class=line><span class=cl>                    Type:  name
</span></span><span class=line><span class=cl>                  Image:
</span></span><span class=line><span class=cl>                    Name:       nkp-ubuntu-22.04-1.30.5-20250221084439
</span></span><span class=line><span class=cl>                    Type:       name
</span></span><span class=line><span class=cl>                  Memory Size:  16Gi
</span></span><span class=line><span class=cl>                  Subnets:
</span></span><span class=line><span class=cl>                    Name:            primary
</span></span><span class=line><span class=cl>                    Type:            name
</span></span><span class=line><span class=cl>                  System Disk Size:  80Gi
</span></span><span class=line><span class=cl>                  Vcpu Sockets:      8
</span></span><span class=line><span class=cl>                  Vcpus Per Socket:  1
</span></span><span class=line><span class=cl>Status:
</span></span><span class=line><span class=cl>  Conditions:
</span></span><span class=line><span class=cl>    Last Transition Time:  2025-02-21T09:36:14Z
</span></span><span class=line><span class=cl>    Status:                True
</span></span><span class=line><span class=cl>    Type:                  Ready
</span></span><span class=line><span class=cl>    Last Transition Time:  2025-02-21T09:36:10Z
</span></span><span class=line><span class=cl>    Status:                True
</span></span><span class=line><span class=cl>    Type:                  ControlPlaneInitialized
</span></span><span class=line><span class=cl>    Last Transition Time:  2025-02-21T09:36:14Z
</span></span><span class=line><span class=cl>    Status:                True
</span></span><span class=line><span class=cl>    Type:                  ControlPlaneReady
</span></span><span class=line><span class=cl>    Last Transition Time:  2025-02-21T09:36:11Z
</span></span><span class=line><span class=cl>    Status:                True
</span></span><span class=line><span class=cl>    Type:                  InfrastructureReady
</span></span><span class=line><span class=cl>    Last Transition Time:  2025-02-21T09:37:32Z
</span></span><span class=line><span class=cl>    Status:                True
</span></span><span class=line><span class=cl>    Type:                  KommanderInitialized
</span></span><span class=line><span class=cl>    Last Transition Time:  2025-02-21T09:36:13Z
</span></span><span class=line><span class=cl>    Status:                True
</span></span><span class=line><span class=cl>    Type:                  TopologyReconciled
</span></span><span class=line><span class=cl>  Control Plane Ready:     true
</span></span><span class=line><span class=cl>  Infrastructure Ready:    true
</span></span><span class=line><span class=cl>  Observed Generation:     2
</span></span><span class=line><span class=cl>  Phase:                   Provisioned
</span></span><span class=line><span class=cl>Events:                    &lt;none&gt;
</span></span></code></pre></td></tr></table></div></div><h2 id=upgrade-nkp>Upgrade NKP</h2><h3 id=目前版本>目前版本</h3><p>NKP : v2.13.1 預計升級到 v2.14</p><p>Kubernetes: v1.30.5 預計升級到 v1.31.4</p><p>OS image : Ubuntu 22.04 , Kernel 5.15.0-119-generic</p><p>KiB : 2.18 預計升級到 2.22.2</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306140245123.png loading=lazy alt=image-20250306140245123></p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306140338580.png loading=lazy alt=image-20250306140338580></p><h3 id=升級前先確認>升級前先確認</h3><ol><li>NKP Release Notes</li><li>更新的項目及版本是否會影響現有系統及應用程式</li><li>用 nkp version 指令確認 NKP 版本</li><li>確認版本相容性 <a class=link href="https://portal.nutanix.com/page/documents/details?targetId=Nutanix-Kubernetes-Platform-v2_14:top-ug-nkp-compat-table-c.html" target=_blank rel=noopener>Upgrade Compatibility Tables</a></li><li>重要系統套用 Deploy Pod Disruption Budget (PDB) <a class=link href=https://kubernetes.io/docs/concepts/workloads/pods/disruptions/ target=_blank rel=noopener>https://kubernetes.io/docs/concepts/workloads/pods/disruptions/</a></li><li>使用 Velero 備份現有設定</li></ol><h3 id=upgrade-path>Upgrade Path</h3><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306133207749.png loading=lazy alt=image-20250306133207749></p><h3 id=upgrade-order-nutanix>Upgrade Order (Nutanix)</h3><p><strong>先升級 Management Cluster 再升級 Workload Cluster</strong></p><ol><li>Bastion 升級 nkp, kib 指令版本</li><li>下載 nkp-airgapped bundle 包並升級 kubectl</li><li>上傳 Kommander, Konvoy, Catalog Application (Ultimate) 等 image 到 private registry</li><li>製作或下載新版本的 OS image ( 請查看版本相容性確認是否需要更新 )</li><li>升級 Kommander</li><li>升級 Cluster 並指定 OS Image
在 Nutanix 環境此步驟會直接升級 Kubernetes 版本</li></ol><h3 id=upgrade-nkp-pro>Upgrade NKP PRO</h3><h4 id=1--bastion-指令升級及bundle>1. Bastion 指令升級及bundle</h4><p>檔案從 Support Portal copy link下載</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>pwd</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>curl</span> <span class=o>-</span><span class=n>o</span> <span class=n>nkp_v2</span><span class=o>.</span><span class=mf>14.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=s2>&#34;https://download.nutanix.com/downloads/nkp/v2.14.0/nkp_v2.14.0_linux_amd64.tar.gz?Expires=17xxxxxQ__&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>%</span> <span class=n>Total</span>    <span class=o>%</span> <span class=n>Received</span> <span class=o>%</span> <span class=n>Xferd</span>  <span class=n>Average</span> <span class=n>Speed</span>   <span class=n>Time</span>    <span class=n>Time</span>     <span class=n>Time</span>  <span class=n>Current</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Dload</span>  <span class=n>Upload</span>   <span class=n>Total</span>   <span class=n>Spent</span>    <span class=n>Left</span>  <span class=n>Speed</span>
</span></span><span class=line><span class=cl><span class=mi>100</span> <span class=mf>90.5</span><span class=n>M</span>  <span class=mi>100</span> <span class=mf>90.5</span><span class=n>M</span>    <span class=mi>0</span>     <span class=mi>0</span>   <span class=mi>319</span><span class=n>M</span>      <span class=mi>0</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span>  <span class=mi>319</span><span class=n>M</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>curl</span> <span class=o>-</span><span class=n>o</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>22.2</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=s2>&#34;https://download.nutanix.com/downloads/nkp/v2.14.0/konvoy-image-bundle-v2.22.2_linux_amd64.tar.gz?Expires=174127xxxxxx__&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>%</span> <span class=n>Total</span>    <span class=o>%</span> <span class=n>Received</span> <span class=o>%</span> <span class=n>Xferd</span>  <span class=n>Average</span> <span class=n>Speed</span>   <span class=n>Time</span>    <span class=n>Time</span>     <span class=n>Time</span>  <span class=n>Current</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Dload</span>  <span class=n>Upload</span>   <span class=n>Total</span>   <span class=n>Spent</span>    <span class=n>Left</span>  <span class=n>Speed</span>
</span></span><span class=line><span class=cl><span class=mi>100</span>  <span class=mi>330</span><span class=n>M</span>  <span class=mi>100</span>  <span class=mi>330</span><span class=n>M</span>    <span class=mi>0</span>     <span class=mi>0</span>  <span class=mf>16.1</span><span class=n>M</span>      <span class=mi>0</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>20</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>20</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span> <span class=mf>15.8</span><span class=n>M</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>ls</span> <span class=o>-</span><span class=n>l</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mi>16674272</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span>   <span class=mi>346426397</span> <span class=n>Mar</span>  <span class=mi>5</span> <span class=mi>22</span><span class=p>:</span><span class=mi>47</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>22.2</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span>    <span class=mi>94896342</span> <span class=n>Mar</span>  <span class=mi>5</span> <span class=mi>22</span><span class=p>:</span><span class=mi>45</span> <span class=n>nkp_v2</span><span class=o>.</span><span class=mf>14.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span></code></pre></td></tr></table></div></div><p>解壓縮</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>tar</span> <span class=n>xvf</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>22.2</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=o>-</span><span class=n>C</span> <span class=o>../</span><span class=n>nkptools</span><span class=o>/</span><span class=n>kib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>tar</span> <span class=n>xvf</span> <span class=n>nkp_v2</span><span class=o>.</span><span class=mf>14.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=o>-</span><span class=n>C</span> <span class=o>../</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span>
</span></span></code></pre></td></tr></table></div></div><p>將指令複製到 /usr/local/bin</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>cp</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkp</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>cp</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>kib</span><span class=o>/</span><span class=n>konvoy</span><span class=o>-</span><span class=n>image</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>nkp</span> <span class=n>version</span>
</span></span><span class=line><span class=cl><span class=n>diagnose</span><span class=p>:</span> <span class=n>v0</span><span class=o>.</span><span class=mf>10.1</span>
</span></span><span class=line><span class=cl><span class=n>imagebuilder</span><span class=p>:</span> <span class=n>v0</span><span class=o>.</span><span class=mf>22.3</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span><span class=p>:</span> <span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span>
</span></span><span class=line><span class=cl><span class=n>konvoy</span><span class=p>:</span> <span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span>
</span></span><span class=line><span class=cl><span class=n>mindthegap</span><span class=p>:</span> <span class=n>v1</span><span class=o>.</span><span class=mf>16.0</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=p>:</span> <span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span> <span class=n>version</span>
</span></span><span class=line><span class=cl><span class=n>Writing</span> <span class=n>manifest</span> <span class=n>to</span> <span class=n>image</span> <span class=n>destination</span>
</span></span><span class=line><span class=cl><span class=n>Loaded</span> <span class=n>image</span><span class=p>:</span> <span class=n>localhost</span><span class=o>/</span><span class=n>mesosphere</span><span class=o>/</span><span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>builder</span><span class=p>:</span><span class=n>v2</span><span class=o>.</span><span class=mf>22.2</span>
</span></span><span class=line><span class=cl><span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=p>,</span> <span class=n>version</span> <span class=n>v2</span><span class=o>.</span><span class=mf>22.2</span> <span class=p>(</span><span class=n>branch</span><span class=p>:</span> <span class=p>,</span> <span class=n>revision</span><span class=p>:</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>build</span> <span class=n>date</span><span class=p>:</span>       
</span></span><span class=line><span class=cl>		<span class=n>go</span> <span class=n>version</span><span class=p>:</span>       <span class=n>go1</span><span class=o>.</span><span class=mf>22.12</span>
</span></span><span class=line><span class=cl>		<span class=n>platform</span><span class=p>:</span>         <span class=n>linux</span><span class=o>/</span><span class=n>amd64</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=2-下載-airgapped-包>2. 下載 airgapped 包</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>curl</span> <span class=o>-</span><span class=n>o</span> <span class=n>nkp</span><span class=o>-</span><span class=n>air</span><span class=o>-</span><span class=n>gapped</span><span class=o>-</span><span class=n>bundle_v2</span><span class=o>.</span><span class=mf>14.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=s2>&#34;https://download.nutanix.com/downloads/nkp/v2.14.0/nkp-air-gapped-bundle_v2.14.0_linux_amd64.tar.gz?Expires=174127xxxxx&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>%</span> <span class=n>Total</span>    <span class=o>%</span> <span class=n>Received</span> <span class=o>%</span> <span class=n>Xferd</span>  <span class=n>Average</span> <span class=n>Speed</span>   <span class=n>Time</span>    <span class=n>Time</span>     <span class=n>Time</span>  <span class=n>Current</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Dload</span>  <span class=n>Upload</span>   <span class=n>Total</span>   <span class=n>Spent</span>    <span class=n>Left</span>  <span class=n>Speed</span>
</span></span><span class=line><span class=cl><span class=mi>100</span> <span class=mf>15.4</span><span class=n>G</span>  <span class=mi>100</span> <span class=mf>15.4</span><span class=n>G</span>    <span class=mi>0</span>     <span class=mi>0</span>  <span class=mf>17.3</span><span class=n>M</span>      <span class=mi>0</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>15</span><span class=p>:</span><span class=mi>15</span>  <span class=mi>0</span><span class=p>:</span><span class=mi>15</span><span class=p>:</span><span class=mi>15</span> <span class=o>--</span><span class=p>:</span><span class=o>--</span><span class=p>:</span><span class=o>--</span> <span class=mf>15.1</span><span class=n>M</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=mf>2.14</span><span class=p>]</span><span class=o>$</span> <span class=n>tar</span> <span class=n>xvf</span> <span class=n>nkp</span><span class=o>-</span><span class=n>air</span><span class=o>-</span><span class=n>gapped</span><span class=o>-</span><span class=n>bundle_v2</span><span class=o>.</span><span class=mf>14.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=o>-</span><span class=n>C</span> <span class=o>../</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>sudo</span> <span class=n>cp</span> <span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>/</span><span class=n>kubectl</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>kubectl</span> <span class=n>version</span>
</span></span><span class=line><span class=cl><span class=n>Client</span> <span class=n>Version</span><span class=p>:</span> <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl><span class=n>Kustomize</span> <span class=n>Version</span><span class=p>:</span> <span class=n>v5</span><span class=o>.</span><span class=mf>4.2</span>
</span></span><span class=line><span class=cl><span class=n>Server</span> <span class=n>Version</span><span class=p>:</span> <span class=n>v1</span><span class=o>.</span><span class=mf>30.5</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=3-上傳-image>3. 上傳 Image</h4><p>&ldquo;Switch to root&rdquo; 環境變數確認</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># echo &#34;export REGISTRY_URL=http://10.38.14.24:5000&#34; &gt;&gt; .bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># source .bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># echo $REGISTRY_URL</span>
</span></span><span class=line><span class=cl><span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=mf>10.38</span><span class=o>.</span><span class=mf>14.24</span><span class=p>:</span><span class=mi>5000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># echo &#34;NUTANIX_USERNAME=admin&#34; &gt;&gt; .bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># echo &#34;NUTANIX_PASSWORD=nx2Tech702!&#34; &gt;&gt; .bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># echo &#34;export PE_CLUSTER_NAME=PHX-SPOC014-1&#34; &gt;&gt; ~/.bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># echo &#34;export PC_ENDPOINT=10.38.14.10&#34; &gt;&gt; ~/.bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># echo &#34;export SUBNET=primary&#34; &gt;&gt; ~/.bashrc</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># source .bashrc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># ll /home/nkp/nkptools/nkp-airgap/nkp-v2.14.0/container-images/</span>
</span></span><span class=line><span class=cl><span class=n>total</span> <span class=mi>12847076</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span>         <span class=mi>81</span> <span class=n>Mar</span>  <span class=mi>4</span> <span class=mi>01</span><span class=p>:</span><span class=mi>08</span> <span class=n>NOTICES</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span> <span class=mi>8202238464</span> <span class=n>Mar</span>  <span class=mi>4</span> <span class=mi>01</span><span class=p>:</span><span class=mi>08</span> <span class=n>kommander</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span> <span class=mi>4069966848</span> <span class=n>Mar</span>  <span class=mi>4</span> <span class=mi>02</span><span class=p>:</span><span class=mi>46</span> <span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=n>rw</span><span class=o>-</span><span class=n>r</span><span class=o>--</span><span class=n>r</span><span class=o>--.</span> <span class=mi>1</span> <span class=n>nkp</span> <span class=n>nkp</span>  <span class=mi>883191296</span> <span class=n>Mar</span>  <span class=mi>4</span> <span class=mi>00</span><span class=p>:</span><span class=mi>46</span> <span class=n>nkp</span><span class=o>-</span><span class=n>catalog</span><span class=o>-</span><span class=n>applications</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=s2>&#34;Push Image&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kommander</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>push</span> <span class=n>bundle</span> <span class=o>--</span><span class=n>bundle</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>/</span><span class=n>container</span><span class=o>-</span><span class=n>images</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>=$</span><span class=n>REGISTRY_URL</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>skip</span><span class=o>-</span><span class=n>tls</span><span class=o>-</span><span class=n>verify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Creating</span> <span class=n>temporary</span> <span class=n>directory</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Unarchiving</span> <span class=n>image</span> <span class=n>bundle</span> <span class=s2>&#34;/home/nkp/nkptools/nkp-airgap/nkp-v2.14.0/container-images/kommander-image-bundle-v2.14.0.tar&#34;</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Parsing</span> <span class=n>image</span> <span class=n>bundle</span> <span class=n>config</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Starting</span> <span class=n>temporary</span> <span class=n>Docker</span> <span class=n>registry</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Pushing</span> <span class=n>bundled</span> <span class=n>images</span> <span class=p>[</span><span class=o>================================&gt;</span><span class=mi>137</span><span class=o>/</span><span class=mi>137</span><span class=p>]</span> <span class=p>(</span><span class=n>time</span> <span class=n>elapsed</span> <span class=mi>1</span><span class=n>m02s</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1># Konvoy</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>push</span> <span class=n>bundle</span> <span class=o>--</span><span class=n>bundle</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>/</span><span class=n>container</span><span class=o>-</span><span class=n>images</span><span class=o>/</span><span class=n>konvoy</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>=$</span><span class=n>REGISTRY_URL</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>skip</span><span class=o>-</span><span class=n>tls</span><span class=o>-</span><span class=n>verify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Creating</span> <span class=n>temporary</span> <span class=n>directory</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Unarchiving</span> <span class=n>image</span> <span class=n>bundle</span> <span class=s2>&#34;/home/nkp/nkptools/nkp-airgap/nkp-v2.14.0/container-images/konvoy-image-bundle-v2.14.0.tar&#34;</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Parsing</span> <span class=n>image</span> <span class=n>bundle</span> <span class=n>config</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Starting</span> <span class=n>temporary</span> <span class=n>Docker</span> <span class=n>registry</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Pushing</span> <span class=n>bundled</span> <span class=n>images</span> <span class=p>[</span><span class=o>================================&gt;</span><span class=mi>119</span><span class=o>/</span><span class=mi>119</span><span class=p>]</span> <span class=p>(</span><span class=n>time</span> <span class=n>elapsed</span> <span class=mi>28</span><span class=n>s</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=c1># Catalog </span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span> <span class=n>nkp</span> <span class=n>push</span> <span class=n>bundle</span> <span class=o>--</span><span class=n>bundle</span> <span class=o>/</span><span class=n>home</span><span class=o>/</span><span class=n>nkp</span><span class=o>/</span><span class=n>nkptools</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>airgap</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>/</span><span class=n>container</span><span class=o>-</span><span class=n>images</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>catalog</span><span class=o>-</span><span class=n>applications</span><span class=o>-</span><span class=n>image</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>=$</span><span class=n>REGISTRY_URL</span> <span class=o>--</span><span class=n>to</span><span class=o>-</span><span class=n>registry</span><span class=o>-</span><span class=n>insecure</span><span class=o>-</span><span class=n>skip</span><span class=o>-</span><span class=n>tls</span><span class=o>-</span><span class=n>verify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Creating</span> <span class=n>temporary</span> <span class=n>directory</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Unarchiving</span> <span class=n>image</span> <span class=n>bundle</span> <span class=s2>&#34;/home/nkp/nkptools/nkp-airgap/nkp-v2.14.0/container-images/nkp-catalog-applications-image-bundle-v2.14.0.tar&#34;</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Parsing</span> <span class=n>image</span> <span class=n>bundle</span> <span class=n>config</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Starting</span> <span class=n>temporary</span> <span class=n>Docker</span> <span class=n>registry</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Pushing</span> <span class=n>bundled</span> <span class=n>images</span> <span class=p>[</span><span class=o>====================================&gt;</span><span class=mi>8</span><span class=o>/</span><span class=mi>8</span><span class=p>]</span> <span class=p>(</span><span class=n>time</span> <span class=n>elapsed</span> <span class=mi>00</span><span class=n>s</span><span class=p>)</span> 
</span></span></code></pre></td></tr></table></div></div><h4 id=4-製作-os-image>4. 製作 OS Image</h4><h5 id=for-rocky>For Rocky</h5><p>直接在 Prism Central 新增 Support Portal 上的 Image</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306145124197.png loading=lazy alt=image-20250306145124197></p><p>Add Image</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306145228491.png loading=lazy alt=image-20250306145228491></p><p>貼上 URL 並點選 Add URL</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306145309174.png loading=lazy alt=image-20250306145309174></p><p>點選 save</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306145400309.png loading=lazy alt=image-20250306145400309></p><h5 id=for-others-ubuntu>For Others (ubuntu)</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[root@nkp-bastion ~]# nkp create image nutanix ubuntu-22.04 --cluster=$PE_CLUSTER_NAME --endpoint=$PC_ENDPOINT --subnet=$SUBNET --insecure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Provisioning and configuring image
</span></span><span class=line><span class=cl>Manifest files extracted to /root/.nkp-image-builder-3070850318
</span></span><span class=line><span class=cl>Trying to pull docker.io/mesosphere/nkp-image-builder:v0.22.3...
</span></span><span class=line><span class=cl>Getting image source signatures
</span></span><span class=line><span class=cl>Copying blob sha256:99febc243941c0928306275946d862c586d2bd46be4fc4c4e318938a8662d85f
</span></span><span class=line><span class=cl>Copying blob sha256:c926b61bad3b94ae7351bafd0c184c159ebf0643b085f7ef1d47ecdc7316833c
</span></span><span class=line><span class=cl>Copying blob sha256:89fb4fbbd97a1c94aa08f217f0cb914c612179746c6b3706103a99317e65bcda
</span></span><span class=line><span class=cl>Copying blob sha256:fdc5ed007f9c02f44943008862f7c6b62ad238018c6bf0412ab688445e42bbd2
</span></span><span class=line><span class=cl>Copying blob sha256:e9db0040a66483f9870e0f445877fa1352a405a970814dea2aff29598198ff6d
</span></span><span class=line><span class=cl>Copying blob sha256:acb23a6002388c658931180fb73706eeee11696de5da1bce33df4a8a206de2a0
</span></span><span class=line><span class=cl>Copying blob sha256:1166ced2b6761e3267b16e6b82ca07ee8fd00c6626c3507ccc8034ceaf722494
</span></span><span class=line><span class=cl>Copying blob sha256:72df65ad9aeb923b7c2cbc5d06a5e16cb2fda0041a0dc04416c02223e54caee4
</span></span><span class=line><span class=cl>Copying blob sha256:319333dc043f729fe7dca70c6188d77614743bb43e47693f348f5cafb1425cbe
</span></span><span class=line><span class=cl>Copying blob sha256:517f3ad3da58ceb19857ea8e995ea92fb76ae37df29d314265f3d0e8da77060f
</span></span><span class=line><span class=cl>Copying config sha256:2c008cec7e3e56932b4510d51067ff0b604822190f3589d091ec265f58e4bf01
</span></span><span class=line><span class=cl>Writing manifest to image destination
</span></span><span class=line><span class=cl>nutanix.kib_image: output will be in this color.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>==&gt; nutanix.kib_image: Creating Packer Builder virtual machine...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Build &#39;nutanix.kib_image&#39; finished after 7 minutes 28 seconds.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>==&gt; Wait completed after 7 minutes 28 seconds
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>==&gt; Builds finished. The artifacts of successful builds are:
</span></span><span class=line><span class=cl>--&gt; nutanix.kib_image: nkp-ubuntu-22.04-1.31.4-20250306081227
</span></span><span class=line><span class=cl>--&gt; nutanix.kib_image: nkp-ubuntu-22.04-1.31.4-20250306081227
</span></span><span class=line><span class=cl>--&gt; nutanix.kib_image: nkp-ubuntu-22.04-1.31.4-20250306081227
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OS Image:
</span></span><span class=line><span class=cl>nkp-ubuntu-22.04-1.31.4-20250306081227
</span></span></code></pre></td></tr></table></div></div><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306163817087.png loading=lazy alt=image-20250306163817087></p><h4 id=5-升級-kommander>5. 升級 Kommander</h4><h5 id=原版本>原版本</h5><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306164047890.png loading=lazy alt=image-20250306164047890></p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306164118766.png loading=lazy alt=image-20250306164118766></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># kubectl get helmreleases -A</span>
</span></span><span class=line><span class=cl><span class=n>NAMESPACE</span>                     <span class=n>NAME</span>                          <span class=n>AGE</span>   <span class=n>READY</span>   <span class=n>STATUS</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span>   <span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>           <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span><span class=o>/</span><span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span>   <span class=n>kubecost</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>        <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span><span class=o>/</span><span class=n>kubecost</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span>   <span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>      <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span><span class=o>/</span><span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>ai</span><span class=o>-</span><span class=n>navigator</span><span class=o>-</span><span class=n>app</span>              <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>ai</span><span class=o>-</span><span class=n>navigator</span><span class=o>-</span><span class=n>cluster</span><span class=o>-</span><span class=n>info</span><span class=o>-</span><span class=n>api</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>ai</span><span class=o>-</span><span class=n>navigator</span><span class=o>-</span><span class=n>cluster</span><span class=o>-</span><span class=n>info</span><span class=o>-</span><span class=n>api</span><span class=err>@</span><span class=mf>0.2</span><span class=o>.</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>cluster</span><span class=o>-</span><span class=n>observer</span><span class=o>-</span><span class=mi>2360587938</span>   <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>cluster</span><span class=o>-</span><span class=n>observer</span><span class=o>-</span><span class=mf>2360587938.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>cluster</span><span class=o>-</span><span class=n>observer</span><span class=err>@</span><span class=mf>1.4</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>dex</span>                           <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>dex</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>dex</span><span class=err>@</span><span class=mf>2.14</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>dex</span><span class=o>-</span><span class=n>k8s</span><span class=o>-</span><span class=n>authenticator</span>         <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>dex</span><span class=o>-</span><span class=n>k8s</span><span class=o>-</span><span class=n>authenticator</span><span class=o>.</span><span class=n>v4</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>dex</span><span class=o>-</span><span class=n>k8s</span><span class=o>-</span><span class=n>authenticator</span><span class=err>@</span><span class=mf>1.4</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>fluent</span><span class=o>-</span><span class=n>bit</span>                    <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>fluent</span><span class=o>-</span><span class=n>bit</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>fluent</span><span class=o>-</span><span class=n>bit</span><span class=err>@</span><span class=mf>0.47</span><span class=o>.</span><span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>gatekeeper</span>                    <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>gatekeeper</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>gatekeeper</span><span class=err>@</span><span class=mf>3.17</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>gatekeeper</span><span class=o>-</span><span class=n>proxy</span><span class=o>-</span><span class=n>mutations</span>    <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>gatekeeper</span><span class=o>-</span><span class=n>proxy</span><span class=o>-</span><span class=n>mutations</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>gatekeeper</span><span class=o>-</span><span class=n>proxy</span><span class=o>-</span><span class=n>mutations</span><span class=err>@</span><span class=n>v0</span><span class=o>.</span><span class=mf>0.1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>grafana</span><span class=o>-</span><span class=n>logging</span>               <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>grafana</span><span class=o>-</span><span class=n>logging</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>grafana</span><span class=err>@</span><span class=mf>8.5</span><span class=o>.</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>grafana</span><span class=o>-</span><span class=n>loki</span>                  <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>grafana</span><span class=o>-</span><span class=n>loki</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>loki</span><span class=o>-</span><span class=n>distributed</span><span class=err>@</span><span class=mf>0.79</span><span class=o>.</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>istio</span>                         <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>istio</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>istio</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>istio</span><span class=err>@</span><span class=mf>1.23</span><span class=o>.</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>jaeger</span>                        <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>istio</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>jaeger</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>jaeger</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>2.56</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>           <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kiali</span>                         <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>istio</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>kiali</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kiali</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>1.89</span><span class=o>.</span><span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span>                     <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=err>@</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span><span class=o>-</span><span class=n>appmanagement</span>       <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>appmanagement</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>appmanagement</span><span class=err>@</span><span class=n>v2</span><span class=o>.</span><span class=mf>13.1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span><span class=o>-</span><span class=n>operator</span>            <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>operator</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>0.3</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span><span class=o>-</span><span class=n>ui</span>                  <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>kommander</span><span class=o>-</span><span class=n>ui</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>ui</span><span class=err>@</span><span class=mf>15.23</span><span class=o>.</span><span class=mi>17</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kube</span><span class=o>-</span><span class=n>oidc</span><span class=o>-</span><span class=n>proxy</span>               <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kube</span><span class=o>-</span><span class=n>oidc</span><span class=o>-</span><span class=n>proxy</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kube</span><span class=o>-</span><span class=n>oidc</span><span class=o>-</span><span class=n>proxy</span><span class=err>@</span><span class=mf>0.3</span><span class=o>.</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kube</span><span class=o>-</span><span class=n>prometheus</span><span class=o>-</span><span class=n>stack</span>         <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kube</span><span class=o>-</span><span class=n>prometheus</span><span class=o>-</span><span class=n>stack</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kube</span><span class=o>-</span><span class=n>prometheus</span><span class=o>-</span><span class=n>stack</span><span class=err>@</span><span class=mf>65.5</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kubecost</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>        <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kubecost</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kubefed</span>                       <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kube</span><span class=o>-</span><span class=n>federation</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>kubefed</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kubefed</span><span class=err>@</span><span class=mf>0.10</span><span class=o>.</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kubernetes</span><span class=o>-</span><span class=n>dashboard</span>          <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kubernetes</span><span class=o>-</span><span class=n>dashboard</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kubernetes</span><span class=o>-</span><span class=n>dashboard</span><span class=err>@</span><span class=mf>7.10</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kubetunnel</span>                    <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kubetunnel</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kubetunnel</span><span class=err>@</span><span class=n>v0</span><span class=o>.</span><span class=mf>0.38</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>logging</span><span class=o>-</span><span class=n>operator</span>              <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>-</span><span class=n>logging</span>      <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>-</span><span class=n>logging</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>-</span><span class=n>logging</span><span class=err>@</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>object</span><span class=o>-</span><span class=n>bucket</span><span class=o>-</span><span class=n>claims</span>          <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>object</span><span class=o>-</span><span class=n>bucket</span><span class=o>-</span><span class=n>claims</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>object</span><span class=o>-</span><span class=n>bucket</span><span class=o>-</span><span class=n>claim</span><span class=err>@</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>prometheus</span><span class=o>-</span><span class=n>adapter</span>            <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>prometheus</span><span class=o>-</span><span class=n>adapter</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>prometheus</span><span class=o>-</span><span class=n>adapter</span><span class=err>@</span><span class=mf>4.11</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>      <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>reloader</span>                      <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>reloader</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>reloader</span><span class=err>@</span><span class=mf>1.1</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span>                     <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=err>@</span><span class=n>v1</span><span class=o>.</span><span class=mf>14.5</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>cluster</span>             <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>cluster</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>cluster</span><span class=err>@</span><span class=n>v1</span><span class=o>.</span><span class=mf>14.5</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>traefik</span>                       <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>traefik</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>traefik</span><span class=err>@</span><span class=mf>27.0</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>traefik</span><span class=o>-</span><span class=n>forward</span><span class=o>-</span><span class=n>auth</span><span class=o>-</span><span class=n>mgmt</span>     <span class=mi>12</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>traefik</span><span class=o>-</span><span class=n>forward</span><span class=o>-</span><span class=n>auth</span><span class=o>-</span><span class=n>mgmt</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>traefik</span><span class=o>-</span><span class=n>forward</span><span class=o>-</span><span class=n>auth</span><span class=err>@</span><span class=mf>0.3</span><span class=o>.</span><span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>velero</span>                        <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>velero</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>velero</span><span class=err>@</span><span class=mf>7.2</span><span class=o>.</span><span class=mi>2</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=執行升級指令>執行升級指令</h5><p>大約20分鐘時間</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=c1># cd /home/nkp/nkptools/nkp-airgap/nkp-v2.14.0/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>root</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=n>nkp</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=p>]</span><span class=c1># nkp upgrade kommander \</span>
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>charts</span><span class=o>-</span><span class=n>bundle</span> <span class=o>./</span><span class=n>application</span><span class=o>-</span><span class=n>charts</span><span class=o>/</span><span class=n>nkp</span><span class=o>-</span><span class=n>kommander</span><span class=o>-</span><span class=n>charts</span><span class=o>-</span><span class=n>bundle</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>kommander</span><span class=o>-</span><span class=n>applications</span><span class=o>-</span><span class=n>repository</span> <span class=o>./</span><span class=n>application</span><span class=o>-</span><span class=n>repositories</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>applications</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>upgrading</span> <span class=n>conditions</span> <span class=n>are</span> <span class=n>met</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>kubecost</span> <span class=n>can</span> <span class=n>be</span> <span class=n>upgraded</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>DKP</span> <span class=n>licenses</span> <span class=n>are</span> <span class=n>migrated</span> <span class=p>(</span><span class=k>if</span> <span class=n>any</span><span class=p>)</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>application</span> <span class=n>definitions</span> <span class=n>are</span> <span class=n>updated</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>helm</span><span class=o>-</span><span class=n>mirror</span> <span class=n>implementation</span> <span class=n>is</span> <span class=n>migrated</span> <span class=n>to</span> <span class=n>ChartMuseum</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>root</span> <span class=n>CA</span> <span class=n>duration</span> <span class=n>is</span> <span class=n>upgraded</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>DKA</span> <span class=n>config</span> <span class=n>overrides</span> <span class=n>are</span> <span class=n>cleaned</span> <span class=n>up</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>core</span> <span class=n>Kommander</span> <span class=n>application</span> <span class=p>[</span><span class=n>kommander</span><span class=o>-</span><span class=n>appmanagement</span><span class=p>]</span> <span class=n>is</span> <span class=n>upgraded</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>core</span> <span class=n>Kommander</span> <span class=n>applications</span> <span class=p>[</span><span class=n>git</span><span class=o>-</span><span class=n>operator</span> <span class=n>kommander</span> <span class=n>kommander</span><span class=o>-</span><span class=n>flux</span> <span class=n>kommander</span><span class=o>-</span><span class=n>ui</span><span class=p>]</span> <span class=n>are</span> <span class=n>upgraded</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>new</span><span class=o>/</span><span class=n>updated</span> <span class=n>management</span> <span class=n>configOverrides</span> <span class=n>configmaps</span> <span class=n>are</span> <span class=n>applied</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Installing</span> <span class=n>COSI</span> <span class=n>controller</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>new</span> <span class=n>default</span> <span class=n>Kommander</span> <span class=n>applications</span> <span class=n>are</span> <span class=n>enabled</span>
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=mi>23</span> <span class=n>platform</span> <span class=n>Kommander</span> <span class=n>applications</span> <span class=n>are</span> <span class=n>upgraded</span> <span class=p>[</span><span class=o>==================================&gt;</span><span class=mi>23</span><span class=o>/</span><span class=mi>23</span><span class=p>]</span> <span class=p>(</span><span class=n>time</span> <span class=n>elapsed</span> <span class=mi>11</span><span class=n>m07s</span><span class=p>)</span> 
</span></span><span class=line><span class=cl> <span class=err>✓</span> <span class=n>Ensuring</span> <span class=n>new</span> <span class=n>Kommander</span> <span class=n>applications</span> <span class=n>are</span> <span class=n>installed</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306171232968.png loading=lazy alt=image-20250306171232968></p><p>Kommander UI 已升級，並有新的應用程式出現 (Harbor, Nutanix COSI, CloudNativePG, kubecost)</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306171317317.png loading=lazy alt=image-20250306171317317></p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306171430142.png loading=lazy alt=image-20250306171430142></p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306171411257.png loading=lazy alt=image-20250306171411257></p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306171452670.png loading=lazy alt=image-20250306171452670></p><h4 id=6-升級-cluster>6. 升級 Cluster</h4><p>確認環境變數</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>修改 VM_IMAGE_NAME
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~]# vi env.sh 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion ~]# source env.sh 
</span></span><span class=line><span class=cl>[root@nkp-bastion ~]# echo $MANAGEMENT_CLUSTER_NAME
</span></span><span class=line><span class=cl>nkp-poc
</span></span><span class=line><span class=cl>[root@nkp-bastion ~]# echo $VM_IMAGE_NAME
</span></span><span class=line><span class=cl>nkp-ubuntu-22.04-1.31.4-20250306081227
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[root@nkp-bastion nkp-v2.14.0]# kubectl get nodes
</span></span><span class=line><span class=cl>NAME                             STATUS   ROLES           AGE   VERSION
</span></span><span class=line><span class=cl>nkp-poc-d78fs-dkfnd              Ready    control-plane   12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-d78fs-gmllf              Ready    control-plane   12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-d78fs-x989r              Ready    control-plane   12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-4jbfm   Ready    &lt;none&gt;          12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-cxlx7   Ready    &lt;none&gt;          12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-kwvlj   Ready    &lt;none&gt;          12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-m9dkw   Ready    &lt;none&gt;          12d   v1.30.5
</span></span></code></pre></td></tr></table></div></div><p>執行升級指令</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306172955285.png loading=lazy alt=image-20250306172955285></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[root@nkp-bastion ~]# nkp upgrade cluster nutanix \
</span></span><span class=line><span class=cl>      --cluster-name ${MANAGEMENT_CLUSTER_NAME} \
</span></span><span class=line><span class=cl>      --vm-image ${VM_IMAGE_NAME}
</span></span><span class=line><span class=cl> ✓ Deleting VCD Infrastructure Provider 
</span></span><span class=line><span class=cl> ✓ Upgrading CAPI components 
</span></span><span class=line><span class=cl> ✓ Updating ClusterClass resources 
</span></span><span class=line><span class=cl>cluster.cluster.x-k8s.io/nkp-poc upgraded
</span></span><span class=line><span class=cl>⠈⠱ Upgrading the cluster 
</span></span></code></pre></td></tr></table></div></div><p>Prism Central 自動開始建立新的虛擬機加入叢集，Control 跟 worker 每一台採取先建後拆的方式自動升級</p><p>所以 IP 數量至少要多2個比較保險</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306172414800.png loading=lazy alt=image-20250306172414800></p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306173056948.png loading=lazy alt=image-20250306173056948></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>用另一個 session 連線到 bastion 確認狀態
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[nkp@nkp-bastion ~]$ kubectl get nodes
</span></span><span class=line><span class=cl>NAME                             STATUS     ROLES           AGE   VERSION
</span></span><span class=line><span class=cl>nkp-poc-d78fs-czzph              NotReady   control-plane   47s   v1.31.4
</span></span><span class=line><span class=cl>nkp-poc-d78fs-dkfnd              Ready      control-plane   12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-d78fs-gmllf              Ready      control-plane   13d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-d78fs-x989r              Ready      control-plane   12d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-4jbfm   Ready      &lt;none&gt;          13d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-cxlx7   Ready      &lt;none&gt;          13d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-kwvlj   Ready      &lt;none&gt;          13d   v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-m9dkw   Ready      &lt;none&gt;          13d   v1.30.5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[nkp@nkp-bastion ~]$ kubectl get nodes -o wide
</span></span><span class=line><span class=cl>NAME                             STATUS   ROLES           AGE     VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION       CONTAINER-RUNTIME
</span></span><span class=line><span class=cl>nkp-poc-d78fs-czzph              Ready    control-plane   7m12s   v1.31.4   10.38.14.43   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-134-generic   containerd://1.7.24-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-d78fs-nqtx9              Ready    control-plane   3m48s   v1.31.4   10.38.14.40   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-134-generic   containerd://1.7.24-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-d78fs-x989r              Ready    control-plane   13d     v1.30.5   10.38.14.30   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-4jbfm   Ready    &lt;none&gt;          13d     v1.30.5   10.38.14.31   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-cxlx7   Ready    &lt;none&gt;          13d     v1.30.5   10.38.14.50   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-kwvlj   Ready    &lt;none&gt;          13d     v1.30.5   10.38.14.48   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-m9dkw   Ready    &lt;none&gt;          13d     v1.30.5   10.38.14.47   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[nkp@nkp-bastion ~]$ kubectl get nodes
</span></span><span class=line><span class=cl>NAME                             STATUS     ROLES           AGE     VERSION
</span></span><span class=line><span class=cl>nkp-poc-d78fs-czzph              Ready      control-plane   12m     v1.31.4
</span></span><span class=line><span class=cl>nkp-poc-d78fs-mcn2q              Ready      control-plane   4m59s   v1.31.4
</span></span><span class=line><span class=cl>nkp-poc-d78fs-nqtx9              Ready      control-plane   8m47s   v1.31.4
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-4jbfm   Ready      &lt;none&gt;          13d     v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-cxlx7   Ready      &lt;none&gt;          13d     v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-kwvlj   Ready      &lt;none&gt;          13d     v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-m9dkw   Ready      &lt;none&gt;          13d     v1.30.5
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-gfbbp-sh8b2   NotReady   &lt;none&gt;          13s     v1.31.4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[nkp@nkp-bastion ~]$ kubectl get nodes -o wide
</span></span><span class=line><span class=cl>NAME                             STATUS     ROLES           AGE     VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE             KERNEL-VERSION       CONTAINER-RUNTIME
</span></span><span class=line><span class=cl>nkp-poc-d78fs-czzph              Ready      control-plane   12m     v1.31.4   10.38.14.43   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-134-generic   containerd://1.7.24-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-d78fs-mcn2q              Ready      control-plane   5m29s   v1.31.4   10.38.14.38   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-134-generic   containerd://1.7.24-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-d78fs-nqtx9              Ready      control-plane   9m17s   v1.31.4   10.38.14.40   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-134-generic   containerd://1.7.24-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-4jbfm   Ready      &lt;none&gt;          13d     v1.30.5   10.38.14.31   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-cxlx7   Ready      &lt;none&gt;          13d     v1.30.5   10.38.14.50   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-kwvlj   Ready      &lt;none&gt;          13d     v1.30.5   10.38.14.48   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-g5pnb-m9dkw   Ready      &lt;none&gt;          13d     v1.30.5   10.38.14.47   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-133-generic   containerd://1.7.22-d2iq.1
</span></span><span class=line><span class=cl>nkp-poc-md-0-clx8j-gfbbp-sh8b2   NotReady   &lt;none&gt;          43s     v1.31.4   10.38.14.19   &lt;none&gt;        Ubuntu 22.04.5 LTS   5.15.0-134-generic   containerd://1.7.24-d2iq.1
</span></span></code></pre></td></tr></table></div></div><p>升級完成，大約花費30分鐘左右</p><p><img src=https://kenkenny.synology.me:5543/images/2025/03/image-20250306175039600.png loading=lazy alt=image-20250306175039600></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>kubectl</span> <span class=n>get</span> <span class=n>nodes</span> <span class=o>-</span><span class=n>o</span> <span class=n>wide</span>
</span></span><span class=line><span class=cl><span class=n>NAME</span>                             <span class=n>STATUS</span>   <span class=n>ROLES</span>           <span class=n>AGE</span>     <span class=n>VERSION</span>   <span class=n>INTERNAL</span><span class=o>-</span><span class=ne>IP</span>   <span class=n>EXTERNAL</span><span class=o>-</span><span class=ne>IP</span>   <span class=ne>OS</span><span class=o>-</span><span class=n>IMAGE</span>             <span class=n>KERNEL</span><span class=o>-</span><span class=n>VERSION</span>       <span class=n>CONTAINER</span><span class=o>-</span><span class=n>RUNTIME</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>czzph</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>26</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>   <span class=mf>10.38</span><span class=o>.</span><span class=mf>14.43</span>   <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>        <span class=n>Ubuntu</span> <span class=mf>22.04</span><span class=o>.</span><span class=mi>5</span> <span class=n>LTS</span>   <span class=mf>5.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>134</span><span class=o>-</span><span class=n>generic</span>   <span class=n>containerd</span><span class=p>:</span><span class=o>//</span><span class=mf>1.7</span><span class=o>.</span><span class=mi>24</span><span class=o>-</span><span class=n>d2iq</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>mcn2q</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>19</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>   <span class=mf>10.38</span><span class=o>.</span><span class=mf>14.38</span>   <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>        <span class=n>Ubuntu</span> <span class=mf>22.04</span><span class=o>.</span><span class=mi>5</span> <span class=n>LTS</span>   <span class=mf>5.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>134</span><span class=o>-</span><span class=n>generic</span>   <span class=n>containerd</span><span class=p>:</span><span class=o>//</span><span class=mf>1.7</span><span class=o>.</span><span class=mi>24</span><span class=o>-</span><span class=n>d2iq</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>nqtx9</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>22</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>   <span class=mf>10.38</span><span class=o>.</span><span class=mf>14.40</span>   <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>        <span class=n>Ubuntu</span> <span class=mf>22.04</span><span class=o>.</span><span class=mi>5</span> <span class=n>LTS</span>   <span class=mf>5.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>134</span><span class=o>-</span><span class=n>generic</span>   <span class=n>containerd</span><span class=p>:</span><span class=o>//</span><span class=mf>1.7</span><span class=o>.</span><span class=mi>24</span><span class=o>-</span><span class=n>d2iq</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>g6rtw</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>7</span><span class=n>m50s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>   <span class=mf>10.38</span><span class=o>.</span><span class=mf>14.25</span>   <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>        <span class=n>Ubuntu</span> <span class=mf>22.04</span><span class=o>.</span><span class=mi>5</span> <span class=n>LTS</span>   <span class=mf>5.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>134</span><span class=o>-</span><span class=n>generic</span>   <span class=n>containerd</span><span class=p>:</span><span class=o>//</span><span class=mf>1.7</span><span class=o>.</span><span class=mi>24</span><span class=o>-</span><span class=n>d2iq</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>qzrkh</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>3</span><span class=n>m6s</span>    <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>   <span class=mf>10.38</span><span class=o>.</span><span class=mf>14.30</span>   <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>        <span class=n>Ubuntu</span> <span class=mf>22.04</span><span class=o>.</span><span class=mi>5</span> <span class=n>LTS</span>   <span class=mf>5.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>134</span><span class=o>-</span><span class=n>generic</span>   <span class=n>containerd</span><span class=p>:</span><span class=o>//</span><span class=mf>1.7</span><span class=o>.</span><span class=mi>24</span><span class=o>-</span><span class=n>d2iq</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>sh8b2</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>14</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>   <span class=mf>10.38</span><span class=o>.</span><span class=mf>14.19</span>   <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>        <span class=n>Ubuntu</span> <span class=mf>22.04</span><span class=o>.</span><span class=mi>5</span> <span class=n>LTS</span>   <span class=mf>5.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>134</span><span class=o>-</span><span class=n>generic</span>   <span class=n>containerd</span><span class=p>:</span><span class=o>//</span><span class=mf>1.7</span><span class=o>.</span><span class=mi>24</span><span class=o>-</span><span class=n>d2iq</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>xlmc7</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>11</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>   <span class=mf>10.38</span><span class=o>.</span><span class=mf>14.27</span>   <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>        <span class=n>Ubuntu</span> <span class=mf>22.04</span><span class=o>.</span><span class=mi>5</span> <span class=n>LTS</span>   <span class=mf>5.15</span><span class=o>.</span><span class=mi>0</span><span class=o>-</span><span class=mi>134</span><span class=o>-</span><span class=n>generic</span>   <span class=n>containerd</span><span class=p>:</span><span class=o>//</span><span class=mf>1.7</span><span class=o>.</span><span class=mi>24</span><span class=o>-</span><span class=n>d2iq</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>kubectl</span> <span class=n>get</span> <span class=n>nodes</span>
</span></span><span class=line><span class=cl><span class=n>NAME</span>                             <span class=n>STATUS</span>   <span class=n>ROLES</span>           <span class=n>AGE</span>     <span class=n>VERSION</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>czzph</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>26</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>mcn2q</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>19</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>d78fs</span><span class=o>-</span><span class=n>nqtx9</span>              <span class=n>Ready</span>    <span class=n>control</span><span class=o>-</span><span class=n>plane</span>   <span class=mi>23</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>g6rtw</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>7</span><span class=n>m59s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>qzrkh</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>3</span><span class=n>m15s</span>   <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>sh8b2</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>14</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl><span class=n>nkp</span><span class=o>-</span><span class=n>poc</span><span class=o>-</span><span class=n>md</span><span class=o>-</span><span class=mi>0</span><span class=o>-</span><span class=n>clx8j</span><span class=o>-</span><span class=n>gfbbp</span><span class=o>-</span><span class=n>xlmc7</span>   <span class=n>Ready</span>    <span class=o>&lt;</span><span class=n>none</span><span class=o>&gt;</span>          <span class=mi>12</span><span class=n>m</span>     <span class=n>v1</span><span class=o>.</span><span class=mf>31.4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=n>nkp</span><span class=err>@</span><span class=n>nkp</span><span class=o>-</span><span class=n>bastion</span> <span class=o>~</span><span class=p>]</span><span class=o>$</span> <span class=n>kubectl</span> <span class=n>get</span> <span class=n>helmreleases</span> <span class=o>-</span><span class=n>A</span>
</span></span><span class=line><span class=cl><span class=n>NAMESPACE</span>                     <span class=n>NAME</span>                                <span class=n>AGE</span>   <span class=n>READY</span>   <span class=n>STATUS</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span>   <span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>                 <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span><span class=o>/</span><span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span>   <span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>            <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>-</span><span class=n>default</span><span class=o>-</span><span class=n>workspace</span><span class=o>/</span><span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>ai</span><span class=o>-</span><span class=n>navigator</span><span class=o>-</span><span class=n>app</span>                    <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>ai</span><span class=o>-</span><span class=n>navigator</span><span class=o>-</span><span class=n>cluster</span><span class=o>-</span><span class=n>info</span><span class=o>-</span><span class=n>api</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>ai</span><span class=o>-</span><span class=n>navigator</span><span class=o>-</span><span class=n>cluster</span><span class=o>-</span><span class=n>info</span><span class=o>-</span><span class=n>api</span><span class=err>@</span><span class=mf>0.2</span><span class=o>.</span><span class=mi>8</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>cluster</span><span class=o>-</span><span class=n>observer</span><span class=o>-</span><span class=mi>2360587938</span>         <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>cluster</span><span class=o>-</span><span class=n>observer</span><span class=o>-</span><span class=mf>2360587938.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>cluster</span><span class=o>-</span><span class=n>observer</span><span class=err>@</span><span class=mf>1.4</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>cosi</span><span class=o>-</span><span class=n>driver</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>dkp</span><span class=o>-</span><span class=n>object</span><span class=o>-</span><span class=n>store</span>   <span class=mi>20</span><span class=n>h</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>cluster</span><span class=o>-</span><span class=n>cosi</span><span class=o>-</span><span class=n>driver</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>cosi</span><span class=o>-</span><span class=n>bucket</span><span class=o>-</span><span class=n>kit</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>dex</span>                                 <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>dex</span><span class=o>.</span><span class=n>v3</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>dex</span><span class=err>@</span><span class=mf>2.14</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>dex</span><span class=o>-</span><span class=n>k8s</span><span class=o>-</span><span class=n>authenticator</span>               <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>dex</span><span class=o>-</span><span class=n>k8s</span><span class=o>-</span><span class=n>authenticator</span><span class=o>.</span><span class=n>v5</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>dex</span><span class=o>-</span><span class=n>k8s</span><span class=o>-</span><span class=n>authenticator</span><span class=err>@</span><span class=mf>1.4</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>fluent</span><span class=o>-</span><span class=n>bit</span>                          <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>fluent</span><span class=o>-</span><span class=n>bit</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>fluent</span><span class=o>-</span><span class=n>bit</span><span class=err>@</span><span class=mf>0.48</span><span class=o>.</span><span class=mi>5</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>gatekeeper</span>                          <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>gatekeeper</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>gatekeeper</span><span class=err>@</span><span class=mf>3.18</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>gatekeeper</span><span class=o>-</span><span class=n>proxy</span><span class=o>-</span><span class=n>mutations</span>          <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>gatekeeper</span><span class=o>-</span><span class=n>proxy</span><span class=o>-</span><span class=n>mutations</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>gatekeeper</span><span class=o>-</span><span class=n>proxy</span><span class=o>-</span><span class=n>mutations</span><span class=err>@</span><span class=n>v0</span><span class=o>.</span><span class=mf>0.1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>gateway</span><span class=o>-</span><span class=n>api</span><span class=o>-</span><span class=n>crds</span>                    <span class=mi>20</span><span class=n>h</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>gateway</span><span class=o>-</span><span class=n>api</span><span class=o>-</span><span class=n>crds</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>traefik</span><span class=o>-</span><span class=n>crds</span><span class=err>@</span><span class=mf>1.2</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>grafana</span><span class=o>-</span><span class=n>logging</span>                     <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>grafana</span><span class=o>-</span><span class=n>logging</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>grafana</span><span class=err>@</span><span class=mf>8.9</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>grafana</span><span class=o>-</span><span class=n>loki</span>                        <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>grafana</span><span class=o>-</span><span class=n>loki</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>loki</span><span class=o>-</span><span class=n>distributed</span><span class=err>@</span><span class=mf>0.79</span><span class=o>.</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>istio</span>                               <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>istio</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>istio</span><span class=o>.</span><span class=n>v3</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>istio</span><span class=err>@</span><span class=mf>1.23</span><span class=o>.</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>jaeger</span>                              <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>istio</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>jaeger</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>jaeger</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>2.57</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>                 <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>karma</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kiali</span>                               <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>istio</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>kiali</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kiali</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>2.4</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span>                           <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=err>@</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span><span class=o>-</span><span class=n>appmanagement</span>             <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>appmanagement</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>appmanagement</span><span class=err>@</span><span class=n>v2</span><span class=o>.</span><span class=mf>14.0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span><span class=o>-</span><span class=n>operator</span>                  <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>operator</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>0.3</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kommander</span><span class=o>-</span><span class=n>ui</span>                        <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>kommander</span><span class=o>-</span><span class=n>ui</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>ui</span><span class=err>@</span><span class=mf>17.42</span><span class=o>.</span><span class=mi>7</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kube</span><span class=o>-</span><span class=n>oidc</span><span class=o>-</span><span class=n>proxy</span>                     <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kube</span><span class=o>-</span><span class=n>oidc</span><span class=o>-</span><span class=n>proxy</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kube</span><span class=o>-</span><span class=n>oidc</span><span class=o>-</span><span class=n>proxy</span><span class=err>@</span><span class=mf>0.3</span><span class=o>.</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kube</span><span class=o>-</span><span class=n>prometheus</span><span class=o>-</span><span class=n>stack</span>               <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kube</span><span class=o>-</span><span class=n>prometheus</span><span class=o>-</span><span class=n>stack</span><span class=o>.</span><span class=n>v3</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kube</span><span class=o>-</span><span class=n>prometheus</span><span class=o>-</span><span class=n>stack</span><span class=err>@</span><span class=mf>69.1</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kubefed</span>                             <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kube</span><span class=o>-</span><span class=n>federation</span><span class=o>-</span><span class=n>system</span><span class=o>/</span><span class=n>kubefed</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kubefed</span><span class=err>@</span><span class=mf>0.10</span><span class=o>.</span><span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kubernetes</span><span class=o>-</span><span class=n>dashboard</span>                <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kubernetes</span><span class=o>-</span><span class=n>dashboard</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kubernetes</span><span class=o>-</span><span class=n>dashboard</span><span class=err>@</span><span class=mf>7.10</span><span class=o>.</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>kubetunnel</span>                          <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kubetunnel</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kubetunnel</span><span class=err>@</span><span class=n>v0</span><span class=o>.</span><span class=mf>0.39</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>logging</span><span class=o>-</span><span class=n>operator</span>                    <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=err>@</span><span class=mf>5.0</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>-</span><span class=n>logging</span>            <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>-</span><span class=n>logging</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>logging</span><span class=o>-</span><span class=n>operator</span><span class=o>-</span><span class=n>logging</span><span class=err>@</span><span class=mf>4.2</span><span class=o>.</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>object</span><span class=o>-</span><span class=n>bucket</span><span class=o>-</span><span class=n>claims</span>                <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>object</span><span class=o>-</span><span class=n>bucket</span><span class=o>-</span><span class=n>claims</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>object</span><span class=o>-</span><span class=n>bucket</span><span class=o>-</span><span class=n>claim</span><span class=err>@</span><span class=mf>0.1</span><span class=o>.</span><span class=mi>11</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>prometheus</span><span class=o>-</span><span class=n>adapter</span>                  <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>prometheus</span><span class=o>-</span><span class=n>adapter</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>prometheus</span><span class=o>-</span><span class=n>adapter</span><span class=err>@</span><span class=mf>4.11</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span>            <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>prometheus</span><span class=o>-</span><span class=n>traefik</span><span class=o>-</span><span class=n>certs</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>kommander</span><span class=o>-</span><span class=n>cert</span><span class=o>-</span><span class=n>federation</span><span class=err>@</span><span class=mf>0.0</span><span class=o>.</span><span class=mi>12</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>reloader</span>                            <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>reloader</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>reloader</span><span class=err>@</span><span class=mf>1.2</span><span class=o>.</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span>                           <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=err>@</span><span class=n>v1</span><span class=o>.</span><span class=mf>16.2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>cluster</span>                   <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>cluster</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>rook</span><span class=o>-</span><span class=n>ceph</span><span class=o>-</span><span class=n>cluster</span><span class=err>@</span><span class=n>v1</span><span class=o>.</span><span class=mf>16.2</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>traefik</span>                             <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>kommander</span><span class=o>-</span><span class=n>traefik</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>traefik</span><span class=err>@</span><span class=mf>34.1</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>traefik</span><span class=o>-</span><span class=n>crds</span>                        <span class=mi>20</span><span class=n>h</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>install</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>traefik</span><span class=o>-</span><span class=n>crds</span><span class=o>.</span><span class=n>v1</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>traefik</span><span class=o>-</span><span class=n>crds</span><span class=err>@</span><span class=mf>1.2</span><span class=o>.</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>traefik</span><span class=o>-</span><span class=n>forward</span><span class=o>-</span><span class=n>auth</span><span class=o>-</span><span class=n>mgmt</span>           <span class=mi>13</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>traefik</span><span class=o>-</span><span class=n>forward</span><span class=o>-</span><span class=n>auth</span><span class=o>-</span><span class=n>mgmt</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>traefik</span><span class=o>-</span><span class=n>forward</span><span class=o>-</span><span class=n>auth</span><span class=err>@</span><span class=mf>0.3</span><span class=o>.</span><span class=mi>10</span>
</span></span><span class=line><span class=cl><span class=n>kommander</span>                     <span class=n>velero</span>                              <span class=mi>10</span><span class=n>d</span>   <span class=n>True</span>    <span class=n>Helm</span> <span class=n>upgrade</span> <span class=n>succeeded</span> <span class=k>for</span> <span class=n>release</span> <span class=n>kommander</span><span class=o>/</span><span class=n>velero</span><span class=o>.</span><span class=n>v2</span> <span class=n>with</span> <span class=n>chart</span> <span class=n>velero</span><span class=err>@</span><span class=mf>8.3</span><span class=o>.</span><span class=mi>0</span>
</span></span></code></pre></td></tr></table></div></div><p>Management 升級完成後之後再升級 workload cluster</p><p>以下為範例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1># kubectl get cluster -A</span>
</span></span><span class=line><span class=cl><span class=c1># export  WORKLOAD_CLUSTER_NAME=demo-prod-01</span>
</span></span><span class=line><span class=cl><span class=c1># export  WORKLOAD_CLUSTER_NAMESPACE=demo-zone-c4zz7-qjq6g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># nkp upgrade cluster nutanix \</span>
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>cluster</span><span class=o>-</span><span class=n>name</span> <span class=o>$</span><span class=p>{</span><span class=n>WORKLOAD_CLUSTER_NAME</span><span class=p>}</span> \
</span></span><span class=line><span class=cl><span class=o>--</span><span class=n>vm</span><span class=o>-</span><span class=n>image</span> <span class=o>$</span><span class=p>{</span><span class=n>VM_IMAGE_NAME</span><span class=p>}</span> <span class=o>-</span><span class=n>n</span> <span class=n>WORKLOAD_CLUSTER_NAME</span>
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/nutanix/>Nutanix</a>
<a href=/tags/nkp/>NKP</a>
<a href=/tags/kubernetes/>Kubernetes</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相關文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/nutanix_nkp-v2.13_preprovisioned/><div class=article-details><h2 class=article-title>Nutanix_NKP-v2.13_Preprovisioned</h2></div></a></article><article><a href=/p/nutanix_nkp-v2.12_ahv/><div class=article-details><h2 class=article-title>Nutanix_NKP-v2.12_AHV</h2></div></a></article><article><a href=/p/ocp-4.16.3_on_nutanixipi/><div class=article-details><h2 class=article-title>OCP-4.16.3_on_Nutanix(IPI)</h2></div></a></article><article><a href=/p/nutanix_ndk-v1.0.0_on_ocp-4.13/><div class=article-details><h2 class=article-title>Nutanix_NDK-v1.0.0_On_OCP-4.13</h2></div></a></article><article><a href=/p/ocp-4.12.45_on_nutanixipi/><div class=article-details><h2 class=article-title>OCP-4.12.45_on_Nutanix(IPI)</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//wangken0129.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2025 Ken's blog</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 建立<br>主題 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 設計</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>